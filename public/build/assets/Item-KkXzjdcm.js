import{v as jo,f as Xe,u as Ne,w as Bo,d as Ze,j as t,T as Ko,B as Qe,L as wo,O as ao,e as bo,l as Ho,b as u,R as Go,x as Yo,z as qo,h as Vo,g as Jo,A as Xo,r as H,W as X,n as z,M as se,c as eo,a as Ge,y as Zo,Y as Qo}from"./app-DHbb7XZB.js";import{Y as et}from"./index-D_XodZT9.js";import{a as ot,I as tt}from"./ItemIcon-4kkIs55P.js";import{u as $,a as De,b as he,T as V,A as rt}from"./Authenticated-DWZpg9um.js";import{I as st}from"./ItemBreadcrumbs-B8WEsHim.js";import{u as nt}from"./Popover-DHSW6Xue.js";import{u as at,G as N,A as B,M as fe,I as lt}from"./NotificationMenu-DLxJWaSh.js";import{I as it,u as ko,R as me,a as ct}from"./use-fetch-users-approval-role-D0MjYxgc.js";import{T as O,F as J}from"./OfficeLogo-C6ryGmry.js";import{S as re}from"./Stack-BnRli6BO.js";import{T as Do}from"./Textarea-DoT4cs20.js";import{S as oo}from"./Select-De12jFwc.js";import{B as _}from"./Button-De38AkdO.js";import{U as dt}from"./UpdateNumberingSchemeForm-_PpvpPrg.js";import{T as qe}from"./TextInput-B2cdI1__.js";import{I as ut,u as pt}from"./use-generate-report-BMJ0bl2t.js";import{c as G}from"./IconUser-CvGZT8Us.js";import{I as ft}from"./IconFolder-CGYS36Op.js";import{I as mt}from"./IconDownload-CNXXB5sP.js";import{u as ht}from"./use-document-properties-keVFbWrw.js";import{u as gt}from"./use-fetch-metadata-CeZqA4Yc.js";import{A as vt,I as yt}from"./IconAlertCircle-DjVk4jpA.js";import"./Checkbox-DhvQdy4I.js";import"./InputBase-C-93sqIY.js";import"./use-uncontrolled-B1gi51Y9.js";import"./CheckIcon-fVhk7RRX.js";import"./ScrollArea-C3btK3uF.js";import"./get-color-status-DWf4oBUm.js";import"./IconPhoto-B_eesrcM.js";import"./get-sorted-breakpoints-BYD2hfL9.js";import"./Anchor-CgujKe5m.js";import"./Combobox-Dmw127jY.js";function lo(e){return typeof e!="string"?"":e.charAt(0).toUpperCase()+e.slice(1)}var Co={root:"m_6e45937b",loader:"m_e8eb006c",overlay:"m_df587f17"};const io={transitionProps:{transition:"fade",duration:0},overlayProps:{backgroundOpacity:.75},zIndex:jo("overlay")},xt=bo((e,{zIndex:o})=>({root:{"--lo-z-index":o==null?void 0:o.toString()}})),to=Xe((e,o)=>{const r=Ne("LoadingOverlay",io,e),{classNames:s,className:n,style:l,styles:a,unstyled:i,vars:d,transitionProps:p,loaderProps:b,overlayProps:k,visible:v,zIndex:m,...h}=r,y=Bo(),D=Ze({name:"LoadingOverlay",classes:Co,props:r,className:n,style:l,classNames:s,styles:a,unstyled:i,vars:d,varsResolver:xt}),C={...io.overlayProps,...k};return t.jsx(Ko,{transition:"fade",...p,mounted:!!v,children:g=>t.jsxs(Qe,{...D("root",{style:g}),ref:o,...h,children:[t.jsx(wo,{...D("loader"),unstyled:i,...b}),t.jsx(ao,{...C,...D("overlay"),darkHidden:!0,unstyled:i,color:(k==null?void 0:k.color)||y.white}),t.jsx(ao,{...C,...D("overlay"),lightHidden:!0,unstyled:i,color:(k==null?void 0:k.color)||y.colors.dark[5]})]})})});to.classes=Co;to.displayName="@mantine/core/LoadingOverlay";var Fo={exports:{}},jt="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",wt=jt,bt=wt;function So(){}function _o(){}_o.resetWarningCache=So;var kt=function(){function e(s,n,l,a,i,d){if(d!==bt){var p=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw p.name="Invariant Violation",p}}e.isRequired=e;function o(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:o,element:e,elementType:e,instanceOf:o,node:e,objectOf:o,oneOf:o,oneOfType:o,shape:o,exact:o,checkPropTypes:_o,resetWarningCache:So};return r.PropTypes=r,r};Fo.exports=kt();var Dt=Fo.exports;const S=Ho(Dt);/**
 * @license @tabler/icons-react v3.11.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ct=G("outline","adjustments","IconAdjustments",[["path",{d:"M4 10a2 2 0 1 0 4 0a2 2 0 0 0 -4 0",key:"svg-0"}],["path",{d:"M6 4v4",key:"svg-1"}],["path",{d:"M6 12v8",key:"svg-2"}],["path",{d:"M10 16a2 2 0 1 0 4 0a2 2 0 0 0 -4 0",key:"svg-3"}],["path",{d:"M12 4v10",key:"svg-4"}],["path",{d:"M12 18v2",key:"svg-5"}],["path",{d:"M16 7a2 2 0 1 0 4 0a2 2 0 0 0 -4 0",key:"svg-6"}],["path",{d:"M18 4v1",key:"svg-7"}],["path",{d:"M18 9v11",key:"svg-8"}]]);/**
 * @license @tabler/icons-react v3.11.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ft=G("outline","article","IconArticle",[["path",{d:"M3 4m0 2a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2z",key:"svg-0"}],["path",{d:"M7 8h10",key:"svg-1"}],["path",{d:"M7 12h10",key:"svg-2"}],["path",{d:"M7 16h10",key:"svg-3"}]]);/**
 * @license @tabler/icons-react v3.11.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ye=G("outline","chevron-down","IconChevronDown",[["path",{d:"M6 9l6 6l6 -6",key:"svg-0"}]]);/**
 * @license @tabler/icons-react v3.11.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var St=G("outline","chevron-left","IconChevronLeft",[["path",{d:"M15 6l-6 6l6 6",key:"svg-0"}]]);/**
 * @license @tabler/icons-react v3.11.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var _t=G("outline","file-isr","IconFileIsr",[["path",{d:"M15 3v4a1 1 0 0 0 1 1h4",key:"svg-0"}],["path",{d:"M15 3v4a1 1 0 0 0 1 1h4",key:"svg-1"}],["path",{d:"M6 8v-3a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2v-7",key:"svg-2"}],["path",{d:"M3 15l3 -3l3 3",key:"svg-3"}]]);/**
 * @license @tabler/icons-react v3.11.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Et=G("outline","file-report","IconFileReport",[["path",{d:"M17 17m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0",key:"svg-0"}],["path",{d:"M17 13v4h4",key:"svg-1"}],["path",{d:"M12 3v4a1 1 0 0 0 1 1h4",key:"svg-2"}],["path",{d:"M11.5 21h-6.5a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v2m0 3v4",key:"svg-3"}]]);/**
 * @license @tabler/icons-react v3.11.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Mt=G("outline","folder-plus","IconFolderPlus",[["path",{d:"M12 19h-7a2 2 0 0 1 -2 -2v-11a2 2 0 0 1 2 -2h4l3 3h7a2 2 0 0 1 2 2v3.5",key:"svg-0"}],["path",{d:"M16 19h6",key:"svg-1"}],["path",{d:"M19 16v6",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.11.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var It=G("outline","folder-symlink","IconFolderSymlink",[["path",{d:"M3 21v-4a3 3 0 0 1 3 -3h5",key:"svg-0"}],["path",{d:"M8 17l3 -3l-3 -3",key:"svg-1"}],["path",{d:"M3 11v-5a2 2 0 0 1 2 -2h4l3 3h7a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-8",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.11.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var At=G("outline","folder-up","IconFolderUp",[["path",{d:"M12 19h-7a2 2 0 0 1 -2 -2v-11a2 2 0 0 1 2 -2h4l3 3h7a2 2 0 0 1 2 2v3.5",key:"svg-0"}],["path",{d:"M19 22v-6",key:"svg-1"}],["path",{d:"M22 19l-3 -3l-3 3",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.11.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var zt=G("outline","list-tree","IconListTree",[["path",{d:"M9 6h11",key:"svg-0"}],["path",{d:"M12 12h8",key:"svg-1"}],["path",{d:"M15 18h5",key:"svg-2"}],["path",{d:"M5 6v.01",key:"svg-3"}],["path",{d:"M8 12v.01",key:"svg-4"}],["path",{d:"M11 18v.01",key:"svg-5"}]]);/**
 * @license @tabler/icons-react v3.11.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ot=G("outline","selector","IconSelector",[["path",{d:"M8 9l4 -4l4 4",key:"svg-0"}],["path",{d:"M16 15l-4 4l-4 -4",key:"svg-1"}]]);const Rt=new Map([["aac","audio/aac"],["abw","application/x-abiword"],["arc","application/x-freearc"],["avif","image/avif"],["avi","video/x-msvideo"],["azw","application/vnd.amazon.ebook"],["bin","application/octet-stream"],["bmp","image/bmp"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["cda","application/x-cdf"],["csh","application/x-csh"],["css","text/css"],["csv","text/csv"],["doc","application/msword"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["eot","application/vnd.ms-fontobject"],["epub","application/epub+zip"],["gz","application/gzip"],["gif","image/gif"],["heic","image/heic"],["heif","image/heif"],["htm","text/html"],["html","text/html"],["ico","image/vnd.microsoft.icon"],["ics","text/calendar"],["jar","application/java-archive"],["jpeg","image/jpeg"],["jpg","image/jpeg"],["js","text/javascript"],["json","application/json"],["jsonld","application/ld+json"],["mid","audio/midi"],["midi","audio/midi"],["mjs","text/javascript"],["mp3","audio/mpeg"],["mp4","video/mp4"],["mpeg","video/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["opus","audio/opus"],["otf","font/otf"],["png","image/png"],["pdf","application/pdf"],["php","application/x-httpd-php"],["ppt","application/vnd.ms-powerpoint"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["rar","application/vnd.rar"],["rtf","application/rtf"],["sh","application/x-sh"],["svg","image/svg+xml"],["swf","application/x-shockwave-flash"],["tar","application/x-tar"],["tif","image/tiff"],["tiff","image/tiff"],["ts","video/mp2t"],["ttf","font/ttf"],["txt","text/plain"],["vsd","application/vnd.visio"],["wav","audio/wav"],["weba","audio/webm"],["webm","video/webm"],["webp","image/webp"],["woff","font/woff"],["woff2","font/woff2"],["xhtml","application/xhtml+xml"],["xls","application/vnd.ms-excel"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xml","application/xml"],["xul","application/vnd.mozilla.xul+xml"],["zip","application/zip"],["7z","application/x-7z-compressed"],["mkv","video/x-matroska"],["mov","video/quicktime"],["msg","application/vnd.ms-outlook"]]);function Fe(e,o){const r=Ut(e);if(typeof r.path!="string"){const{webkitRelativePath:s}=e;Object.defineProperty(r,"path",{value:typeof o=="string"?o:typeof s=="string"&&s.length>0?s:e.name,writable:!1,configurable:!1,enumerable:!0})}return r}function Ut(e){const{name:o}=e;if(o&&o.lastIndexOf(".")!==-1&&!e.type){const s=o.split(".").pop().toLowerCase(),n=Rt.get(s);n&&Object.defineProperty(e,"type",{value:n,writable:!1,configurable:!1,enumerable:!0})}return e}var ge=(e,o,r)=>new Promise((s,n)=>{var l=d=>{try{i(r.next(d))}catch(p){n(p)}},a=d=>{try{i(r.throw(d))}catch(p){n(p)}},i=d=>d.done?s(d.value):Promise.resolve(d.value).then(l,a);i((r=r.apply(e,o)).next())});const Tt=[".DS_Store","Thumbs.db"];function Wt(e){return ge(this,null,function*(){return Ue(e)&&Lt(e.dataTransfer)?Bt(e.dataTransfer,e.type):Nt(e)?$t(e):Array.isArray(e)&&e.every(o=>"getFile"in o&&typeof o.getFile=="function")?Pt(e):[]})}function Lt(e){return Ue(e)}function Nt(e){return Ue(e)&&Ue(e.target)}function Ue(e){return typeof e=="object"&&e!==null}function $t(e){return Ve(e.target.files).map(o=>Fe(o))}function Pt(e){return ge(this,null,function*(){return(yield Promise.all(e.map(r=>r.getFile()))).map(r=>Fe(r))})}function Bt(e,o){return ge(this,null,function*(){if(e.items){const r=Ve(e.items).filter(n=>n.kind==="file");if(o!=="drop")return r;const s=yield Promise.all(r.map(Kt));return co(Eo(s))}return co(Ve(e.files).map(r=>Fe(r)))})}function co(e){return e.filter(o=>Tt.indexOf(o.name)===-1)}function Ve(e){if(e===null)return[];const o=[];for(let r=0;r<e.length;r++){const s=e[r];o.push(s)}return o}function Kt(e){if(typeof e.webkitGetAsEntry!="function")return uo(e);const o=e.webkitGetAsEntry();return o&&o.isDirectory?Mo(o):uo(e)}function Eo(e){return e.reduce((o,r)=>[...o,...Array.isArray(r)?Eo(r):[r]],[])}function uo(e){const o=e.getAsFile();if(!o)return Promise.reject(`${e} is not a File`);const r=Fe(o);return Promise.resolve(r)}function Ht(e){return ge(this,null,function*(){return e.isDirectory?Mo(e):Gt(e)})}function Mo(e){const o=e.createReader();return new Promise((r,s)=>{const n=[];function l(){o.readEntries(a=>ge(this,null,function*(){if(a.length){const i=Promise.all(a.map(Ht));n.push(i),l()}else try{const i=yield Promise.all(n);r(i)}catch(i){s(i)}}),a=>{s(a)})}l()})}function Gt(e){return ge(this,null,function*(){return new Promise((o,r)=>{e.file(s=>{const n=Fe(s,e.fullPath);o(n)},s=>{r(s)})})})}function Yt(e,o){if(e&&o){const r=Array.isArray(o)?o:o.split(","),s=e.name||"",n=(e.type||"").toLowerCase(),l=n.replace(/\/.*$/,"");return r.some(a=>{const i=a.trim().toLowerCase();return i.charAt(0)==="."?s.toLowerCase().endsWith(i):i.endsWith("/*")?l===i.replace(/\/.*$/,""):n===i})}return!0}var qt=Object.defineProperty,Vt=Object.defineProperties,Jt=Object.getOwnPropertyDescriptors,po=Object.getOwnPropertySymbols,Xt=Object.prototype.hasOwnProperty,Zt=Object.prototype.propertyIsEnumerable,fo=(e,o,r)=>o in e?qt(e,o,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[o]=r,Qt=(e,o)=>{for(var r in o||(o={}))Xt.call(o,r)&&fo(e,r,o[r]);if(po)for(var r of po(o))Zt.call(o,r)&&fo(e,r,o[r]);return e},er=(e,o)=>Vt(e,Jt(o));const or="file-invalid-type",tr="file-too-large",rr="file-too-small",sr="too-many-files",nr=e=>{e=Array.isArray(e)&&e.length===1?e[0]:e;const o=Array.isArray(e)?`one of ${e.join(", ")}`:e;return{code:or,message:`File type must be ${o}`}},mo=e=>({code:tr,message:`File is larger than ${e} ${e===1?"byte":"bytes"}`}),ho=e=>({code:rr,message:`File is smaller than ${e} ${e===1?"byte":"bytes"}`}),ar={code:sr,message:"Too many files"};function Io(e,o){const r=e.type==="application/x-moz-file"||Yt(e,o);return[r,r?null:nr(o)]}function Ao(e,o,r){if(ie(e.size))if(ie(o)&&ie(r)){if(e.size>r)return[!1,mo(r)];if(e.size<o)return[!1,ho(o)]}else{if(ie(o)&&e.size<o)return[!1,ho(o)];if(ie(r)&&e.size>r)return[!1,mo(r)]}return[!0,null]}function ie(e){return e!=null}function lr({files:e,accept:o,minSize:r,maxSize:s,multiple:n,maxFiles:l,validator:a}){return!n&&e.length>1||n&&l>=1&&e.length>l?!1:e.every(i=>{const[d]=Io(i,o),[p]=Ao(i,r,s),b=a?a(i):null;return d&&p&&!b})}function Te(e){return typeof e.isPropagationStopped=="function"?e.isPropagationStopped():typeof e.cancelBubble<"u"?e.cancelBubble:!1}function Re(e){return e.dataTransfer?Array.prototype.some.call(e.dataTransfer.types,o=>o==="Files"||o==="application/x-moz-file"):!!e.target&&!!e.target.files}function go(e){e.preventDefault()}function ir(e){return e.indexOf("MSIE")!==-1||e.indexOf("Trident/")!==-1}function cr(e){return e.indexOf("Edge/")!==-1}function dr(e=window.navigator.userAgent){return ir(e)||cr(e)}function Y(...e){return(o,...r)=>e.some(s=>(!Te(o)&&s&&s(o,...r),Te(o)))}function ur(){return"showOpenFilePicker"in window}function pr(e){return ie(e)?[{description:"Files",accept:Object.entries(e).filter(([r,s])=>{let n=!0;return zo(r)||(console.warn(`Skipped "${r}" because it is not a valid MIME type. Check https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types for a list of valid MIME types.`),n=!1),(!Array.isArray(s)||!s.every(Oo))&&(console.warn(`Skipped "${r}" because an invalid file extension was provided.`),n=!1),n}).reduce((r,[s,n])=>er(Qt({},r),{[s]:n}),{})}]:e}function fr(e){if(ie(e))return Object.entries(e).reduce((o,[r,s])=>[...o,r,...s],[]).filter(o=>zo(o)||Oo(o)).join(",")}function mr(e){return e instanceof DOMException&&(e.name==="AbortError"||e.code===e.ABORT_ERR)}function hr(e){return e instanceof DOMException&&(e.name==="SecurityError"||e.code===e.SECURITY_ERR)}function zo(e){return e==="audio/*"||e==="video/*"||e==="image/*"||e==="text/*"||/\w+\/[-+.\w]+/g.test(e)}function Oo(e){return/^.*\.[\w]+$/.test(e)}var gr=Object.defineProperty,vr=Object.defineProperties,yr=Object.getOwnPropertyDescriptors,We=Object.getOwnPropertySymbols,Ro=Object.prototype.hasOwnProperty,Uo=Object.prototype.propertyIsEnumerable,vo=(e,o,r)=>o in e?gr(e,o,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[o]=r,L=(e,o)=>{for(var r in o||(o={}))Ro.call(o,r)&&vo(e,r,o[r]);if(We)for(var r of We(o))Uo.call(o,r)&&vo(e,r,o[r]);return e},te=(e,o)=>vr(e,yr(o)),Le=(e,o)=>{var r={};for(var s in e)Ro.call(e,s)&&o.indexOf(s)<0&&(r[s]=e[s]);if(e!=null&&We)for(var s of We(e))o.indexOf(s)<0&&Uo.call(e,s)&&(r[s]=e[s]);return r};const ro=u.forwardRef((e,o)=>{var r=e,{children:s}=r,n=Le(r,["children"]);const l=Wo(n),{open:a}=l,i=Le(l,["open"]);return u.useImperativeHandle(o,()=>({open:a}),[a]),Go.createElement(u.Fragment,null,s(te(L({},i),{open:a})))});ro.displayName="Dropzone";const To={disabled:!1,getFilesFromEvent:Wt,maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1,validator:null,useFsAccessApi:!0,autoFocus:!1};ro.defaultProps=To;ro.propTypes={children:S.func,accept:S.objectOf(S.arrayOf(S.string)),multiple:S.bool,preventDropOnDocument:S.bool,noClick:S.bool,noKeyboard:S.bool,noDrag:S.bool,noDragEventsBubbling:S.bool,minSize:S.number,maxSize:S.number,maxFiles:S.number,disabled:S.bool,getFilesFromEvent:S.func,onFileDialogCancel:S.func,onFileDialogOpen:S.func,useFsAccessApi:S.bool,autoFocus:S.bool,onDragEnter:S.func,onDragLeave:S.func,onDragOver:S.func,onDrop:S.func,onDropAccepted:S.func,onDropRejected:S.func,onError:S.func,validator:S.func};const Je={isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,acceptedFiles:[],fileRejections:[]};function Wo(e={}){const{accept:o,disabled:r,getFilesFromEvent:s,maxSize:n,minSize:l,multiple:a,maxFiles:i,onDragEnter:d,onDragLeave:p,onDragOver:b,onDrop:k,onDropAccepted:v,onDropRejected:m,onFileDialogCancel:h,onFileDialogOpen:y,useFsAccessApi:D,autoFocus:C,preventDropOnDocument:g,noClick:f,noKeyboard:F,noDrag:x,noDragEventsBubbling:M,onError:j,validator:E}=L(L({},To),e),I=u.useMemo(()=>fr(o),[o]),R=u.useMemo(()=>pr(o),[o]),Z=u.useMemo(()=>typeof y=="function"?y:yo,[y]),Q=u.useMemo(()=>typeof h=="function"?h:yo,[h]),U=u.useRef(null),P=u.useRef(null),[Se,W]=u.useReducer(xr,Je),{isFocused:$e,isFileDialogActive:ve}=Se,ce=u.useRef(typeof window<"u"&&window.isSecureContext&&D&&ur()),Pe=()=>{!ce.current&&ve&&setTimeout(()=>{if(P.current){const{files:c}=P.current;c.length||(W({type:"closeDialog"}),Q())}},300)};u.useEffect(()=>(window.addEventListener("focus",Pe,!1),()=>{window.removeEventListener("focus",Pe,!1)}),[P,ve,Q,ce]);const ae=u.useRef([]),_e=c=>{U.current&&U.current.contains(c.target)||(c.preventDefault(),ae.current=[])};u.useEffect(()=>(g&&(document.addEventListener("dragover",go,!1),document.addEventListener("drop",_e,!1)),()=>{g&&(document.removeEventListener("dragover",go),document.removeEventListener("drop",_e))}),[U,g]),u.useEffect(()=>(!r&&C&&U.current&&U.current.focus(),()=>{}),[U,C,r]);const q=u.useCallback(c=>{j?j(c):console.error(c)},[j]),Ee=u.useCallback(c=>{c.preventDefault(),c.persist(),Oe(c),ae.current=[...ae.current,c.target],Re(c)&&Promise.resolve(s(c)).then(w=>{if(Te(c)&&!M)return;const A=w.length,T=A>0&&lr({files:w,accept:I,minSize:l,maxSize:n,multiple:a,maxFiles:i,validator:E}),K=A>0&&!T;W({isDragAccept:T,isDragReject:K,isDragActive:!0,type:"setDraggedFiles"}),d&&d(c)}).catch(w=>q(w))},[s,d,q,M,I,l,n,a,i,E]),Me=u.useCallback(c=>{c.preventDefault(),c.persist(),Oe(c);const w=Re(c);if(w&&c.dataTransfer)try{c.dataTransfer.dropEffect="copy"}catch{}return w&&b&&b(c),!1},[b,M]),Ie=u.useCallback(c=>{c.preventDefault(),c.persist(),Oe(c);const w=ae.current.filter(T=>U.current&&U.current.contains(T)),A=w.indexOf(c.target);A!==-1&&w.splice(A,1),ae.current=w,!(w.length>0)&&(W({type:"setDraggedFiles",isDragActive:!1,isDragAccept:!1,isDragReject:!1}),Re(c)&&p&&p(c))},[U,p,M]),le=u.useCallback((c,w)=>{const A=[],T=[];c.forEach(K=>{const[je,we]=Io(K,I),[Be,Ke]=Ao(K,l,n),be=E?E(K):null;if(je&&Be&&!be)A.push(K);else{let ke=[we,Ke];be&&(ke=ke.concat(be)),T.push({file:K,errors:ke.filter(He=>He)})}}),(!a&&A.length>1||a&&i>=1&&A.length>i)&&(A.forEach(K=>{T.push({file:K,errors:[ar]})}),A.splice(0)),W({acceptedFiles:A,fileRejections:T,type:"setFiles"}),k&&k(A,T,w),T.length>0&&m&&m(T,w),A.length>0&&v&&v(A,w)},[W,a,I,l,n,i,k,v,m,E]),de=u.useCallback(c=>{c.preventDefault(),c.persist(),Oe(c),ae.current=[],Re(c)&&Promise.resolve(s(c)).then(w=>{Te(c)&&!M||le(w,c)}).catch(w=>q(w)),W({type:"reset"})},[s,le,q,M]),ee=u.useCallback(()=>{if(ce.current){W({type:"openDialog"}),Z();const c={multiple:a,types:R};window.showOpenFilePicker(c).then(w=>s(w)).then(w=>{le(w,null),W({type:"closeDialog"})}).catch(w=>{mr(w)?(Q(w),W({type:"closeDialog"})):hr(w)?(ce.current=!1,P.current?(P.current.value=null,P.current.click()):q(new Error("Cannot open the file picker because the https://developer.mozilla.org/en-US/docs/Web/API/File_System_Access_API is not supported and no <input> was provided."))):q(w)});return}P.current&&(W({type:"openDialog"}),Z(),P.current.value=null,P.current.click())},[W,Z,Q,D,le,q,R,a]),ue=u.useCallback(c=>{!U.current||!U.current.isEqualNode(c.target)||(c.key===" "||c.key==="Enter"||c.keyCode===32||c.keyCode===13)&&(c.preventDefault(),ee())},[U,ee]),pe=u.useCallback(()=>{W({type:"focus"})},[]),Ae=u.useCallback(()=>{W({type:"blur"})},[]),ye=u.useCallback(()=>{f||(dr()?setTimeout(ee,0):ee())},[f,ee]),oe=c=>r?null:c,xe=c=>F?null:oe(c),ze=c=>x?null:oe(c),Oe=c=>{M&&c.stopPropagation()},Lo=u.useMemo(()=>(c={})=>{var w=c,{refKey:A="ref",role:T,onKeyDown:K,onFocus:je,onBlur:we,onClick:Be,onDragEnter:Ke,onDragOver:be,onDragLeave:ke,onDrop:He}=w,Po=Le(w,["refKey","role","onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragOver","onDragLeave","onDrop"]);return L(L({onKeyDown:xe(Y(K,ue)),onFocus:xe(Y(je,pe)),onBlur:xe(Y(we,Ae)),onClick:oe(Y(Be,ye)),onDragEnter:ze(Y(Ke,Ee)),onDragOver:ze(Y(be,Me)),onDragLeave:ze(Y(ke,Ie)),onDrop:ze(Y(He,de)),role:typeof T=="string"&&T!==""?T:"presentation",[A]:U},!r&&!F?{tabIndex:0}:{}),Po)},[U,ue,pe,Ae,ye,Ee,Me,Ie,de,F,x,r]),No=u.useCallback(c=>{c.stopPropagation()},[]),$o=u.useMemo(()=>(c={})=>{var w=c,{refKey:A="ref",onChange:T,onClick:K}=w,je=Le(w,["refKey","onChange","onClick"]);const we={accept:I,multiple:a,type:"file",style:{display:"none"},onChange:oe(Y(T,de)),onClick:oe(Y(K,No)),tabIndex:-1,[A]:P};return L(L({},we),je)},[P,o,a,de,r]);return te(L({},Se),{isFocused:$e&&!r,getRootProps:Lo,getInputProps:$o,rootRef:U,inputRef:P,open:oe(ee)})}function xr(e,o){switch(o.type){case"focus":return te(L({},e),{isFocused:!0});case"blur":return te(L({},e),{isFocused:!1});case"openDialog":return te(L({},Je),{isFileDialogActive:!0});case"closeDialog":return te(L({},e),{isFileDialogActive:!1});case"setDraggedFiles":return te(L({},e),{isDragActive:o.isDragActive,isDragAccept:o.isDragAccept,isDragReject:o.isDragReject});case"setFiles":return te(L({},e),{acceptedFiles:o.acceptedFiles,fileRejections:o.fileRejections});case"reset":return L({},Je);default:return e}}function yo(){}const[jr,wr]=Yo("Dropzone component was not found in tree");function so(e){const o=r=>{const{children:s,...n}=Ne(`Dropzone${lo(e)}`,{},r),l=wr(),a=qo(s)?s:t.jsx("span",{children:s});return l[e]?u.cloneElement(a,n):null};return o.displayName=`@mantine/dropzone/${lo(e)}`,o}const br=so("accept"),kr=so("reject"),Dr=so("idle");var Ce={root:"m_d46a4834",inner:"m_b85f7144",fullScreen:"m_96f6e9ad",dropzone:"m_7946116d"};const Cr={loading:!1,multiple:!0,maxSize:1/0,autoFocus:!1,activateOnClick:!0,activateOnDrag:!0,dragEventsBubbling:!0,activateOnKeyboard:!0,useFsAccessApi:!0,variant:"light",rejectColor:"red"},Fr=bo((e,{radius:o,variant:r,acceptColor:s,rejectColor:n})=>{const l=e.variantColorResolver({color:s||e.primaryColor,theme:e,variant:r}),a=e.variantColorResolver({color:n||"red",theme:e,variant:r});return{root:{"--dropzone-radius":Jo(o),"--dropzone-accept-color":l.color,"--dropzone-accept-bg":l.background,"--dropzone-reject-color":a.color,"--dropzone-reject-bg":a.background}}}),ne=Xe((e,o)=>{const r=Ne("Dropzone",Cr,e),{classNames:s,className:n,style:l,styles:a,unstyled:i,vars:d,radius:p,disabled:b,loading:k,multiple:v,maxSize:m,accept:h,children:y,onDropAny:D,onDrop:C,onReject:g,openRef:f,name:F,maxFiles:x,autoFocus:M,activateOnClick:j,activateOnDrag:E,dragEventsBubbling:I,activateOnKeyboard:R,onDragEnter:Z,onDragLeave:Q,onDragOver:U,onFileDialogCancel:P,onFileDialogOpen:Se,preventDropOnDocument:W,useFsAccessApi:$e,getFilesFromEvent:ve,validator:ce,rejectColor:Pe,acceptColor:ae,enablePointerEvents:_e,loaderProps:q,inputProps:Ee,mod:Me,...Ie}=r,le=Ze({name:"Dropzone",classes:Ce,props:r,className:n,style:l,classNames:s,styles:a,unstyled:i,vars:d,varsResolver:Fr}),{getRootProps:de,getInputProps:ee,isDragAccept:ue,isDragReject:pe,open:Ae}=Wo({onDrop:D,onDropAccepted:C,onDropRejected:g,disabled:b||k,accept:Array.isArray(h)?h.reduce((oe,xe)=>({...oe,[xe]:[]}),{}):h,multiple:v,maxSize:m,maxFiles:x,autoFocus:M,noClick:!j,noDrag:!E,noDragEventsBubbling:!I,noKeyboard:!R,onDragEnter:Z,onDragLeave:Q,onDragOver:U,onFileDialogCancel:P,onFileDialogOpen:Se,preventDropOnDocument:W,useFsAccessApi:$e,validator:ce,...ve?{getFilesFromEvent:ve}:null});Vo(f,Ae);const ye=!ue&&!pe;return t.jsx(jr,{value:{accept:ue,reject:pe,idle:ye},children:t.jsxs(Qe,{...de(),...le("root",{focusable:!0}),...Ie,mod:[{accept:ue,reject:pe,idle:ye,disabled:b,loading:k,"activate-on-click":j},Me],children:[t.jsx(to,{visible:k,overlayProps:{radius:p},unstyled:i,loaderProps:q}),t.jsx("input",{...ee(Ee),name:F}),t.jsx("div",{...le("inner"),ref:o,"data-enable-pointer-events":_e||void 0,children:y})]})})});ne.classes=Ce;ne.displayName="@mantine/dropzone/Dropzone";ne.Accept=br;ne.Idle=Dr;ne.Reject=kr;const Sr={loading:!1,maxSize:1/0,activateOnClick:!1,activateOnDrag:!0,dragEventsBubbling:!0,activateOnKeyboard:!0,active:!0,zIndex:jo("max"),withinPortal:!0},no=Xe((e,o)=>{const r=Ne("DropzoneFullScreen",Sr,e),{classNames:s,className:n,style:l,styles:a,unstyled:i,vars:d,active:p,onDrop:b,onReject:k,zIndex:v,withinPortal:m,portalProps:h,...y}=r,D=Ze({name:"DropzoneFullScreen",classes:Ce,props:r,className:n,style:l,classNames:s,styles:a,unstyled:i,rootSelector:"fullScreen"}),{resolvedClassNames:C,resolvedStyles:g}=nt({classNames:s,styles:a,props:r}),[f,F]=u.useState(0),[x,{open:M,close:j}]=at(!1),E=R=>{var Z;(Z=R.dataTransfer)!=null&&Z.types.includes("Files")&&(F(Q=>Q+1),M())},I=()=>{F(R=>R-1)};return u.useEffect(()=>{f===0&&j()},[f]),u.useEffect(()=>{if(p)return document.addEventListener("dragenter",E,!1),document.addEventListener("dragleave",I,!1),()=>{document.removeEventListener("dragenter",E,!1),document.removeEventListener("dragleave",I,!1)}},[p]),t.jsx(Xo,{...h,withinPortal:m,children:t.jsx(Qe,{...D("fullScreen",{style:{opacity:x?1:0,pointerEvents:x?"all":"none",zIndex:v}}),ref:o,children:t.jsx(ne,{...y,classNames:C,styles:g,unstyled:i,className:Ce.dropzone,onDrop:R=>{b==null||b(R),j(),F(0)},onReject:R=>{k==null||k(R),j(),F(0)}})})})});no.classes=Ce;no.displayName="@mantine/dropzone/DropzoneFullScreen";ne.FullScreen=no;const xo=ne;function _r({onDrop:e,openRef:o,children:r}){return t.jsxs(xo,{openRef:o,onDrop:e,activateOnClick:!1,acceptColor:"var(--mantine-color-white)",styles:{root:{border:"none",padding:0}},children:[t.jsx(xo.Accept,{children:t.jsx(it,{style:{width:H(52),height:H(52),color:"var(--mantine-color-blue-6)",position:"absolute",bottom:H(16),left:"50%",transform:"translateX(-50%)",zIndex:9999},stroke:1.5})}),r]})}function Er({itemParentId:e}){const[o,r]=u.useState("reviewal"),{closeModal:s,modals:n}=$(),l=ko(o,n.createWorkflow),{data:a,setData:i,post:d,processing:p,errors:b,reset:k}=X({folder_item_id:"",resolution:"",destination:"",type:"reviewal",users:[]}),[v,m]=u.useState([]),h=l.length;u.useEffect(()=>{m([])},[o,l]);const y=x=>{x.preventDefault();const M=v.map(j=>parseInt(j.selectedUser)).filter(j=>!isNaN(j));a.folder_item_id=e??"",a.users=M.map(j=>({user_id:j})),d(route("workflows.store"),{preserveScroll:!0,onSuccess:()=>{s("createWorkflow"),z.show({message:"Approval process created",color:"green"})},onError:()=>{z.show({message:"Something went wrong",color:"red"})},onFinish:()=>k()})},D=()=>{v.length<h&&m([...v,{selectedUser:""}])},C=()=>{const x=v.map(E=>E.selectedUser),j=l.filter(E=>!x.includes(E.id.toString())).map(E=>({selectedUser:E.id.toString()}));m([...v,...j])},g=x=>{const M=[...v];M.splice(x,1),m(M)},f=(x,M)=>{const j=[...v];j[x].selectedUser=M||"",m(j)},F=v.map(x=>x.selectedUser).filter(x=>x!=="");return{data:a,setData:i,createApprovalSubmit:y,processing:p,errors:b,users:v,setWorkflowType:r,addUser:D,removeUser:g,handleUserChange:f,addAllUsers:C,maxUsers:h,selectedUserIds:F,fetchedUsers:l}}const Mr=({itemParent:e})=>{const{data:o,setData:r,createApprovalSubmit:s,processing:n,errors:l,users:a,setWorkflowType:i,addUser:d,removeUser:p,handleUserChange:b,addAllUsers:k,maxUsers:v,selectedUserIds:m,fetchedUsers:h}=Er({itemParentId:e==null?void 0:e.item_id}),{modals:y,closeModal:D}=$(),C=g=>h.filter(f=>!m.includes(f.id.toString())||f.id.toString()===a[g].selectedUser).map(f=>({value:f.id.toString(),label:`${f.name} (${f.email})`}));return t.jsx(se,{opened:y.createWorkflow,onClose:()=>D("createWorkflow"),title:t.jsx(O,{fw:"bold",size:"lg",children:"Create Workflow Process"}),size:550,children:t.jsxs("form",{onSubmit:s,children:[t.jsxs(re,{gap:16,children:[t.jsx(O,{size:"sm",color:"dimmed",children:"Routinely directs any uploaded file in this folder through a predefined approval workflow"}),t.jsx(me.Group,{name:"status",value:o.type,onChange:g=>{r("type",g),i(g)},children:t.jsxs(N,{mt:"xs",children:[t.jsx(me,{value:"reviewal",label:"Review"}),t.jsx(me,{value:"approval",label:"Approval"})]})}),t.jsx(Do,{label:"Resolution",placeholder:"Your resolution for this approval",value:o.resolution??"",onChange:g=>r("resolution",g.target.value),error:l.resolution,autosize:!0,minRows:2,maxRows:4}),t.jsx(O,{size:"sm",fw:500,mb:-8,children:"Users in this workflow"}),a.map((g,f)=>t.jsxs(N,{justify:"space-between",align:"flex-end",children:[t.jsx(oo,{placeholder:"Select a user",data:C(f),value:g.selectedUser,onChange:F=>b(f,F),required:!0,style:{flex:1},allowDeselect:!1}),t.jsx(B,{color:"red",onClick:()=>p(f),title:"Remove User",children:t.jsx(De,{size:18})})]},f)),t.jsxs(N,{children:[a.length<v&&t.jsx(_,{variant:"subtle",color:"green",leftSection:t.jsx(he,{size:16}),onClick:d,disabled:a.length>=v,children:"Add User"}),m.length<v&&t.jsx(_,{variant:"subtle",color:"blue",leftSection:t.jsx(he,{size:16}),onClick:k,disabled:a.length>=v,children:"Add All Users"})]})]}),t.jsxs(J,{align:"center",justify:"end",mt:16,children:[t.jsx(_,{variant:"light",onClick:()=>D("createWorkflow"),children:"Cancel"}),t.jsx(_,{ml:12,type:"submit",loading:n,children:"Create"})]})]})})};function Ir({itemParent:e}){const{data:o,setData:r,post:s,processing:n,errors:l,reset:a}=X({folder_item_id:(e==null?void 0:e.item_id)??"",name:"",prefix:""}),{closeModal:i}=$();return{data:o,setData:r,handleSubmit:p=>{p.preventDefault(),o.folder_item_id=(e==null?void 0:e.item_id)??"",s(route("numbering-scheme.store"),{preserveScroll:!0,onSuccess:()=>{i("numberingScheme"),z.show({message:"Numbering scheme created",color:"green"})},onError:()=>{z.show({message:"Something went wrong",color:"red"})},onFinish:()=>a()})},processing:n,errors:l}}const Ar=({itemParent:e})=>{const{data:o,setData:r,handleSubmit:s,processing:n,errors:l}=Ir({itemParent:e}),{modals:a,closeModal:i}=$();return t.jsx(se,{opened:a.createNumberingScheme,onClose:()=>i("createNumberingScheme"),title:t.jsx(O,{size:"lg",children:"Create Numbering Scheme"}),size:550,children:t.jsxs("form",{onSubmit:s,children:[t.jsxs(re,{gap:16,children:[t.jsx(qe,{label:"Name",value:o.name,onChange:d=>r("name",d.target.value),error:l.name}),t.jsx(qe,{label:"Prefix",value:o.prefix,onChange:d=>r("prefix",d.target.value),error:l.prefix})]}),t.jsxs(J,{align:"center",justify:"end",mt:16,children:[t.jsx(_,{variant:"light",onClick:()=>i("createNumberingScheme"),children:"Cancel"}),t.jsx(_,{ml:12,type:"submit",loading:n,children:"Create"})]})]})})};function zr({itemParent:e,close:o}){const{data:r,setData:s,post:n,processing:l,errors:a,reset:i,clearErrors:d}=X({parent_id:"",name:""}),{closeModal:p}=$();return{data:r,setData:s,submit:k=>{r.parent_id=(e==null?void 0:e.item_id)||"",k.preventDefault(),n(route("folder.create"),{preserveScroll:!0,onSuccess:()=>{z.show({message:"New folder created",color:"green"})},onError:v=>{let m="";Object.keys(v).length>0?m=v[Object.keys(v)[0]]:m="Error during file upload. Please try again later.",z.show({message:m,color:"red"})},onFinish:()=>{p("folder"),i(),d()}})},processing:l,errors:a}}const Or=({itemParent:e})=>{const{data:o,setData:r,submit:s,processing:n,errors:l}=zr({itemParent:e,close}),{modals:a,closeModal:i}=$();return t.jsx(se,{opened:a.folder,onClose:()=>i("folder"),title:t.jsx(O,{fw:"bold",size:"lg",children:"Create Folder"}),size:550,children:t.jsxs("form",{onSubmit:s,children:[t.jsx(re,{gap:16,children:t.jsx(qe,{id:"name",type:"text",name:"name",value:o.name,placeholder:"Folder Name",onChange:d=>r("name",d.target.value),error:l.name})}),t.jsxs(J,{align:"center",justify:"end",mt:16,children:[t.jsx(_,{variant:"outline",onClick:()=>i("folder"),children:"Cancel"}),t.jsx(_,{ml:12,type:"submit",loading:n,children:"Create"})]})]})})};function Rr({workflowId:e,isOpen:o}){const[r,s]=u.useState(null);u.useEffect(()=>{e&&o&&n(e)},[e,o]);const n=async l=>{try{const a=await eo.get(`/workflows/${l}`);s(a.data)}catch(a){console.error("Error fetching workflow",a)}};return r}function Ur({itemParent:e,isOpen:o}){const[r,s]=u.useState("reviewal"),n=Rr({workflowId:e==null?void 0:e.workflow_id,isOpen:o}),l=ko(r,o),{closeModal:a}=$(),{data:i,setData:d,put:p,processing:b,errors:k,reset:v,clearErrors:m}=X({resolution:"",type:"",users:[]}),[h,y]=u.useState([]),D=l.length;u.useEffect(()=>{n&&(s(n.type||""),d({resolution:n.resolution||"",type:n.type||"",users:n.users.map(j=>({user_id:j.id}))}),y(n.users.map(j=>({selectedUser:j.id.toString()}))))},[n,o]),u.useEffect(()=>{y([])},[r]);const C=j=>{j.preventDefault();const E=h.map(I=>parseInt(I.selectedUser)).filter(I=>!isNaN(I));i.users=E.map(I=>({user_id:I})),p(route("workflows.update",e==null?void 0:e.workflow_id),{onSuccess:()=>{a("updateWorkflow"),z.show({message:"Workflow updated successfully",color:"green"})},onError:I=>{z.show({message:"Something went wrong",color:"red"})},onFinish:()=>v()})},g=()=>{h.length<D&&y([...h,{selectedUser:""}])},f=()=>{const j=h.map(R=>R.selectedUser),I=l.filter(R=>!j.includes(R.id.toString())).map(R=>({selectedUser:R.id.toString()}));y([...h,...I])},F=j=>{const E=[...h];E.splice(j,1),y(E)},x=(j,E)=>{const I=[...h];I[j].selectedUser=E||"",y(I)},M=h.map(j=>j.selectedUser).filter(j=>j!=="");return{data:i,setData:d,handleUpdateWorkflow:C,processing:b,errors:k,users:h,setWorkflowType:s,addUser:g,removeUser:F,handleUserChange:x,addAllUsers:f,maxUsers:D,selectedUserIds:M,fetchedUsers:l}}function Tr({workflowId:e,onDeleteSuccess:o}){const{delete:r,processing:s}=X();return{handleDeleteWorkflow:()=>{if(!e){z.show({message:"Workflow ID is missing.",color:"red"});return}r(route("workflows.destroy",e),{preserveScroll:!0,onSuccess:()=>{z.show({message:"Workflow deleted successfully.",color:"green"}),o()},onError:l=>{let a="Failed to delete workflow.";l&&Object.keys(l).length>0&&(a=l[Object.keys(l)[0]]),z.show({message:a,color:"red"})}})},processing:s}}const Wr=({workflowId:e})=>{const{modals:o,closeModal:r,openModal:s}=$(),n=o.confirmDeleteWorkflow,{handleDeleteWorkflow:l,processing:a}=Tr({workflowId:e,onDeleteSuccess:()=>{r("confirmDeleteWorkflow"),r("updateWorkflow")}});return t.jsxs(se,{opened:n,onClose:()=>r("confirmDeleteWorkflow"),title:t.jsx(O,{fw:"bold",size:"lg",children:"Confirm Delete"}),size:"sm",centered:!0,children:[t.jsx(O,{c:"gray.8",children:"Are you sure you want to delete this workflow? This action cannot be undone."}),t.jsxs(J,{align:"center",justify:"flex-end",mt:16,children:[t.jsx(_,{variant:"light",onClick:()=>{r("confirmDeleteWorkflow"),s("updateWorkflow")},children:"Cancel"}),t.jsx(_,{color:"red",ml:12,onClick:l,loading:a,children:"Delete"})]})]})},Lr=({itemParent:e})=>{const{modals:o,closeModal:r,openModal:s}=$(),n=o.updateWorkflow,{data:l,setData:a,handleUpdateWorkflow:i,processing:d,users:p,setWorkflowType:b,addUser:k,removeUser:v,handleUserChange:m,addAllUsers:h,maxUsers:y,selectedUserIds:D,fetchedUsers:C,errors:g}=Ur({itemParent:e,isOpen:n}),f=F=>C.filter(x=>!D.includes(x.id.toString())||x.id.toString()===p[F].selectedUser).map(x=>({value:x.id.toString(),label:`${x.name} (${x.email})`}));return t.jsxs(t.Fragment,{children:[t.jsx(se,{opened:n,onClose:()=>r("updateWorkflow"),title:t.jsx(O,{fw:"bold",size:"lg",children:"Update Workflow Process"}),size:550,children:t.jsxs("form",{onSubmit:i,children:[t.jsxs(re,{gap:16,children:[t.jsx(O,{size:"sm",c:"dimmed",children:"Routinely directs any uploaded file in this folder through a predefined approval workflow"}),t.jsx(me.Group,{name:"status",value:l.type,onChange:F=>{a("type",F),b(F)},children:t.jsxs(N,{mt:"xs",children:[t.jsx(me,{value:"reviewal",label:"Review"}),t.jsx(me,{value:"approval",label:"Approval"})]})}),t.jsx(Do,{label:"Resolution",placeholder:"Your resolution for this approval",value:l.resolution??"",onChange:F=>a("resolution",F.target.value),error:g.resolution,autosize:!0,minRows:2,maxRows:4}),t.jsx(O,{size:"sm",fw:500,mb:-8,children:"Users in this workflow"}),p.map((F,x)=>t.jsxs(N,{justify:"space-between",align:"flex-end",children:[t.jsx(oo,{placeholder:"Select a user",data:f(x),value:F.selectedUser,onChange:M=>m(x,M),required:!0,style:{flex:1},allowDeselect:!1}),t.jsx(B,{color:"red",onClick:()=>v(x),title:"Remove User",children:t.jsx(De,{size:18})})]},x)),t.jsxs(N,{children:[p.length<y&&t.jsx(_,{variant:"subtle",color:"green",leftSection:t.jsx(he,{size:16}),onClick:k,disabled:p.length>=y,children:"Add User"}),D.length<y&&t.jsx(_,{variant:"subtle",color:"blue",leftSection:t.jsx(he,{size:16}),onClick:h,disabled:p.length>=y,children:"Add All Users"})]})]}),t.jsxs(J,{align:"center",justify:"end",mt:16,children:[t.jsx(_,{variant:"light",onClick:()=>r("updateWorkflow"),children:"Cancel"}),t.jsx(_,{ml:12,type:"submit",loading:d,children:"Update"}),t.jsx(B,{variant:"transparent",color:"red",onClick:()=>{s("confirmDeleteWorkflow"),r("updateWorkflow")},title:"Delete Workflow",ml:12,children:t.jsx(De,{size:18})})]})]})}),t.jsx(Wr,{workflowId:e==null?void 0:e.workflow_id})]})},Nr=({uploadFileRef:e,itemParent:o})=>{var n;const{openModal:r}=$(),{generateReport:s}=pt();return t.jsxs(N,{h:"50%",px:32,align:"center",justify:"space-between",children:[t.jsxs(N,{gap:"xs",children:[t.jsxs(fe,{shadow:"md",width:220,transitionProps:{transition:"pop-top-left"},position:"bottom-start",children:[t.jsx(fe.Target,{children:t.jsx(_,{variant:"subtle",color:"dark.3",leftSection:t.jsx(he,{size:18}),rightSection:t.jsx(Ye,{size:12}),children:"New"})}),t.jsxs(fe.Dropdown,{children:[t.jsx(fe.Item,{leftSection:t.jsx(Mt,{style:{width:H(14),height:H(14)}}),onClick:()=>r("folder"),children:"New Folder"}),t.jsx(fe.Item,{leftSection:t.jsx(_t,{style:{width:H(14),height:H(14)}}),onClick:()=>{var l;return(l=e==null?void 0:e.current)==null?void 0:l.call(e)},children:"Upload Files"}),t.jsx(fe.Item,{leftSection:t.jsx(At,{style:{width:H(14),height:H(14)}}),children:"Upload Folder"})]})]}),t.jsx(V,{label:"Properties",position:"bottom",withArrow:!0,children:t.jsx(B,{component:Ge,size:"lg",href:route("folder.edit",{id:o==null?void 0:o.item_id}),variant:"transparent",color:"dark.3",children:t.jsx(Ct,{size:18})})}),t.jsx(V,{label:"Workflow",position:"bottom",withArrow:!0,children:t.jsx(B,{variant:"transparent",size:"lg",color:o!=null&&o.workflow_id?"green.8":"dark.3",onClick:()=>r(o!=null&&o.workflow_id?"updateWorkflow":"createWorkflow"),children:t.jsx(ct,{size:18})})}),t.jsx(V,{label:"Metadata",position:"bottom",withArrow:!0,children:t.jsx(B,{component:Ge,size:"lg",href:route("folder.showRequiredMetadata",{id:o==null?void 0:o.item_id}),variant:"transparent",color:(n=o==null?void 0:o.required_metadata)!=null&&n.length?"green.8":"dark.3",children:t.jsx(ot,{size:18})})}),t.jsx(V,{label:"Activity",position:"bottom",withArrow:!0,children:t.jsx(B,{component:Ge,size:"lg",href:route("folder.activity-log",{id:o==null?void 0:o.item_id}),variant:"transparent",color:"dark.3",children:t.jsx(Ft,{size:18})})}),t.jsx(V,{label:"Numbering",position:"bottom",withArrow:!0,children:t.jsx(B,{size:"lg",variant:"transparent",color:o!=null&&o.numbering_scheme_id?"green.8":"dark.3",onClick:()=>r(o!=null&&o.numbering_scheme_id?"updateNumberingScheme":"createNumberingScheme"),children:t.jsx(zt,{size:18})})}),t.jsx(V,{label:"Column",position:"bottom",withArrow:!0,children:t.jsx(B,{variant:"transparent",color:"dark.3",size:"lg",onClick:()=>r("selectMetadataColumns"),children:t.jsx(ut,{size:18})})}),t.jsx(V,{label:"Report",position:"bottom",withArrow:!0,children:t.jsx(B,{variant:"transparent",color:"dark.3",size:"lg",onClick:()=>s((o==null?void 0:o.item_id)??""),children:t.jsx(Et,{size:18})})})]}),t.jsxs(N,{gap:"xs",children:[t.jsx(V,{label:"Sort",position:"bottom",withArrow:!0,children:t.jsxs(B,{variant:"transparent",color:"dark.3",size:"lg",children:[t.jsx(Ot,{size:18}),t.jsx(Ye,{size:12,style:{marginLeft:H(4)}})]})}),t.jsx(V,{label:"View",position:"bottom",withArrow:!0,children:t.jsxs(B,{variant:"transparent",color:"dark.3",size:"lg",children:[t.jsx(lt,{size:18}),t.jsx(Ye,{size:12,style:{marginLeft:H(4)}})]})})]}),t.jsx(Or,{itemParent:o}),t.jsx(Mr,{itemParent:o}),t.jsx(Lr,{itemParent:o}),t.jsx(Ar,{itemParent:o}),t.jsx(dt,{itemParent:o})]})};function $r(e){return fetch(e,{headers:{"Content-Type":"application/json",Accept:"application/json"}}).then(o=>o.json())}function Pr(){return{downloadFiles:({all:o,ids:r,parentId:s})=>{if(!o&&(r==null?void 0:r.length)===0)return;const n=new URLSearchParams;s&&n.append("parent_id",String(s)),o?n.append("all",o?"1":"0"):r==null||r.forEach(a=>n.append("ids[]",a));const l=route("item.download");$r(`${l}?${n.toString()}`).then(a=>{if(!a.url)return;const i=document.createElement("a");i.download=a.filename,i.href=a.url,i.click()})}}}function Br({setSelectedRecord:e}){const{data:o,delete:r,processing:s}=X({ids:[]}),{closeModal:n}=$();return{handleDelete:a=>{o.ids=a,r(route("item.delete"),{onSuccess:()=>{n("deleteFiles"),setTimeout(()=>{e([])},100),z.show({message:"Files deleted",color:"green"})},onError:i=>{let d="Error during file deletion. Please try again later.";Object.keys(i).length>0&&(d=i[Object.keys(i)[0]]),z.show({message:d,color:"red"})}})},processing:s}}const Kr=({selectedIds:e,setSelectedRecord:o})=>{const{handleDelete:r,processing:s}=Br({setSelectedRecord:o}),{modals:n,closeModal:l}=$();return t.jsx(se,{opened:n.deleteFiles,onClose:()=>l("deleteFiles"),title:t.jsx(O,{fw:"bold",size:"lg",children:"Delete Files"}),size:550,children:t.jsxs("form",{onSubmit:a=>{a.preventDefault(),r(e)},children:[t.jsx(O,{c:"dimmed",children:"Delete selected files?"}),t.jsxs(J,{align:"center",justify:"end",mt:16,children:[t.jsx(_,{variant:"subtle",onClick:()=>l("deleteFiles"),color:"gray",children:"Cancel"}),t.jsx(_,{ml:12,type:"submit",loading:s,color:"red",children:"Delete"})]})]})})};function Hr(e,o){const[r,s]=u.useState({itemParent:null,itemAncestors:null,itemContents:[]}),[n,l]=u.useState(!1),[a,i]=u.useState(null);u.useEffect(()=>{o&&d(e)},[e,o]);const d=async p=>{l(!0),i(null);try{const b=await eo.get(route("item.showItems",{item:p}));s(b.data)}catch(b){i("Failed to fetch items."),console.error(b)}finally{l(!1)}};return{data:r,loading:n,error:a}}function Gr({setSelectedRecord:e}){const{data:o,setData:r,put:s,processing:n,errors:l,reset:a,clearErrors:i}=X({ids:[],destination_folder_id:""});return{data:o,setData:r,moveDocuments:()=>{s(route("document.move"),{onSuccess:()=>{e([]),z.show({message:"Documents moved successfully",color:"green"}),a()},onError:p=>{z.show({message:"Failed to move documents",color:"red"})},onFinish:()=>{i()}})},processing:n,errors:l,reset:a}}const Yr=({selectedDocumentIds:e,setSelectedRecord:o})=>{const{modals:r,closeModal:s}=$(),n=r.moveModal,[l,a]=u.useState(null),{data:i,loading:d,error:p}=Hr(l,n),{data:b,setData:k,moveDocuments:v,processing:m}=Gr({setSelectedRecord:o}),h=C=>{a(C)},y=()=>{i.itemParent&&i.itemParent.parent_id?a(i.itemParent.parent_id):a(null)},D=()=>{if(!l){z.show({message:"Please select a destination folder.",color:"red"});return}b.ids=e,b.destination_folder_id=l,v(),s("moveModal")};return t.jsx(se,{opened:n,onClose:()=>s("moveModal"),title:"Move Documents",size:"lg",children:t.jsxs(re,{gap:"md",children:[t.jsxs(N,{children:[l&&t.jsx(B,{onClick:y,children:t.jsx(St,{size:16})}),t.jsx(O,{children:"Choose Destination Folder"})]}),d?t.jsx(O,{children:"Loading..."}):p?t.jsx(O,{c:"red",children:p}):t.jsx(re,{gap:"sm",style:{maxHeight:400,overflowY:"auto"},children:i.itemContents.map(C=>t.jsxs(N,{gap:"sm",style:{cursor:"pointer"},onDoubleClick:()=>h(C.item_id),children:[t.jsx(ft,{}),t.jsx(O,{children:C.name})]},C.item_id))}),t.jsxs(N,{justify:"flex-end",mt:"md",children:[t.jsx(_,{variant:"outline",onClick:()=>s("moveModal"),children:"Cancel"}),t.jsx(_,{onClick:D,disabled:!l||m,loading:m,children:"Move Here"})]})]})})},qr=({setSelectedRecord:e,selectedIds:o,parentId:r})=>{const{downloadFiles:s}=Pr(),{openModal:n}=$();return t.jsxs(N,{h:"50%",px:"md",align:"center",justify:"flex-start",children:[t.jsx(_,{onClick:()=>n("deleteFiles"),variant:"subtle",color:"dark.3",leftSection:t.jsx(De,{size:18}),children:"Delete"}),t.jsx(_,{onClick:()=>s({all:!1,ids:o,parentId:r}),variant:"subtle",color:"dark.3",leftSection:t.jsx(mt,{size:18}),children:"Download"}),t.jsx(_,{onClick:()=>n("moveModal"),variant:"subtle",color:"dark.3",leftSection:t.jsx(It,{size:18}),children:"Move"}),t.jsx(Kr,{selectedIds:o,setSelectedRecord:e}),t.jsx(Yr,{selectedDocumentIds:o,setSelectedRecord:e})]})};function Vr(e){const{data:o,post:r,reset:s,clearErrors:n}=X({parent_id:"",files:[]});return{uploadFiles:a=>{o.parent_id=e.item_id,o.files=a.map(i=>({file:i})),r(route("document.store"),{onSuccess:()=>{z.show({message:"Document uploaded",color:"green"})},onError:i=>{let d="";Object.keys(i).length>0?d=i[Object.keys(i)[0]]:d="Error during file upload. Please try again later.",z.show({message:d,color:"red"})},onFinish:()=>{s(),n()}})}}}function Jr(){const[e,o]=u.useState([]),s=(n=>n.map(l=>l.id))(e);return{selectedRecord:e,setSelectedRecord:o,ids:s}}function Xr(){return{openFolder:(o,r)=>{o==="folder"&&Zo.visit(route("folder.show",{id:r}))}}}function Zr({folderId:e,isOpen:o}){const[r,s]=u.useState([]),[n,l]=u.useState(!1),[a,i]=u.useState(null);return u.useEffect(()=>{e&&o&&(async()=>{l(!0);try{const p=await eo.get(`/folder/${e}/metadata_columns`);s(p.data.metadata_columns),i(null)}catch(p){i("Failed to fetch existing metadata columns."),console.error(p)}finally{l(!1)}})()},[e,o]),{existingMetadataColumns:r,loading:n,error:a}}const Qr=({folderId:e})=>{const{modals:o,closeModal:r}=$(),s=o.selectMetadataColumns,{metadataList:n}=gt(),{existingMetadataColumns:l,loading:a,error:i}=Zr({folderId:e,isOpen:s}),{data:d,setData:p,post:b,processing:k,errors:v,reset:m}=X({metadata_columns:[{id:Date.now(),value:""}],metadata_ids:[]});u.useEffect(()=>{if(l.length>0){const g=l.map(f=>({id:f.metadata_id,value:f.metadata_id.toString()}));p("metadata_columns",g)}},[l]),u.useEffect(()=>{const g=d.metadata_columns.map(f=>parseInt(f.value)).filter(f=>!isNaN(f));p("metadata_ids",g)},[d.metadata_columns]);const h=()=>{p("metadata_columns",[...d.metadata_columns,{id:Date.now(),value:""}])},y=g=>{p("metadata_columns",d.metadata_columns.filter(f=>f.id!==g))},D=(g,f)=>{const F=d.metadata_columns.map(x=>x.id===g?{...x,value:f}:x);p("metadata_columns",F)},C=g=>{g.preventDefault(),d.metadata_columns.map(f=>parseInt(f.value)).filter(f=>!isNaN(f)),b(route("folder.selectMetadataColumn",e),{preserveScroll:!0,onSuccess:()=>{r("selectMetadataColumns"),z.show({title:"Success",message:"Metadata columns selected successfully",color:"green"}),m()},onError:()=>{z.show({title:"Error",message:"Failed to select metadata columns",color:"red"})}})};return t.jsx(se,{opened:s,onClose:()=>{r("selectMetadataColumns"),m()},title:t.jsx(O,{fw:"bold",size:"lg",children:"Select Metadata Columns"}),size:550,children:a?t.jsx(J,{justify:"center",align:"center",h:"100%",children:t.jsx(wo,{})}):i?t.jsx(vt,{icon:t.jsx(yt,{size:16}),title:"Error",color:"red",children:i}):t.jsxs("form",{onSubmit:C,children:[t.jsxs(re,{gap:16,children:[t.jsx(O,{c:"dimmed",children:"Select the metadata columns you want to display"}),d.metadata_columns.map(g=>t.jsxs(N,{justify:"space-between",align:"flex-end",children:[t.jsx(oo,{placeholder:"Pick a metadata column",data:n.map(f=>({value:f.metadata_id.toString(),label:f.name})),value:g.value,onChange:f=>D(g.id,f||""),w:"90%",required:!0}),d.metadata_columns.length>1&&t.jsx(B,{color:"red",variant:"subtle",onClick:()=>y(g.id),children:t.jsx(De,{size:18})})]},g.id)),t.jsx(J,{justify:"flex-start",children:t.jsx(_,{variant:"subtle",color:"blue.5",leftSection:t.jsx(he,{size:18}),onClick:h,children:"Add New Column"})})]}),t.jsxs(J,{align:"center",justify:"end",mt:16,children:[t.jsx(_,{variant:"outline",onClick:()=>{r("selectMetadataColumns"),m()},children:"Cancel"}),t.jsx(_,{ml:12,type:"submit",loading:k,children:"Save"})]})]})})};function As({itemParent:e,itemAncestors:o,itemContents:r}){var v;const s=u.useRef(null),{uploadFiles:n}=Vr(e),{selectedRecord:l,setSelectedRecord:a,ids:i}=Jr(),{openFolder:d}=Xr(),{openDocument:p}=ht(),b=(v=e.metadata_columns)==null?void 0:v.map(m=>({accessor:`metadata_${m.metadata_id}`,title:m.name,render:h=>{var D;const y=(D=h.metadata)==null?void 0:D.find(C=>C.metadata_id===m.metadata_id);return y?y.value:null}})),k=[{accessor:"name",render:({mime:m,type:h,name:y,status:D,missing_required_metadata:C})=>t.jsxs(N,{align:"center",gap:12,children:[t.jsx(tt,{mime:m??"",isFolder:h==="folder",approvalStatus:D,missingRequiredMetadata:C}),t.jsx("span",{children:y})]})},{accessor:"updated_at",title:"Last Modified"},...b??[]];return t.jsxs(t.Fragment,{children:[t.jsx(Qo,{title:"My Files"}),t.jsx(rt,{toolbar:l.length>0?t.jsx(qr,{setSelectedRecord:a,selectedIds:i,parentId:e.item_id}):t.jsx(Nr,{itemParent:e,uploadFileRef:s}),children:t.jsx(_r,{onDrop:n,openRef:s,children:t.jsxs(re,{px:8,gap:24,py:8,style:{pointerEvents:"all"},children:[t.jsx(st,{ancestors:o}),r.length?t.jsx(et,{textSelectionDisabled:!0,columns:k,records:r,customRowAttributes:({type:m,id:h})=>({onDoubleClick:y=>{y.button===0&&(m==="folder"?d(m,h):m==="document"&&p(h))}}),highlightOnHover:!0,verticalSpacing:"lg",horizontalSpacing:"xl",selectedRecords:l,onSelectedRecordsChange:a}):t.jsx(O,{size:"lg",c:"gray.5",children:"This folder is empty"})]})})}),t.jsx(Qr,{folderId:e.item_id})]})}export{As as default};
