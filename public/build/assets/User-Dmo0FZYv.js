import{W as v,n as f,j as e,M as _,d as j,B,Y as W,r as U}from"./app-CxnqOemo.js";import{a as N,A as Y,I as G,b as M}from"./Authenticated-DPkSzb4L.js";import{T as h,F as g}from"./OfficeLogo-jKA_BVCF.js";import{S as b}from"./Stack-DrHI03CL.js";import{T as u}from"./TextInput-LWDnICFN.js";import{S as x}from"./Select-KZWyY6k6.js";import{B as p}from"./Button-B30N7NN9.js";import{Y as V}from"./index-D2EMUr73.js";import{G as q,u as w}from"./NotificationMenu-EwVgCQfi.js";import{A as C}from"./IconUser-XmEDWUCl.js";import{I as H}from"./IconEdit-B3cN1PLH.js";import{u as L,a as J}from"./use-search-datatable-DpfoSj90.js";import"./Popover-kvuoOV3s.js";import"./use-resolved-styles-api-DtoRyz5U.js";import"./get-sorted-breakpoints-D9sDYt0h.js";import"./InputBase-Ve8qJn79.js";import"./OptionsDropdown-B6atY6w1.js";import"./CheckIcon-XSAlXsAl.js";import"./Combobox-D-HuQijW.js";import"./Checkbox-CLd7z3dm.js";function K({close:o}){const{data:t,setData:s,post:r,processing:a,errors:i,reset:n}=v({name:"",email:"",office_position:"",workflow_role:"",system_role:""});return{data:t,setData:s,submit:l=>{l.preventDefault(),r(route("users.register"),{onSuccess:()=>{f.show({position:"top-center",message:"New user added successfully. An email has been sent.",color:"green"}),n(),o()},onError:()=>{f.show({position:"top-center",message:"Failed to add user.",color:"red"})}})},processing:a,errors:i}}const Q=({isOpened:o,close:t})=>{const{data:s,setData:r,submit:a,processing:i,errors:n}=K({close:t}),c=()=>{t()};return e.jsx(_,{opened:o,onClose:c,title:e.jsx(h,{size:"lg",fw:500,children:"Add User"}),size:550,children:e.jsxs("form",{onSubmit:a,children:[e.jsxs(b,{gap:16,children:[e.jsx(u,{id:"name",type:"text",name:"name",value:s.name,label:"Name",onChange:l=>r("name",l.target.value),error:n.name}),e.jsx(u,{id:"email",type:"email",name:"email",value:s.email,label:"Email",onChange:l=>r("email",l.target.value),error:n.email}),e.jsx(u,{disabled:!0,id:"password",type:"text",name:"password",value:"BU-IRO-Arquivo",label:"Default Password"}),e.jsx(u,{id:"office_position",type:"text",name:"office_position",value:s.office_position,label:"Office Position",onChange:l=>r("office_position",l.target.value),error:n.office_position}),e.jsx(x,{id:"workflow_role",type:"text",name:"workflow_role",label:"Workflow Role",value:s.workflow_role,placeholder:"Pick value",data:["Reviewer","Approver"],onChange:(l,d)=>r("workflow_role",d.value)}),e.jsx(x,{id:"role",name:"role",label:"Role",placeholder:"Select role",data:[{value:"admin",label:"Admin"},{value:"viewer",label:"Viewer"},{value:"none",label:"None"}],value:s.system_role,onChange:l=>r("system_role",l||""),error:n.system_role})]}),e.jsxs(g,{align:"center",justify:"end",mt:16,children:[e.jsx(p,{variant:"outline",onClick:c,children:"Cancel"}),e.jsx(p,{ml:12,type:"submit",loading:i,children:"Save"})]})]})})};function X({user:o,close:t}){const{data:s,setData:r,put:a,processing:i,errors:n,reset:c}=v({office_position:"",workflow_role:"",system_role:""});return j.useEffect(()=>{o&&r({workflow_role:o.workflow_role,office_position:o.office_position,system_role:o.system_role})},[o]),{data:s,setData:r,submit:d=>{d.preventDefault(),o&&a(route("users.update",o.id),{onSuccess:()=>{f.show({position:"top-center",message:"User updated successfully",color:"green"}),t(),c()},onError:y=>{f.show({position:"top-center",message:"Failed to update user",color:"red"})}})},processing:i,errors:n}}const Z=({isOpened:o,close:t,user:s})=>{const{data:r,setData:a,submit:i,processing:n,errors:c}=X({user:s,close:t});return e.jsx(_,{opened:o,onClose:t,title:e.jsx(h,{size:"lg",children:"Edit User"}),size:550,children:e.jsxs("form",{onSubmit:i,children:[e.jsxs(b,{gap:16,children:[e.jsx(u,{id:"office_position",type:"text",name:"office_position",value:r.office_position,label:"Office Position",onChange:l=>a("office_position",l.target.value),error:c.office_position}),e.jsx(x,{id:"workflow_role",type:"text",name:"workflow_role",label:"Workflow Role",value:r.workflow_role,placeholder:"Pick value",data:["reviewer","approver"],onChange:(l,d)=>a("workflow_role",d.value)}),e.jsx(x,{id:"role",name:"role",label:"Role",placeholder:"Select role",data:[{value:"admin",label:"Admin"},{value:"viewer",label:"Viewer"}],value:r.system_role,onChange:(l,d)=>a("system_role",d.value),error:c.system_role})]}),e.jsxs(g,{align:"center",justify:"end",mt:16,children:[e.jsx(p,{variant:"outline",onClick:t,children:"Cancel"}),e.jsx(p,{ml:12,type:"submit",loading:n,children:"Save"})]})]})})};function $({user:o,close:t}){const{delete:s,processing:r,reset:a}=v();return{submit:n=>{n.preventDefault(),o&&s(route("users.delete",o==null?void 0:o.id),{onSuccess:()=>{f.show({position:"top-center",message:"User deleted successfully",color:"red"}),t(),a()},onError:()=>{f.show({position:"top-center",message:"Failed to delete user",color:"red"})}})},processing:r}}const ee=({isOpened:o,close:t,user:s})=>{const{submit:r,processing:a}=$({user:s,close:t});return e.jsx(_,{opened:o,onClose:t,title:e.jsx(h,{size:"lg",children:"Delete User"}),size:550,children:e.jsxs("form",{onSubmit:r,children:[e.jsxs(h,{c:"dimmed",mt:4,size:"sm",children:['Are you sure you want to delete the user "',s==null?void 0:s.name,'"? This action cannot be undone.']}),e.jsxs(g,{align:"center",justify:"end",mt:16,children:[e.jsx(p,{variant:"outline",onClick:t,children:"Cancel"}),e.jsx(p,{ml:12,type:"submit",loading:a,color:"red",children:"Confirm Delete"})]})]})})},oe=({users:o,total:t,perPage:s,page:r,onPageChange:a,onEdit:i,onDelete:n,selectedRecords:c,onSelectedRecordsChange:l})=>e.jsx(V,{pinLastColumn:!0,withTableBorder:!0,shadow:"xs",borderRadius:"sm",withRowBorders:!1,highlightOnHover:!0,verticalSpacing:"lg",totalRecords:t,recordsPerPage:s,page:r,onPageChange:a,columns:[{accessor:"name",noWrap:!0},{accessor:"email",noWrap:!0},{accessor:"office_position",noWrap:!0},{accessor:"workflow_role",title:"Workflow Role"},{accessor:"system_role",title:"System Role"},{accessor:"actions",title:e.jsx(B,{mr:6,children:"Actions"}),textAlign:"right",render:d=>e.jsxs(q,{gap:8,justify:"right",wrap:"nowrap",children:[e.jsx(C,{size:"sm",variant:"subtle",color:"gray",onClick:()=>i(d),children:e.jsx(H,{size:20})}),e.jsx(C,{size:"sm",variant:"subtle",color:"red",onClick:()=>n(d),children:e.jsx(N,{size:20})})]})}],records:o,selectedRecords:c,onSelectedRecordsChange:l});function be({users:o,filters:t}){const[s,r]=j.useState([]),[a,i]=j.useState(),{search:n,setSearch:c,handleSearch:l}=L(t.search||"","/users"),{page:d,setPage:y,handlePageChange:k}=J(o.current_page),[S,{open:D,close:A}]=w(!1),[R,{open:P,close:z}]=w(!1),[E,{open:O,close:T}]=w(!1),I=m=>{i(m),P()},F=m=>{i(m),O()};return e.jsxs(Y,{children:[e.jsx(W,{title:"User"}),e.jsxs(b,{px:8,gap:24,py:8,children:[e.jsx(h,{component:"h2",size:"xl",fw:600,c:"gray.8",children:"User"}),e.jsxs(g,{justify:"space-between",direction:{base:"column",md:"row"},gap:{base:12,md:0},children:[e.jsx(u,{w:{md:400},placeholder:"Search",leftSection:e.jsx(G,{style:{width:U(16),height:U(16)},stroke:1.5}),value:n,onChange:m=>{c(m.target.value),l(m.target.value)}}),e.jsx(p,{leftSection:e.jsx(M,{size:14}),onClick:D,children:"Add New User"})]}),e.jsx(oe,{users:o.data,total:o.total,perPage:o.per_page,page:d,onPageChange:m=>{y(m),k(m,o.links)},onEdit:I,onDelete:F,selectedRecords:s,onSelectedRecordsChange:r})]}),e.jsx(Q,{isOpened:S,close:A}),e.jsx(Z,{isOpened:R,close:z,user:a}),e.jsx(ee,{isOpened:E,close:T,user:a})]})}export{be as default};
