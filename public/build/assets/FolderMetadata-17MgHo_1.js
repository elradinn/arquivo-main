import{b as j,j as e,M as S,W as y,n as g,Y as q}from"./app-B1t0nWF2.js";import{Y as C}from"./index-Dt4V_hbn.js";import{u as R,A as D,d as v,b,c as k}from"./Authenticated-Cn6MVLYw.js";import{u as A}from"./use-fetch-metadata-ce2DZ9mk.js";import{u as w,C as u}from"./Combobox-BJIKhSN8.js";import{S as M}from"./Stack-DzZL_UtP.js";import{I}from"./InputBase-wHy3O5_x.js";import{G as x}from"./Avatar-DhTNpjzT.js";import{B as p}from"./Button-HaXgOpsJ.js";import{T as f}from"./Text-CTq1jRaK.js";import{c as _}from"./createReactComponent-CvUE1uel.js";import"./Checkbox-Bs46OKoO.js";import"./IconUser-DH80TIA7.js";import"./use-uncontrolled-DXGPZ-HS.js";import"./CheckIcon-CXwCS6ms.js";import"./Popover-CNN9VJPa.js";import"./ScrollArea-BzIzn8kk.js";import"./Flex-vxGNn1YY.js";import"./OfficeLogo-CnZm09Bf.js";import"./TextInput-C5DBO-eL.js";import"./get-sorted-breakpoints-QhZfIvBG.js";/**
 * @license @tabler/icons-react v3.11.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var T=_("outline","tags-off","IconTagsOff",[["path",{d:"M16.296 12.296l-5.71 -5.71",key:"svg-0"}],["path",{d:"M6 6h-1a2 2 0 0 0 -2 2v4.172a2 2 0 0 0 .586 1.414l5.71 5.71a2.41 2.41 0 0 0 3.408 0l3.278 -3.278",key:"svg-1"}],["path",{d:"M18 19l.496 -.496",key:"svg-2"}],["path",{d:"M20.384 16.367a4.822 4.822 0 0 0 -.792 -5.775l-4.592 -4.592",key:"svg-3"}],["path",{d:"M7 10h-.01",key:"svg-4"}],["path",{d:"M3 3l18 18",key:"svg-5"}]]);const O=({folderId:n,onAdd:a})=>{var c;const{modals:i,closeModal:d}=R(),[t,s]=j.useState(null),{metadataList:o}=A(),r=w({onDropdownClose:()=>r.resetSelectedOption()}),h=()=>{t&&(a(t),d("addRequiredMetadata"),s(null))},m=o.map(l=>e.jsx(u.Option,{value:l.metadata_id.toString(),children:l.name},l.metadata_id));return e.jsx(S,{opened:i.addRequiredMetadata,onClose:()=>d("addRequiredMetadata"),title:"Add Required Metadata",children:e.jsxs(M,{gap:16,children:[e.jsxs(u,{store:r,onOptionSubmit:l=>{s(parseInt(l)),r.closeDropdown()},children:[e.jsx(u.Target,{children:e.jsx(I,{component:"button",type:"button",pointer:!0,rightSection:e.jsx(u.Chevron,{}),rightSectionPointerEvents:"none",onClick:()=>r.toggleDropdown(),children:t?(c=o.find(l=>l.metadata_id===t))==null?void 0:c.name:"Select Metadata"})}),e.jsx(u.Dropdown,{children:e.jsx(u.Options,{children:m})})]}),e.jsxs(x,{justify:"flex-end",children:[e.jsx(p,{variant:"outline",onClick:()=>d("addRequiredMetadata"),children:"Cancel"}),e.jsx(p,{onClick:h,disabled:!t,children:"Add"})]})]})})};function z({folderId:n,close:a}){const{data:i,setData:d,post:t,processing:s,errors:o,reset:r}=y({metadata_id:0});return{handleAddMetadata:m=>{i.metadata_id=m,t(route("folder.updateRequiredMetadata",n),{onSuccess:()=>{a(),g.show({message:"Metadata added successfully",color:"green"})},onError:()=>{g.show({message:"Something went wrong",color:"red"})},onFinish:()=>r()})},processing:s,errors:o}}function E({folderId:n,metadataId:a,onDeleteSuccess:i}){const{delete:d,processing:t}=y();return{handleDelete:()=>{d(route("folder.deleteRequiredMetadata",{folder:n,metadata:a}),{onSuccess:()=>{g.show({message:"Required Metadata deleted successfully.",color:"green"}),i()},onError:()=>{g.show({message:"Failed to delete Required Metadata.",color:"red"})}})},processing:t}}function de({requiredMetadata:n,folder:a}){const{openModal:i,closeModal:d}=R(),{handleAddMetadata:t}=z({folderId:a.item_id,close:()=>d("addRequiredMetadata")}),[s,o]=j.useState(null),{handleDelete:r,processing:h}=E({folderId:a.item_id,metadataId:s||0,onDeleteSuccess:()=>{o(null)}}),m=c=>{o(c)};return e.jsxs(D,{children:[e.jsx(q,{title:"Required Metadata"}),e.jsxs(M,{gap:24,p:8,children:[e.jsxs(x,{justify:"space-between",children:[e.jsxs(f,{component:"h2",size:"xl",fw:600,c:"gray.8",children:["Required Metadata for ",a.name]}),e.jsx(p,{leftSection:e.jsx(v,{size:16}),onClick:()=>i("addRequiredMetadata"),children:"Add Required Metadata"})]}),n.length>0?e.jsx(C,{columns:[{accessor:"name",title:"Name"},{accessor:"description",title:"Description"},{accessor:"actions",title:"Actions",render:c=>e.jsx(x,{gap:"xs",children:e.jsx(b,{color:"red",onClick:()=>m(c.metadata_id),children:e.jsx(k,{size:16})})})}],textSelectionDisabled:!0,records:n,highlightOnHover:!0,verticalSpacing:"lg",horizontalSpacing:"xl"}):e.jsxs(M,{align:"center",justify:"center",h:"100%",children:[e.jsx(T,{size:128,color:"gray",stroke:1}),e.jsx(f,{size:"lg",c:"gray.6",mt:"md",children:"No required metadata available."})]}),e.jsx(O,{folderId:a.item_id,onAdd:t}),e.jsxs(S,{opened:s!==null,onClose:()=>o(null),title:"Confirm Deletion",children:[e.jsx(f,{children:"Are you sure you want to delete this required metadata?"}),e.jsxs(x,{justify:"right",mt:"md",children:[e.jsx(p,{variant:"outline",onClick:()=>o(null),children:"Cancel"}),e.jsx(p,{color:"red",onClick:r,loading:h,children:"Delete"})]})]})]})]})}export{de as default};
