import{W as v,n as p,j as e,M as _,a as w,B as W,Y as B,r as U}from"./app-BmzHW2aG.js";import{a as N,A as Y,I as G,b as M}from"./Authenticated-5l6X088p.js";import{T as h,F as x}from"./OfficeLogo-CfOp-pHn.js";import{S as b}from"./Stack-BZ7eBtHq.js";import{T as f}from"./TextInput-CdceJqyX.js";import{S as g}from"./Select-BX6eeCxj.js";import{B as u}from"./Button-BB71hi8N.js";import{Y as V}from"./index-fZblaT9_.js";import{G as H,A as C,u as j}from"./NotificationMenu-C3ygNq3x.js";import{I as L}from"./IconEdit-1I_O07rv.js";import{u as q,a as J}from"./use-search-datatable-BZpbWxMu.js";import"./Popover-CIouR1lw.js";import"./use-uncontrolled-DGsFr_OH.js";import"./IconUser-NFy9mVT5.js";import"./get-sorted-breakpoints-Clcm94Ds.js";import"./InputBase-BZJKOUp-.js";import"./OptionsDropdown-D_CzVDh5.js";import"./CheckIcon-Chav3WRF.js";import"./Combobox-D4zBXfDc.js";import"./Checkbox-CApOXT2W.js";function K(){const{data:o,setData:t,post:s,processing:r,errors:l,reset:i}=v({name:"",email:"",office_position:"",workflow_role:"",system_role:""});return{data:o,setData:t,submit:c=>{c.preventDefault(),s(route("users.register"),{onSuccess:()=>{p.show({message:"New user added successfully. An email has been sent.",color:"green"}),i()},onError:()=>{p.show({message:"Failed to add user.",color:"red"})}})},processing:r,errors:l}}const Q=({isOpened:o,close:t})=>{const{data:s,setData:r,submit:l,processing:i,errors:n}=K(),c=()=>{t()};return e.jsx(_,{opened:o,onClose:c,title:e.jsx(h,{size:"lg",children:"Add User"}),size:550,children:e.jsxs("form",{onSubmit:l,children:[e.jsxs(b,{gap:16,children:[e.jsx(f,{id:"name",type:"text",name:"name",value:s.name,label:"Name",onChange:a=>r("name",a.target.value),error:n.name}),e.jsx(f,{id:"email",type:"email",name:"email",value:s.email,label:"Email",onChange:a=>r("email",a.target.value),error:n.email}),e.jsx(f,{id:"office_position",type:"text",name:"office_position",value:s.office_position,label:"Office Position",onChange:a=>r("office_position",a.target.value),error:n.office_position}),e.jsx(g,{id:"workflow_role",type:"text",name:"workflow_role",label:"Workflow Role",value:s.workflow_role,placeholder:"Pick value",data:["Reviewer","Approver"],onChange:(a,d)=>r("workflow_role",d.value)}),e.jsx(g,{id:"role",name:"role",label:"Role",placeholder:"Select role",data:[{value:"admin",label:"Admin"},{value:"viewer",label:"Viewer"}],value:s.system_role,onChange:a=>r("system_role",a||""),error:n.system_role})]}),e.jsxs(x,{align:"center",justify:"end",mt:16,children:[e.jsx(u,{variant:"outline",onClick:c,children:"Cancel"}),e.jsx(u,{ml:12,type:"submit",loading:i,children:"Save"})]})]})})};function X({user:o,close:t}){const{data:s,setData:r,put:l,processing:i,errors:n,reset:c}=v({office_position:"",workflow_role:"",system_role:""});return w.useEffect(()=>{o&&r({workflow_role:o.workflow_role,office_position:o.office_position,system_role:o.system_role})},[o]),{data:s,setData:r,submit:d=>{d.preventDefault(),o&&l(route("users.update",o.id),{onSuccess:()=>{p.show({message:"User updated successfully",color:"green"}),t(),c()},onError:y=>{p.show({message:"Failed to update user",color:"red"})}})},processing:i,errors:n}}const Z=({isOpened:o,close:t,user:s})=>{const{data:r,setData:l,submit:i,processing:n,errors:c}=X({user:s,close:t});return e.jsx(_,{opened:o,onClose:t,title:e.jsx(h,{size:"lg",children:"Edit User"}),size:550,children:e.jsxs("form",{onSubmit:i,children:[e.jsxs(b,{gap:16,children:[e.jsx(f,{id:"office_position",type:"text",name:"office_position",value:r.office_position,label:"Office Position",onChange:a=>l("office_position",a.target.value),error:c.office_position}),e.jsx(g,{id:"workflow_role",type:"text",name:"workflow_role",label:"Workflow Role",value:r.workflow_role,placeholder:"Pick value",data:["reviewer","approver"],onChange:(a,d)=>l("workflow_role",d.value)}),e.jsx(g,{id:"role",name:"role",label:"Role",placeholder:"Select role",data:[{value:"admin",label:"Admin"},{value:"viewer",label:"Viewer"}],value:r.system_role,onChange:(a,d)=>l("system_role",d.value),error:c.system_role})]}),e.jsxs(x,{align:"center",justify:"end",mt:16,children:[e.jsx(u,{variant:"outline",onClick:t,children:"Cancel"}),e.jsx(u,{ml:12,type:"submit",loading:n,children:"Save"})]})]})})};function $({user:o,close:t}){const{delete:s,processing:r,reset:l}=v();return{submit:n=>{n.preventDefault(),o&&s(route("users.delete",o==null?void 0:o.id),{onSuccess:()=>{p.show({message:"User deleted successfully",color:"red"}),t(),l()},onError:()=>{p.show({message:"Failed to delete user",color:"red"})}})},processing:r}}const ee=({isOpened:o,close:t,user:s})=>{const{submit:r,processing:l}=$({user:s,close:t});return e.jsx(_,{opened:o,onClose:t,title:e.jsx(h,{size:"lg",children:"Delete User"}),size:550,children:e.jsxs("form",{onSubmit:r,children:[e.jsxs(h,{c:"dimmed",mt:4,size:"sm",children:['Are you sure you want to delete the user "',s==null?void 0:s.name,'"? This action cannot be undone.']}),e.jsxs(x,{align:"center",justify:"end",mt:16,children:[e.jsx(u,{variant:"outline",onClick:t,children:"Cancel"}),e.jsx(u,{ml:12,type:"submit",loading:l,color:"red",children:"Confirm Delete"})]})]})})},oe=({users:o,total:t,perPage:s,page:r,onPageChange:l,onEdit:i,onDelete:n,selectedRecords:c,onSelectedRecordsChange:a})=>e.jsx(V,{pinLastColumn:!0,withTableBorder:!0,shadow:"xs",borderRadius:"sm",withRowBorders:!1,highlightOnHover:!0,verticalSpacing:"lg",totalRecords:t,recordsPerPage:s,page:r,onPageChange:l,columns:[{accessor:"name",noWrap:!0},{accessor:"email",noWrap:!0},{accessor:"office_position",noWrap:!0},{accessor:"workflow_role",title:"Workflow Role"},{accessor:"system_role",title:"System Role"},{accessor:"actions",title:e.jsx(W,{mr:6,children:"Actions"}),textAlign:"right",render:d=>e.jsxs(H,{gap:8,justify:"right",wrap:"nowrap",children:[e.jsx(C,{size:"sm",variant:"subtle",color:"gray",onClick:()=>i(d),children:e.jsx(L,{size:20})}),e.jsx(C,{size:"sm",variant:"subtle",color:"red",onClick:()=>n(d),children:e.jsx(N,{size:20})})]})}],records:o,selectedRecords:c,onSelectedRecordsChange:a});function be({users:o,filters:t}){const[s,r]=w.useState([]),[l,i]=w.useState(),{search:n,setSearch:c,handleSearch:a}=q(t.search||"","/users"),{page:d,setPage:y,handlePageChange:k}=J(o.current_page),[S,{open:D,close:A}]=j(!1),[R,{open:z,close:E}]=j(!1),[P,{open:T,close:O}]=j(!1),F=m=>{i(m),z()},I=m=>{i(m),T()};return e.jsxs(Y,{children:[e.jsx(B,{title:"User"}),e.jsxs(b,{px:8,gap:24,py:8,children:[e.jsx(h,{component:"h2",size:"xl",fw:600,c:"gray.8",children:"User"}),e.jsxs(x,{justify:"space-between",direction:{base:"column",md:"row"},gap:{base:12,md:0},children:[e.jsx(f,{w:{md:400},placeholder:"Search",leftSection:e.jsx(G,{style:{width:U(16),height:U(16)},stroke:1.5}),value:n,onChange:m=>{c(m.target.value),a(m.target.value)}}),e.jsx(u,{leftSection:e.jsx(M,{size:14}),onClick:D,children:"Add New User"})]}),e.jsx(oe,{users:o.data,total:o.total,perPage:o.per_page,page:d,onPageChange:m=>{y(m),k(m,o.links)},onEdit:F,onDelete:I,selectedRecords:s,onSelectedRecordsChange:r})]}),e.jsx(Q,{isOpened:S,close:A}),e.jsx(Z,{isOpened:R,close:E,user:l}),e.jsx(ee,{isOpened:P,close:O,user:l})]})}export{be as default};
