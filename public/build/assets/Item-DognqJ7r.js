import{v as bo,f as Ze,u as Pe,w as qo,d as Qe,j as r,T as Yo,B as eo,L as wo,O as ao,e as Do,l as Ko,b as f,R as Ho,x as Go,z as Vo,h as Jo,g as Xo,A as Zo,r as J,W as G,n as M,M as Q,P as Qo,c as oo,a as Re,y as er,Y as or}from"./app-COI09GEu.js";import{Y as rr}from"./index-Cde5U0I6.js";import{u as tr,G as U,A as T,M as Ce,e as sr,I as nr,d as ar}from"./NotificationMenu-BHakjobV.js";import{u as L,a as de,b as H,T as Y,A as lr}from"./Authenticated-BOJpYSul.js";import{I as ir}from"./ItemBreadcrumbs-CkaQ1NsD.js";import{u as cr}from"./Popover-Cvv-QQda.js";import{I as dr,u as ko,R as ge,a as ur,b as pr,c as fr}from"./use-fetch-users-CfTtha39.js";import{T as z,F as X}from"./OfficeLogo-BJbDsiR3.js";import{S as Z}from"./Stack-C5mar0nD.js";import{T as Co}from"./Textarea-BW6s4n7T.js";import{S as ue}from"./Select-B2FaHH1o.js";import{B as S}from"./Button-dB9HwxwG.js";import{N as mr,U as hr}from"./UpdateNumberingSchemeForm-Djll3GlS.js";import{T as Ve}from"./TextInput-COZo1gMD.js";import{I as gr,u as vr}from"./use-generate-report-DZ5B-HXh.js";import{c as ee}from"./IconUser-BqOjfF9G.js";import{u as xr,a as yr,A as jr,I as br}from"./use-show-items-for-moving-V2tkakME.js";import{I as wr}from"./IconFolder-BU5nhKRg.js";import{I as Dr}from"./IconDownload-Dg6IkT6j.js";import{u as kr}from"./use-document-properties-BRmZ6HaK.js";import{u as Cr}from"./use-fetch-metadata-UqbCuolY.js";import"./Checkbox-DUXX-WQp.js";import"./InputBase-CZftOjEr.js";import"./use-uncontrolled-tqWMHqn9.js";import"./CheckIcon-D2W1QFc3.js";import"./get-sorted-breakpoints-BcrXOVSI.js";import"./Anchor-D0PcmEFH.js";import"./Combobox-B-mose7B.js";import"./clamp-DTmYCdls.js";function lo(e){return typeof e!="string"?"":e.charAt(0).toUpperCase()+e.slice(1)}var So={root:"m_6e45937b",loader:"m_e8eb006c",overlay:"m_df587f17"};const io={transitionProps:{transition:"fade",duration:0},overlayProps:{backgroundOpacity:.75},zIndex:bo("overlay")},Sr=Do((e,{zIndex:o})=>({root:{"--lo-z-index":o==null?void 0:o.toString()}})),ro=Ze((e,o)=>{const t=Pe("LoadingOverlay",io,e),{classNames:s,className:n,style:i,styles:a,unstyled:l,vars:c,transitionProps:p,loaderProps:k,overlayProps:b,visible:y,zIndex:w,...v}=t,d=qo(),g=Qe({name:"LoadingOverlay",classes:So,props:t,className:n,style:i,classNames:s,styles:a,unstyled:l,vars:c,varsResolver:Sr}),x={...io.overlayProps,...b};return r.jsx(Yo,{transition:"fade",...p,mounted:!!y,children:h=>r.jsxs(eo,{...g("root",{style:h}),ref:o,...v,children:[r.jsx(wo,{...g("loader"),unstyled:l,...k}),r.jsx(ao,{...x,...g("overlay"),darkHidden:!0,unstyled:l,color:(b==null?void 0:b.color)||d.white}),r.jsx(ao,{...x,...g("overlay"),lightHidden:!0,unstyled:l,color:(b==null?void 0:b.color)||d.colors.dark[5]})]})})});ro.classes=So;ro.displayName="@mantine/core/LoadingOverlay";var Fo={exports:{}},Fr="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",_r=Fr,Er=_r;function _o(){}function Eo(){}Eo.resetWarningCache=_o;var Ar=function(){function e(s,n,i,a,l,c){if(c!==Er){var p=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw p.name="Invariant Violation",p}}e.isRequired=e;function o(){return e}var t={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:o,element:e,elementType:e,instanceOf:o,node:e,objectOf:o,oneOf:o,oneOfType:o,shape:o,exact:o,checkPropTypes:Eo,resetWarningCache:_o};return t.PropTypes=t,t};Fo.exports=Ar();var zr=Fo.exports;const _=Ko(zr);/**
 * @license @tabler/icons-react v3.11.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Mr=ee("outline","adjustments","IconAdjustments",[["path",{d:"M4 10a2 2 0 1 0 4 0a2 2 0 0 0 -4 0",key:"svg-0"}],["path",{d:"M6 4v4",key:"svg-1"}],["path",{d:"M6 12v8",key:"svg-2"}],["path",{d:"M10 16a2 2 0 1 0 4 0a2 2 0 0 0 -4 0",key:"svg-3"}],["path",{d:"M12 4v10",key:"svg-4"}],["path",{d:"M12 18v2",key:"svg-5"}],["path",{d:"M16 7a2 2 0 1 0 4 0a2 2 0 0 0 -4 0",key:"svg-6"}],["path",{d:"M18 4v1",key:"svg-7"}],["path",{d:"M18 9v11",key:"svg-8"}]]);/**
 * @license @tabler/icons-react v3.11.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var co=ee("outline","article","IconArticle",[["path",{d:"M3 4m0 2a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2z",key:"svg-0"}],["path",{d:"M7 8h10",key:"svg-1"}],["path",{d:"M7 12h10",key:"svg-2"}],["path",{d:"M7 16h10",key:"svg-3"}]]);/**
 * @license @tabler/icons-react v3.11.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ge=ee("outline","chevron-down","IconChevronDown",[["path",{d:"M6 9l6 6l6 -6",key:"svg-0"}]]);/**
 * @license @tabler/icons-react v3.11.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ir=ee("outline","file-isr","IconFileIsr",[["path",{d:"M15 3v4a1 1 0 0 0 1 1h4",key:"svg-0"}],["path",{d:"M15 3v4a1 1 0 0 0 1 1h4",key:"svg-1"}],["path",{d:"M6 8v-3a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2v-7",key:"svg-2"}],["path",{d:"M3 15l3 -3l3 3",key:"svg-3"}]]);/**
 * @license @tabler/icons-react v3.11.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ur=ee("outline","file-report","IconFileReport",[["path",{d:"M17 17m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0",key:"svg-0"}],["path",{d:"M17 13v4h4",key:"svg-1"}],["path",{d:"M12 3v4a1 1 0 0 0 1 1h4",key:"svg-2"}],["path",{d:"M11.5 21h-6.5a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v2m0 3v4",key:"svg-3"}]]);/**
 * @license @tabler/icons-react v3.11.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Or=ee("outline","folder-plus","IconFolderPlus",[["path",{d:"M12 19h-7a2 2 0 0 1 -2 -2v-11a2 2 0 0 1 2 -2h4l3 3h7a2 2 0 0 1 2 2v3.5",key:"svg-0"}],["path",{d:"M16 19h6",key:"svg-1"}],["path",{d:"M19 16v6",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.11.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Rr=ee("outline","folder-symlink","IconFolderSymlink",[["path",{d:"M3 21v-4a3 3 0 0 1 3 -3h5",key:"svg-0"}],["path",{d:"M8 17l3 -3l-3 -3",key:"svg-1"}],["path",{d:"M3 11v-5a2 2 0 0 1 2 -2h4l3 3h7a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-8",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.11.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Tr=ee("outline","list-tree","IconListTree",[["path",{d:"M9 6h11",key:"svg-0"}],["path",{d:"M12 12h8",key:"svg-1"}],["path",{d:"M15 18h5",key:"svg-2"}],["path",{d:"M5 6v.01",key:"svg-3"}],["path",{d:"M8 12v.01",key:"svg-4"}],["path",{d:"M11 18v.01",key:"svg-5"}]]);/**
 * @license @tabler/icons-react v3.11.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Nr=ee("outline","selector","IconSelector",[["path",{d:"M8 9l4 -4l4 4",key:"svg-0"}],["path",{d:"M16 15l-4 4l-4 -4",key:"svg-1"}]]);const Wr=new Map([["aac","audio/aac"],["abw","application/x-abiword"],["arc","application/x-freearc"],["avif","image/avif"],["avi","video/x-msvideo"],["azw","application/vnd.amazon.ebook"],["bin","application/octet-stream"],["bmp","image/bmp"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["cda","application/x-cdf"],["csh","application/x-csh"],["css","text/css"],["csv","text/csv"],["doc","application/msword"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["eot","application/vnd.ms-fontobject"],["epub","application/epub+zip"],["gz","application/gzip"],["gif","image/gif"],["heic","image/heic"],["heif","image/heif"],["htm","text/html"],["html","text/html"],["ico","image/vnd.microsoft.icon"],["ics","text/calendar"],["jar","application/java-archive"],["jpeg","image/jpeg"],["jpg","image/jpeg"],["js","text/javascript"],["json","application/json"],["jsonld","application/ld+json"],["mid","audio/midi"],["midi","audio/midi"],["mjs","text/javascript"],["mp3","audio/mpeg"],["mp4","video/mp4"],["mpeg","video/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["opus","audio/opus"],["otf","font/otf"],["png","image/png"],["pdf","application/pdf"],["php","application/x-httpd-php"],["ppt","application/vnd.ms-powerpoint"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["rar","application/vnd.rar"],["rtf","application/rtf"],["sh","application/x-sh"],["svg","image/svg+xml"],["swf","application/x-shockwave-flash"],["tar","application/x-tar"],["tif","image/tiff"],["tiff","image/tiff"],["ts","video/mp2t"],["ttf","font/ttf"],["txt","text/plain"],["vsd","application/vnd.visio"],["wav","audio/wav"],["weba","audio/webm"],["webm","video/webm"],["webp","image/webp"],["woff","font/woff"],["woff2","font/woff2"],["xhtml","application/xhtml+xml"],["xls","application/vnd.ms-excel"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xml","application/xml"],["xul","application/vnd.mozilla.xul+xml"],["zip","application/zip"],["7z","application/x-7z-compressed"],["mkv","video/x-matroska"],["mov","video/quicktime"],["msg","application/vnd.ms-outlook"]]);function Fe(e,o){const t=Lr(e);if(typeof t.path!="string"){const{webkitRelativePath:s}=e;Object.defineProperty(t,"path",{value:typeof o=="string"?o:typeof s=="string"&&s.length>0?s:e.name,writable:!1,configurable:!1,enumerable:!0})}return t}function Lr(e){const{name:o}=e;if(o&&o.lastIndexOf(".")!==-1&&!e.type){const s=o.split(".").pop().toLowerCase(),n=Wr.get(s);n&&Object.defineProperty(e,"type",{value:n,writable:!1,configurable:!1,enumerable:!0})}return e}var ve=(e,o,t)=>new Promise((s,n)=>{var i=c=>{try{l(t.next(c))}catch(p){n(p)}},a=c=>{try{l(t.throw(c))}catch(p){n(p)}},l=c=>c.done?s(c.value):Promise.resolve(c.value).then(i,a);l((t=t.apply(e,o)).next())});const $r=[".DS_Store","Thumbs.db"];function Pr(e){return ve(this,null,function*(){return Ne(e)&&Br(e.dataTransfer)?Hr(e.dataTransfer,e.type):qr(e)?Yr(e):Array.isArray(e)&&e.every(o=>"getFile"in o&&typeof o.getFile=="function")?Kr(e):[]})}function Br(e){return Ne(e)}function qr(e){return Ne(e)&&Ne(e.target)}function Ne(e){return typeof e=="object"&&e!==null}function Yr(e){return Je(e.target.files).map(o=>Fe(o))}function Kr(e){return ve(this,null,function*(){return(yield Promise.all(e.map(t=>t.getFile()))).map(t=>Fe(t))})}function Hr(e,o){return ve(this,null,function*(){if(e.items){const t=Je(e.items).filter(n=>n.kind==="file");if(o!=="drop")return t;const s=yield Promise.all(t.map(Gr));return uo(Ao(s))}return uo(Je(e.files).map(t=>Fe(t)))})}function uo(e){return e.filter(o=>$r.indexOf(o.name)===-1)}function Je(e){if(e===null)return[];const o=[];for(let t=0;t<e.length;t++){const s=e[t];o.push(s)}return o}function Gr(e){if(typeof e.webkitGetAsEntry!="function")return po(e);const o=e.webkitGetAsEntry();return o&&o.isDirectory?zo(o):po(e)}function Ao(e){return e.reduce((o,t)=>[...o,...Array.isArray(t)?Ao(t):[t]],[])}function po(e){const o=e.getAsFile();if(!o)return Promise.reject(`${e} is not a File`);const t=Fe(o);return Promise.resolve(t)}function Vr(e){return ve(this,null,function*(){return e.isDirectory?zo(e):Jr(e)})}function zo(e){const o=e.createReader();return new Promise((t,s)=>{const n=[];function i(){o.readEntries(a=>ve(this,null,function*(){if(a.length){const l=Promise.all(a.map(Vr));n.push(l),i()}else try{const l=yield Promise.all(n);t(l)}catch(l){s(l)}}),a=>{s(a)})}i()})}function Jr(e){return ve(this,null,function*(){return new Promise((o,t)=>{e.file(s=>{const n=Fe(s,e.fullPath);o(n)},s=>{t(s)})})})}function Xr(e,o){if(e&&o){const t=Array.isArray(o)?o:o.split(","),s=e.name||"",n=(e.type||"").toLowerCase(),i=n.replace(/\/.*$/,"");return t.some(a=>{const l=a.trim().toLowerCase();return l.charAt(0)==="."?s.toLowerCase().endsWith(l):l.endsWith("/*")?i===l.replace(/\/.*$/,""):n===l})}return!0}var Zr=Object.defineProperty,Qr=Object.defineProperties,et=Object.getOwnPropertyDescriptors,fo=Object.getOwnPropertySymbols,ot=Object.prototype.hasOwnProperty,rt=Object.prototype.propertyIsEnumerable,mo=(e,o,t)=>o in e?Zr(e,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[o]=t,tt=(e,o)=>{for(var t in o||(o={}))ot.call(o,t)&&mo(e,t,o[t]);if(fo)for(var t of fo(o))rt.call(o,t)&&mo(e,t,o[t]);return e},st=(e,o)=>Qr(e,et(o));const nt="file-invalid-type",at="file-too-large",lt="file-too-small",it="too-many-files",ct=e=>{e=Array.isArray(e)&&e.length===1?e[0]:e;const o=Array.isArray(e)?`one of ${e.join(", ")}`:e;return{code:nt,message:`File type must be ${o}`}},ho=e=>({code:at,message:`File is larger than ${e} ${e===1?"byte":"bytes"}`}),go=e=>({code:lt,message:`File is smaller than ${e} ${e===1?"byte":"bytes"}`}),dt={code:it,message:"Too many files"};function Mo(e,o){const t=e.type==="application/x-moz-file"||Xr(e,o);return[t,t?null:ct(o)]}function Io(e,o,t){if(ce(e.size))if(ce(o)&&ce(t)){if(e.size>t)return[!1,ho(t)];if(e.size<o)return[!1,go(o)]}else{if(ce(o)&&e.size<o)return[!1,go(o)];if(ce(t)&&e.size>t)return[!1,ho(t)]}return[!0,null]}function ce(e){return e!=null}function ut({files:e,accept:o,minSize:t,maxSize:s,multiple:n,maxFiles:i,validator:a}){return!n&&e.length>1||n&&i>=1&&e.length>i?!1:e.every(l=>{const[c]=Mo(l,o),[p]=Io(l,t,s),k=a?a(l):null;return c&&p&&!k})}function We(e){return typeof e.isPropagationStopped=="function"?e.isPropagationStopped():typeof e.cancelBubble<"u"?e.cancelBubble:!1}function Te(e){return e.dataTransfer?Array.prototype.some.call(e.dataTransfer.types,o=>o==="Files"||o==="application/x-moz-file"):!!e.target&&!!e.target.files}function vo(e){e.preventDefault()}function pt(e){return e.indexOf("MSIE")!==-1||e.indexOf("Trident/")!==-1}function ft(e){return e.indexOf("Edge/")!==-1}function mt(e=window.navigator.userAgent){return pt(e)||ft(e)}function K(...e){return(o,...t)=>e.some(s=>(!We(o)&&s&&s(o,...t),We(o)))}function ht(){return"showOpenFilePicker"in window}function gt(e){return ce(e)?[{description:"Files",accept:Object.entries(e).filter(([t,s])=>{let n=!0;return Uo(t)||(console.warn(`Skipped "${t}" because it is not a valid MIME type. Check https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types for a list of valid MIME types.`),n=!1),(!Array.isArray(s)||!s.every(Oo))&&(console.warn(`Skipped "${t}" because an invalid file extension was provided.`),n=!1),n}).reduce((t,[s,n])=>st(tt({},t),{[s]:n}),{})}]:e}function vt(e){if(ce(e))return Object.entries(e).reduce((o,[t,s])=>[...o,t,...s],[]).filter(o=>Uo(o)||Oo(o)).join(",")}function xt(e){return e instanceof DOMException&&(e.name==="AbortError"||e.code===e.ABORT_ERR)}function yt(e){return e instanceof DOMException&&(e.name==="SecurityError"||e.code===e.SECURITY_ERR)}function Uo(e){return e==="audio/*"||e==="video/*"||e==="image/*"||e==="text/*"||/\w+\/[-+.\w]+/g.test(e)}function Oo(e){return/^.*\.[\w]+$/.test(e)}var jt=Object.defineProperty,bt=Object.defineProperties,wt=Object.getOwnPropertyDescriptors,Le=Object.getOwnPropertySymbols,Ro=Object.prototype.hasOwnProperty,To=Object.prototype.propertyIsEnumerable,xo=(e,o,t)=>o in e?jt(e,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[o]=t,P=(e,o)=>{for(var t in o||(o={}))Ro.call(o,t)&&xo(e,t,o[t]);if(Le)for(var t of Le(o))To.call(o,t)&&xo(e,t,o[t]);return e},ne=(e,o)=>bt(e,wt(o)),$e=(e,o)=>{var t={};for(var s in e)Ro.call(e,s)&&o.indexOf(s)<0&&(t[s]=e[s]);if(e!=null&&Le)for(var s of Le(e))o.indexOf(s)<0&&To.call(e,s)&&(t[s]=e[s]);return t};const to=f.forwardRef((e,o)=>{var t=e,{children:s}=t,n=$e(t,["children"]);const i=Wo(n),{open:a}=i,l=$e(i,["open"]);return f.useImperativeHandle(o,()=>({open:a}),[a]),Ho.createElement(f.Fragment,null,s(ne(P({},l),{open:a})))});to.displayName="Dropzone";const No={disabled:!1,getFilesFromEvent:Pr,maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1,validator:null,useFsAccessApi:!0,autoFocus:!1};to.defaultProps=No;to.propTypes={children:_.func,accept:_.objectOf(_.arrayOf(_.string)),multiple:_.bool,preventDropOnDocument:_.bool,noClick:_.bool,noKeyboard:_.bool,noDrag:_.bool,noDragEventsBubbling:_.bool,minSize:_.number,maxSize:_.number,maxFiles:_.number,disabled:_.bool,getFilesFromEvent:_.func,onFileDialogCancel:_.func,onFileDialogOpen:_.func,useFsAccessApi:_.bool,autoFocus:_.bool,onDragEnter:_.func,onDragLeave:_.func,onDragOver:_.func,onDrop:_.func,onDropAccepted:_.func,onDropRejected:_.func,onError:_.func,validator:_.func};const Xe={isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,acceptedFiles:[],fileRejections:[]};function Wo(e={}){const{accept:o,disabled:t,getFilesFromEvent:s,maxSize:n,minSize:i,multiple:a,maxFiles:l,onDragEnter:c,onDragLeave:p,onDragOver:k,onDrop:b,onDropAccepted:y,onDropRejected:w,onFileDialogCancel:v,onFileDialogOpen:d,useFsAccessApi:g,autoFocus:x,preventDropOnDocument:h,noClick:m,noKeyboard:F,noDrag:j,noDragEventsBubbling:E,onError:D,validator:A}=P(P({},No),e),I=f.useMemo(()=>vt(o),[o]),R=f.useMemo(()=>gt(o),[o]),oe=f.useMemo(()=>typeof d=="function"?d:yo,[d]),re=f.useMemo(()=>typeof v=="function"?v:yo,[v]),N=f.useRef(null),B=f.useRef(null),[_e,$]=f.useReducer(Dt,Xe),{isFocused:Be,isFileDialogActive:xe}=_e,pe=f.useRef(typeof window<"u"&&window.isSecureContext&&g&&ht()),qe=()=>{!pe.current&&xe&&setTimeout(()=>{if(B.current){const{files:u}=B.current;u.length||($({type:"closeDialog"}),re())}},300)};f.useEffect(()=>(window.addEventListener("focus",qe,!1),()=>{window.removeEventListener("focus",qe,!1)}),[B,xe,re,pe]);const le=f.useRef([]),Ee=u=>{N.current&&N.current.contains(u.target)||(u.preventDefault(),le.current=[])};f.useEffect(()=>(h&&(document.addEventListener("dragover",vo,!1),document.addEventListener("drop",Ee,!1)),()=>{h&&(document.removeEventListener("dragover",vo),document.removeEventListener("drop",Ee))}),[N,h]),f.useEffect(()=>(!t&&x&&N.current&&N.current.focus(),()=>{}),[N,x,t]);const V=f.useCallback(u=>{D?D(u):console.error(u)},[D]),Ae=f.useCallback(u=>{u.preventDefault(),u.persist(),Oe(u),le.current=[...le.current,u.target],Te(u)&&Promise.resolve(s(u)).then(C=>{if(We(u)&&!E)return;const O=C.length,W=O>0&&ut({files:C,accept:I,minSize:i,maxSize:n,multiple:a,maxFiles:l,validator:A}),q=O>0&&!W;$({isDragAccept:W,isDragReject:q,isDragActive:!0,type:"setDraggedFiles"}),c&&c(u)}).catch(C=>V(C))},[s,c,V,E,I,i,n,a,l,A]),ze=f.useCallback(u=>{u.preventDefault(),u.persist(),Oe(u);const C=Te(u);if(C&&u.dataTransfer)try{u.dataTransfer.dropEffect="copy"}catch{}return C&&k&&k(u),!1},[k,E]),Me=f.useCallback(u=>{u.preventDefault(),u.persist(),Oe(u);const C=le.current.filter(W=>N.current&&N.current.contains(W)),O=C.indexOf(u.target);O!==-1&&C.splice(O,1),le.current=C,!(C.length>0)&&($({type:"setDraggedFiles",isDragActive:!1,isDragAccept:!1,isDragReject:!1}),Te(u)&&p&&p(u))},[N,p,E]),ie=f.useCallback((u,C)=>{const O=[],W=[];u.forEach(q=>{const[be,we]=Mo(q,I),[Ye,Ke]=Io(q,i,n),De=A?A(q):null;if(be&&Ye&&!De)O.push(q);else{let ke=[we,Ke];De&&(ke=ke.concat(De)),W.push({file:q,errors:ke.filter(He=>He)})}}),(!a&&O.length>1||a&&l>=1&&O.length>l)&&(O.forEach(q=>{W.push({file:q,errors:[dt]})}),O.splice(0)),$({acceptedFiles:O,fileRejections:W,type:"setFiles"}),b&&b(O,W,C),W.length>0&&w&&w(W,C),O.length>0&&y&&y(O,C)},[$,a,I,i,n,l,b,y,w,A]),fe=f.useCallback(u=>{u.preventDefault(),u.persist(),Oe(u),le.current=[],Te(u)&&Promise.resolve(s(u)).then(C=>{We(u)&&!E||ie(C,u)}).catch(C=>V(C)),$({type:"reset"})},[s,ie,V,E]),te=f.useCallback(()=>{if(pe.current){$({type:"openDialog"}),oe();const u={multiple:a,types:R};window.showOpenFilePicker(u).then(C=>s(C)).then(C=>{ie(C,null),$({type:"closeDialog"})}).catch(C=>{xt(C)?(re(C),$({type:"closeDialog"})):yt(C)?(pe.current=!1,B.current?(B.current.value=null,B.current.click()):V(new Error("Cannot open the file picker because the https://developer.mozilla.org/en-US/docs/Web/API/File_System_Access_API is not supported and no <input> was provided."))):V(C)});return}B.current&&($({type:"openDialog"}),oe(),B.current.value=null,B.current.click())},[$,oe,re,g,ie,V,R,a]),me=f.useCallback(u=>{!N.current||!N.current.isEqualNode(u.target)||(u.key===" "||u.key==="Enter"||u.keyCode===32||u.keyCode===13)&&(u.preventDefault(),te())},[N,te]),he=f.useCallback(()=>{$({type:"focus"})},[]),Ie=f.useCallback(()=>{$({type:"blur"})},[]),ye=f.useCallback(()=>{m||(mt()?setTimeout(te,0):te())},[m,te]),se=u=>t?null:u,je=u=>F?null:se(u),Ue=u=>j?null:se(u),Oe=u=>{E&&u.stopPropagation()},Lo=f.useMemo(()=>(u={})=>{var C=u,{refKey:O="ref",role:W,onKeyDown:q,onFocus:be,onBlur:we,onClick:Ye,onDragEnter:Ke,onDragOver:De,onDragLeave:ke,onDrop:He}=C,Bo=$e(C,["refKey","role","onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragOver","onDragLeave","onDrop"]);return P(P({onKeyDown:je(K(q,me)),onFocus:je(K(be,he)),onBlur:je(K(we,Ie)),onClick:se(K(Ye,ye)),onDragEnter:Ue(K(Ke,Ae)),onDragOver:Ue(K(De,ze)),onDragLeave:Ue(K(ke,Me)),onDrop:Ue(K(He,fe)),role:typeof W=="string"&&W!==""?W:"presentation",[O]:N},!t&&!F?{tabIndex:0}:{}),Bo)},[N,me,he,Ie,ye,Ae,ze,Me,fe,F,j,t]),$o=f.useCallback(u=>{u.stopPropagation()},[]),Po=f.useMemo(()=>(u={})=>{var C=u,{refKey:O="ref",onChange:W,onClick:q}=C,be=$e(C,["refKey","onChange","onClick"]);const we={accept:I,multiple:a,type:"file",style:{display:"none"},onChange:se(K(W,fe)),onClick:se(K(q,$o)),tabIndex:-1,[O]:B};return P(P({},we),be)},[B,o,a,fe,t]);return ne(P({},_e),{isFocused:Be&&!t,getRootProps:Lo,getInputProps:Po,rootRef:N,inputRef:B,open:se(te)})}function Dt(e,o){switch(o.type){case"focus":return ne(P({},e),{isFocused:!0});case"blur":return ne(P({},e),{isFocused:!1});case"openDialog":return ne(P({},Xe),{isFileDialogActive:!0});case"closeDialog":return ne(P({},e),{isFileDialogActive:!1});case"setDraggedFiles":return ne(P({},e),{isDragActive:o.isDragActive,isDragAccept:o.isDragAccept,isDragReject:o.isDragReject});case"setFiles":return ne(P({},e),{acceptedFiles:o.acceptedFiles,fileRejections:o.fileRejections});case"reset":return P({},Xe);default:return e}}function yo(){}const[kt,Ct]=Go("Dropzone component was not found in tree");function so(e){const o=t=>{const{children:s,...n}=Pe(`Dropzone${lo(e)}`,{},t),i=Ct(),a=Vo(s)?s:r.jsx("span",{children:s});return i[e]?f.cloneElement(a,n):null};return o.displayName=`@mantine/dropzone/${lo(e)}`,o}const St=so("accept"),Ft=so("reject"),_t=so("idle");var Se={root:"m_d46a4834",inner:"m_b85f7144",fullScreen:"m_96f6e9ad",dropzone:"m_7946116d"};const Et={loading:!1,multiple:!0,maxSize:1/0,autoFocus:!1,activateOnClick:!0,activateOnDrag:!0,dragEventsBubbling:!0,activateOnKeyboard:!0,useFsAccessApi:!0,variant:"light",rejectColor:"red"},At=Do((e,{radius:o,variant:t,acceptColor:s,rejectColor:n})=>{const i=e.variantColorResolver({color:s||e.primaryColor,theme:e,variant:t}),a=e.variantColorResolver({color:n||"red",theme:e,variant:t});return{root:{"--dropzone-radius":Xo(o),"--dropzone-accept-color":i.color,"--dropzone-accept-bg":i.background,"--dropzone-reject-color":a.color,"--dropzone-reject-bg":a.background}}}),ae=Ze((e,o)=>{const t=Pe("Dropzone",Et,e),{classNames:s,className:n,style:i,styles:a,unstyled:l,vars:c,radius:p,disabled:k,loading:b,multiple:y,maxSize:w,accept:v,children:d,onDropAny:g,onDrop:x,onReject:h,openRef:m,name:F,maxFiles:j,autoFocus:E,activateOnClick:D,activateOnDrag:A,dragEventsBubbling:I,activateOnKeyboard:R,onDragEnter:oe,onDragLeave:re,onDragOver:N,onFileDialogCancel:B,onFileDialogOpen:_e,preventDropOnDocument:$,useFsAccessApi:Be,getFilesFromEvent:xe,validator:pe,rejectColor:qe,acceptColor:le,enablePointerEvents:Ee,loaderProps:V,inputProps:Ae,mod:ze,...Me}=t,ie=Qe({name:"Dropzone",classes:Se,props:t,className:n,style:i,classNames:s,styles:a,unstyled:l,vars:c,varsResolver:At}),{getRootProps:fe,getInputProps:te,isDragAccept:me,isDragReject:he,open:Ie}=Wo({onDrop:g,onDropAccepted:x,onDropRejected:h,disabled:k||b,accept:Array.isArray(v)?v.reduce((se,je)=>({...se,[je]:[]}),{}):v,multiple:y,maxSize:w,maxFiles:j,autoFocus:E,noClick:!D,noDrag:!A,noDragEventsBubbling:!I,noKeyboard:!R,onDragEnter:oe,onDragLeave:re,onDragOver:N,onFileDialogCancel:B,onFileDialogOpen:_e,preventDropOnDocument:$,useFsAccessApi:Be,validator:pe,...xe?{getFilesFromEvent:xe}:null});Jo(m,Ie);const ye=!me&&!he;return r.jsx(kt,{value:{accept:me,reject:he,idle:ye},children:r.jsxs(eo,{...fe(),...ie("root",{focusable:!0}),...Me,mod:[{accept:me,reject:he,idle:ye,disabled:k,loading:b,"activate-on-click":D},ze],children:[r.jsx(ro,{visible:b,overlayProps:{radius:p},unstyled:l,loaderProps:V}),r.jsx("input",{...te(Ae),name:F}),r.jsx("div",{...ie("inner"),ref:o,"data-enable-pointer-events":Ee||void 0,children:d})]})})});ae.classes=Se;ae.displayName="@mantine/dropzone/Dropzone";ae.Accept=St;ae.Idle=_t;ae.Reject=Ft;const zt={loading:!1,maxSize:1/0,activateOnClick:!1,activateOnDrag:!0,dragEventsBubbling:!0,activateOnKeyboard:!0,active:!0,zIndex:bo("max"),withinPortal:!0},no=Ze((e,o)=>{const t=Pe("DropzoneFullScreen",zt,e),{classNames:s,className:n,style:i,styles:a,unstyled:l,vars:c,active:p,onDrop:k,onReject:b,zIndex:y,withinPortal:w,portalProps:v,...d}=t,g=Qe({name:"DropzoneFullScreen",classes:Se,props:t,className:n,style:i,classNames:s,styles:a,unstyled:l,rootSelector:"fullScreen"}),{resolvedClassNames:x,resolvedStyles:h}=cr({classNames:s,styles:a,props:t}),[m,F]=f.useState(0),[j,{open:E,close:D}]=tr(!1),A=R=>{var oe;(oe=R.dataTransfer)!=null&&oe.types.includes("Files")&&(F(re=>re+1),E())},I=()=>{F(R=>R-1)};return f.useEffect(()=>{m===0&&D()},[m]),f.useEffect(()=>{if(p)return document.addEventListener("dragenter",A,!1),document.addEventListener("dragleave",I,!1),()=>{document.removeEventListener("dragenter",A,!1),document.removeEventListener("dragleave",I,!1)}},[p]),r.jsx(Zo,{...v,withinPortal:w,children:r.jsx(eo,{...g("fullScreen",{style:{opacity:j?1:0,pointerEvents:j?"all":"none",zIndex:y}}),ref:o,children:r.jsx(ae,{...d,classNames:x,styles:h,unstyled:l,className:Se.dropzone,onDrop:R=>{k==null||k(R),D(),F(0)},onReject:R=>{b==null||b(R),D(),F(0)}})})})});no.classes=Se;no.displayName="@mantine/dropzone/DropzoneFullScreen";ae.FullScreen=no;const jo=ae;function Mt({onDrop:e,openRef:o,children:t}){return r.jsxs(jo,{openRef:o,onDrop:e,activateOnClick:!1,acceptColor:"var(--mantine-color-white)",styles:{root:{border:"none",padding:0}},children:[r.jsx(jo.Accept,{children:r.jsx(dr,{style:{width:J(52),height:J(52),color:"var(--mantine-color-blue-6)",position:"absolute",bottom:J(16),left:"50%",transform:"translateX(-50%)",zIndex:9999},stroke:1.5})}),t]})}function It({itemParentId:e}){const[o,t]=f.useState("reviewal"),{closeModal:s,modals:n}=L(),i=ko(o,n.createWorkflow),{data:a,setData:l,post:c,processing:p,errors:k,reset:b}=G({folder_item_id:"",resolution:"",destination:"",type:"reviewal",users:[]}),[y,w]=f.useState([]),v=i.length;f.useEffect(()=>{w([])},[o,i]);const d=j=>{j.preventDefault();const E=y.map(D=>parseInt(D.selectedUser)).filter(D=>!isNaN(D));a.folder_item_id=e??"",a.users=E.map(D=>({user_id:D})),c(route("workflows.store"),{preserveScroll:!0,onSuccess:()=>{s("createWorkflow"),M.show({message:"Approval process created",color:"green"})},onError:()=>{M.show({message:"Something went wrong",color:"red"})},onFinish:()=>b()})},g=()=>{y.length<v&&w([...y,{selectedUser:""}])},x=()=>{const j=y.map(A=>A.selectedUser),D=i.filter(A=>!j.includes(A.id.toString())).map(A=>({selectedUser:A.id.toString()}));w([...y,...D])},h=j=>{const E=[...y];E.splice(j,1),w(E)},m=(j,E)=>{const D=[...y];D[j].selectedUser=E||"",w(D)},F=y.map(j=>j.selectedUser).filter(j=>j!=="");return{data:a,setData:l,createApprovalSubmit:d,processing:p,errors:k,users:y,setWorkflowType:t,addUser:g,removeUser:h,handleUserChange:m,addAllUsers:x,maxUsers:v,selectedUserIds:F,fetchedUsers:i}}const Ut=({itemParent:e})=>{const{data:o,setData:t,createApprovalSubmit:s,processing:n,errors:i,users:a,setWorkflowType:l,addUser:c,removeUser:p,handleUserChange:k,addAllUsers:b,maxUsers:y,selectedUserIds:w,fetchedUsers:v}=It({itemParentId:e==null?void 0:e.item_id}),{modals:d,closeModal:g}=L(),x=h=>v.filter(m=>!w.includes(m.id.toString())||m.id.toString()===a[h].selectedUser).map(m=>({value:m.id.toString(),label:`${m.name} (${m.email})`}));return r.jsx(Q,{opened:d.createWorkflow,onClose:()=>g("createWorkflow"),title:r.jsx(z,{fw:"bold",size:"lg",children:"Create Workflow Process"}),size:550,children:r.jsxs("form",{onSubmit:s,children:[r.jsxs(Z,{gap:16,children:[r.jsx(z,{size:"sm",color:"dimmed",children:"Routinely directs any uploaded file in this folder through a predefined approval workflow"}),r.jsx(ge.Group,{name:"status",value:o.type,onChange:h=>{t("type",h),l(h)},children:r.jsxs(U,{mt:"xs",children:[r.jsx(ge,{value:"reviewal",label:"Review"}),r.jsx(ge,{value:"approval",label:"Approval"})]})}),r.jsx(Co,{label:"Resolution",placeholder:"Your resolution for this approval",value:o.resolution??"",onChange:h=>t("resolution",h.target.value),error:i.resolution,autosize:!0,minRows:2,maxRows:4}),r.jsx(z,{size:"sm",fw:500,mb:-8,children:"Users in this workflow"}),a.map((h,m)=>r.jsxs(U,{justify:"space-between",align:"flex-end",children:[r.jsx(ue,{placeholder:"Select a user",data:x(m),value:h.selectedUser,onChange:F=>k(m,F),required:!0,style:{flex:1},allowDeselect:!1}),r.jsx(T,{color:"red",onClick:()=>p(m),title:"Remove User",children:r.jsx(de,{size:18})})]},m)),r.jsxs(U,{children:[a.length<y&&r.jsx(S,{variant:"subtle",color:"green",leftSection:r.jsx(H,{size:16}),onClick:c,disabled:a.length>=y,children:"Add User"}),w.length<y&&r.jsx(S,{variant:"subtle",color:"blue",leftSection:r.jsx(H,{size:16}),onClick:b,disabled:a.length>=y,children:"Add All Users"})]})]}),r.jsxs(X,{align:"center",justify:"end",mt:16,children:[r.jsx(S,{variant:"light",onClick:()=>g("createWorkflow"),children:"Cancel"}),r.jsx(S,{ml:12,type:"submit",loading:n,children:"Create"})]})]})})};function Ot({itemParent:e}){const{data:o,setData:t,post:s,processing:n,errors:i,reset:a}=G({folder_item_id:(e==null?void 0:e.item_id)??"",name:"",prefix:"",next_number:1,reset_frequency:"none"}),{closeModal:l}=L();return{data:o,setData:t,handleSubmit:p=>{p.preventDefault(),o.folder_item_id=(e==null?void 0:e.item_id)??"",s(route("numbering-scheme.store"),{preserveScroll:!0,onSuccess:()=>{l("createNumberingScheme"),M.show({message:"Numbering scheme created",color:"green"})},onError:k=>{M.show({message:"Something went wrong",color:"red"})},onFinish:()=>a()})},processing:n,errors:i}}const Rt=({itemParent:e})=>{const{data:o,setData:t,handleSubmit:s,processing:n,errors:i}=Ot({itemParent:e}),{modals:a,closeModal:l}=L(),[c,p]=f.useState([]);f.useEffect(()=>{const d=c.map(g=>g.type==="text"?g.value:`[${g.value}]`).join(" ");t("prefix",d)},[c]);const k=()=>{p([...c,{id:Date.now(),type:"text",value:""}])},b=()=>{p([...c,{id:Date.now(),type:"dynamic",value:""}])},y=(d,g)=>{p(c.map(x=>x.id===d?{...x,value:g}:x))},w=d=>{p(c.filter(g=>g.id!==d))},v=[{value:"YY",label:"Year"},{value:"MM",label:"Month"},{value:"DD",label:"Day"},{value:"INC",label:"Increment"}];return r.jsx(Q,{opened:a.createNumberingScheme,onClose:()=>l("createNumberingScheme"),title:r.jsx(z,{size:"lg",children:"Create Numbering Scheme"}),size:600,children:r.jsxs("form",{onSubmit:s,children:[r.jsxs(Z,{gap:16,children:[r.jsx(Ve,{label:"Name",value:o.name,onChange:d=>t("name",d.target.value),error:i.name,required:!0}),r.jsx(z,{size:"sm",fw:500,children:"Prefix"}),r.jsxs(U,{children:[r.jsx(S,{variant:"subtle",size:"sm",leftSection:r.jsx(H,{size:16}),onClick:k,children:"Add Text"}),r.jsx(S,{variant:"subtle",size:"sm",leftSection:r.jsx(H,{size:16}),onClick:b,children:"Add Dynamic"})]}),c.map((d,g)=>r.jsxs(U,{align:"flex-end",children:[d.type==="text"?r.jsx(Ve,{placeholder:"Enter text",value:d.value,onChange:x=>y(d.id,x.target.value),required:!0,style:{flex:1}}):r.jsx(ue,{placeholder:"Select dynamic part",data:v,value:d.value,onChange:x=>y(d.id,x||""),required:!0,style:{flex:1}}),r.jsx(T,{color:"red",onClick:()=>w(d.id),children:r.jsx(de,{size:16})})]},d.id)),r.jsx(z,{size:"sm",fw:500,children:"Preview:"}),r.jsx(Qo,{withBorder:!0,p:12,bg:"#f9f9f9",children:r.jsx(z,{children:c.map(d=>{if(d.type==="text")return d.value+" ";switch(d.value){case"YY":return new Date().getFullYear().toString().slice(2)+" ";case"MM":return(new Date().getMonth()+1).toString()+" ";case"DD":return new Date().getDate().toString()+" ";case"INC":return o.next_number.toString()+" ";default:return""}}).join(" ")})}),r.jsx(U,{justify:"space-between",children:r.jsx(mr,{label:"Next Number",value:o.next_number,onChange:d=>t("next_number",Number(d)),min:1,error:i.next_number,required:!0,style:{flex:1}})}),r.jsx(ue,{label:"Reset Frequency",data:[{value:"none",label:"None"},{value:"monthly",label:"Monthly"},{value:"yearly",label:"Yearly"}],value:o.reset_frequency,onChange:d=>t("reset_frequency",d??"none"),error:i.reset_frequency,required:!0})]}),r.jsxs(X,{align:"center",justify:"end",mt:24,children:[r.jsx(S,{variant:"light",onClick:()=>l("createNumberingScheme"),children:"Cancel"}),r.jsx(S,{ml:12,type:"submit",loading:n,children:"Create"})]})]})})};function Tt({itemParent:e,close:o}){const{data:t,setData:s,post:n,processing:i,errors:a,reset:l,clearErrors:c}=G({parent_id:"",name:""}),{closeModal:p}=L();return{data:t,setData:s,submit:b=>{t.parent_id=(e==null?void 0:e.item_id)||"",b.preventDefault(),n(route("folder.create"),{preserveScroll:!0,onSuccess:()=>{M.show({message:"New folder created",color:"green"})},onError:y=>{let w="";Object.keys(y).length>0?w=y[Object.keys(y)[0]]:w="Error during file upload. Please try again later.",M.show({message:w,color:"red"})},onFinish:()=>{p("folder"),l(),c()}})},processing:i,errors:a}}const Nt=({itemParent:e})=>{const{data:o,setData:t,submit:s,processing:n,errors:i}=Tt({itemParent:e,close}),{modals:a,closeModal:l}=L();return r.jsx(Q,{opened:a.folder,onClose:()=>l("folder"),title:r.jsx(z,{fw:"bold",size:"lg",children:"Create Folder"}),size:550,children:r.jsxs("form",{onSubmit:s,children:[r.jsx(Z,{gap:16,children:r.jsx(Ve,{id:"name",type:"text",name:"name",value:o.name,placeholder:"Folder Name",onChange:c=>t("name",c.target.value),error:i.name})}),r.jsxs(X,{align:"center",justify:"end",mt:16,children:[r.jsx(S,{variant:"outline",onClick:()=>l("folder"),children:"Cancel"}),r.jsx(S,{ml:12,type:"submit",loading:n,children:"Create"})]})]})})};function Wt({workflowId:e,isOpen:o}){const[t,s]=f.useState(null);f.useEffect(()=>{e&&o&&n(e)},[e,o]);const n=async i=>{try{const a=await oo.get(`/workflows/${i}`);s(a.data)}catch(a){console.error("Error fetching workflow",a)}};return t}function Lt({itemParent:e,isOpen:o}){const[t,s]=f.useState("reviewal"),n=Wt({workflowId:e==null?void 0:e.workflow_id,isOpen:o}),i=ko(t,o),{closeModal:a}=L(),{data:l,setData:c,put:p,processing:k,errors:b,reset:y,clearErrors:w}=G({resolution:"",type:"",users:[]}),[v,d]=f.useState([]),g=i.length;f.useEffect(()=>{n&&(s(n.type||""),c({resolution:n.resolution||"",type:n.type||"",users:n.users.map(D=>({user_id:D.id}))}),d(n.users.map(D=>({selectedUser:D.id.toString()}))))},[n,o]),f.useEffect(()=>{d([])},[t]);const x=D=>{D.preventDefault();const A=v.map(I=>parseInt(I.selectedUser)).filter(I=>!isNaN(I));l.users=A.map(I=>({user_id:I})),p(route("workflows.update",e==null?void 0:e.workflow_id),{onSuccess:()=>{a("updateWorkflow"),M.show({message:"Workflow updated successfully",color:"green"})},onError:I=>{M.show({message:"Something went wrong",color:"red"})},onFinish:()=>y()})},h=()=>{v.length<g&&d([...v,{selectedUser:""}])},m=()=>{const D=v.map(R=>R.selectedUser),I=i.filter(R=>!D.includes(R.id.toString())).map(R=>({selectedUser:R.id.toString()}));d([...v,...I])},F=D=>{const A=[...v];A.splice(D,1),d(A)},j=(D,A)=>{const I=[...v];I[D].selectedUser=A||"",d(I)},E=v.map(D=>D.selectedUser).filter(D=>D!=="");return{data:l,setData:c,handleUpdateWorkflow:x,processing:k,errors:b,users:v,setWorkflowType:s,addUser:h,removeUser:F,handleUserChange:j,addAllUsers:m,maxUsers:g,selectedUserIds:E,fetchedUsers:i}}function $t({workflowId:e,onDeleteSuccess:o}){const{delete:t,processing:s}=G();return{handleDeleteWorkflow:()=>{if(!e){M.show({message:"Workflow ID is missing.",color:"red"});return}t(route("workflows.destroy",e),{preserveScroll:!0,onSuccess:()=>{M.show({message:"Workflow deleted successfully.",color:"green"}),o()},onError:i=>{let a="Failed to delete workflow.";i&&Object.keys(i).length>0&&(a=i[Object.keys(i)[0]]),M.show({message:a,color:"red"})}})},processing:s}}const Pt=({workflowId:e})=>{const{modals:o,closeModal:t,openModal:s}=L(),n=o.confirmDeleteWorkflow,{handleDeleteWorkflow:i,processing:a}=$t({workflowId:e,onDeleteSuccess:()=>{t("confirmDeleteWorkflow"),t("updateWorkflow")}});return r.jsxs(Q,{opened:n,onClose:()=>t("confirmDeleteWorkflow"),title:r.jsx(z,{fw:"bold",size:"lg",children:"Confirm Delete"}),size:"sm",centered:!0,children:[r.jsx(z,{c:"gray.8",children:"Are you sure you want to delete this workflow? This action cannot be undone."}),r.jsxs(X,{align:"center",justify:"flex-end",mt:16,children:[r.jsx(S,{variant:"light",onClick:()=>{t("confirmDeleteWorkflow"),s("updateWorkflow")},children:"Cancel"}),r.jsx(S,{color:"red",ml:12,onClick:i,loading:a,children:"Delete"})]})]})},Bt=({itemParent:e})=>{const{modals:o,closeModal:t,openModal:s}=L(),n=o.updateWorkflow,{data:i,setData:a,handleUpdateWorkflow:l,processing:c,users:p,setWorkflowType:k,addUser:b,removeUser:y,handleUserChange:w,addAllUsers:v,maxUsers:d,selectedUserIds:g,fetchedUsers:x,errors:h}=Lt({itemParent:e,isOpen:n}),m=F=>x.filter(j=>!g.includes(j.id.toString())||j.id.toString()===p[F].selectedUser).map(j=>({value:j.id.toString(),label:`${j.name} (${j.email})`}));return r.jsxs(r.Fragment,{children:[r.jsx(Q,{opened:n,onClose:()=>t("updateWorkflow"),title:r.jsx(z,{fw:"bold",size:"lg",children:"Update Workflow Process"}),size:550,children:r.jsxs("form",{onSubmit:l,children:[r.jsxs(Z,{gap:16,children:[r.jsx(z,{size:"sm",c:"dimmed",children:"Routinely directs any uploaded file in this folder through a predefined approval workflow"}),r.jsx(ge.Group,{name:"status",value:i.type,onChange:F=>{a("type",F),k(F)},children:r.jsxs(U,{mt:"xs",children:[r.jsx(ge,{value:"reviewal",label:"Review"}),r.jsx(ge,{value:"approval",label:"Approval"})]})}),r.jsx(Co,{label:"Resolution",placeholder:"Your resolution for this approval",value:i.resolution??"",onChange:F=>a("resolution",F.target.value),error:h.resolution,autosize:!0,minRows:2,maxRows:4}),r.jsx(z,{size:"sm",fw:500,mb:-8,children:"Users in this workflow"}),p.map((F,j)=>r.jsxs(U,{justify:"space-between",align:"flex-end",children:[r.jsx(ue,{placeholder:"Select a user",data:m(j),value:F.selectedUser,onChange:E=>w(j,E),required:!0,style:{flex:1},allowDeselect:!1}),r.jsx(T,{color:"red",onClick:()=>y(j),title:"Remove User",children:r.jsx(de,{size:18})})]},j)),r.jsxs(U,{children:[p.length<d&&r.jsx(S,{variant:"subtle",color:"green",leftSection:r.jsx(H,{size:16}),onClick:b,disabled:p.length>=d,children:"Add User"}),g.length<d&&r.jsx(S,{variant:"subtle",color:"blue",leftSection:r.jsx(H,{size:16}),onClick:v,disabled:p.length>=d,children:"Add All Users"})]})]}),r.jsxs(X,{align:"center",justify:"end",mt:16,children:[r.jsx(S,{variant:"light",onClick:()=>t("updateWorkflow"),children:"Cancel"}),r.jsx(S,{ml:12,type:"submit",loading:c,children:"Update"}),r.jsx(T,{variant:"transparent",color:"red",onClick:()=>{s("confirmDeleteWorkflow"),t("updateWorkflow")},title:"Delete Workflow",ml:12,children:r.jsx(de,{size:18})})]})]})}),r.jsx(Pt,{workflowId:e==null?void 0:e.workflow_id})]})};function qt({folderId:e,isOpen:o}){const[t,s]=f.useState([]),[n,i]=f.useState(!1),[a,l]=f.useState(null);return f.useEffect(()=>{e&&(async()=>{i(!0);try{const p=await oo.get(route("folder.fetchSharedUsers",{folder:e}));s(p.data),l(null)}catch(p){console.error(p),l("Failed to fetch shared users."),M.show({title:"Error",message:"Unable to fetch shared users.",color:"red"})}finally{i(!1)}})()},[e,o]),{sharedUsers:t,loading:n,error:a}}function Yt({folderId:e,close:o}){const{modals:t}=L(),s=t.shareFolder,{sharedUsers:n,loading:i,error:a}=qt({folderId:e,isOpen:s}),{data:l,setData:c,post:p,processing:k,errors:b,reset:y}=G({users:[]});return f.useEffect(()=>{if(n.length>0){const h=n.map(m=>({email:m.email,role:m.role}));c("users",h)}},[n]),{data:l,submit:()=>{p(route("folder.share",{folder:e}),{onSuccess:()=>{o(),M.show({message:"Folder shared successfully.",color:"green"}),y()},onError:h=>{M.show({message:"Failed to share the folder.",color:"red"})}})},processing:k,errors:b,addUser:()=>{c("users",[...l.users,{email:"",role:"viewer"}])},removeUser:h=>{const m=l.users.filter((F,j)=>j!==h);c("users",m)},handleUserChange:(h,m,F)=>{const j=l.users.map((E,D)=>D===h?{...E,[m]:F}:E);c("users",j)},handleAddAllUsers:()=>{const h=n.map(m=>({email:m.email,role:"viewer"}));c("users",h)}}}const Kt=({folderId:e})=>{const{modals:o,closeModal:t}=L(),{users:s,loading:n,error:i}=ur(),{data:a,submit:l,processing:c,errors:p,addUser:k,removeUser:b,handleUserChange:y}=Yt({folderId:e,close:()=>t("shareFolder")}),w=()=>{const d=s.map(g=>({email:g.email,role:"viewer"}));v(d)},v=d=>{d.forEach(()=>k())};return r.jsx(Q,{opened:o.shareFolder,onClose:()=>t("shareFolder"),title:r.jsx(z,{size:"lg",children:"Share Folder"}),size:"600",children:r.jsxs("form",{onSubmit:d=>{d.preventDefault(),l()},children:[r.jsxs(Z,{children:[a.users.map((d,g)=>r.jsxs(U,{align:"flex-end",children:[r.jsx(ue,{data:s.map(x=>({value:x.email,label:`${x.name} (${x.email})`})),placeholder:"Select a user",value:d.email,onChange:x=>y(g,"email",x||""),style:{flex:1}}),r.jsx(ue,{data:[{value:"viewer",label:"Viewer"},{value:"editor",label:"Editor"}],placeholder:"Select role",value:d.role,onChange:x=>y(g,"role",x||"viewer"),style:{width:120}}),r.jsx(Y,{label:"Remove User",withArrow:!0,children:r.jsx(T,{color:"red",onClick:()=>b(g),children:r.jsx(de,{size:18})})})]},g)),r.jsxs(U,{children:[r.jsx(S,{variant:"subtle",color:"green",leftSection:r.jsx(H,{size:16}),onClick:()=>k(),children:"Add User"}),r.jsx(S,{variant:"subtle",color:"blue",leftSection:r.jsx(H,{size:16}),onClick:w,disabled:a.users.length>=s.length,children:"Add All Users"})]})]}),r.jsxs(U,{mt:"md",children:[r.jsx(S,{variant:"outline",onClick:()=>t("shareFolder"),children:"Cancel"}),r.jsx(S,{type:"submit",loading:c,children:"Save"})]})]})})},Ht=({uploadFileRef:e,itemParent:o,folderUserRole:t})=>{var i;const{openModal:s}=L(),{generateReport:n}=vr();return r.jsxs(U,{h:"50%",px:32,align:"center",justify:"space-between",children:[(t==="editor"||t==="admin")&&r.jsxs(U,{gap:"xs",children:[r.jsxs(Ce,{shadow:"md",width:220,transitionProps:{transition:"pop-top-left"},position:"bottom-start",children:[r.jsx(Ce.Target,{children:r.jsx(S,{variant:"subtle",color:"dark.3",leftSection:r.jsx(H,{size:18}),rightSection:r.jsx(Ge,{size:12}),children:"New"})}),r.jsxs(Ce.Dropdown,{children:[r.jsx(Ce.Item,{leftSection:r.jsx(Or,{style:{width:J(14),height:J(14)}}),onClick:()=>s("folder"),children:"New Folder"}),r.jsx(Ce.Item,{leftSection:r.jsx(Ir,{style:{width:J(14),height:J(14)}}),onClick:()=>{var a;return(a=e==null?void 0:e.current)==null?void 0:a.call(e)},children:"Upload Files"})]})]}),r.jsx(Y,{label:"Properties",position:"bottom",withArrow:!0,children:r.jsx(T,{component:Re,size:"lg",href:route("folder.edit",{id:o==null?void 0:o.item_id}),variant:"transparent",color:"dark.3",children:r.jsx(Mr,{size:18})})}),r.jsx(Y,{label:"Workflow",position:"bottom",withArrow:!0,children:r.jsx(T,{variant:"transparent",size:"lg",color:o!=null&&o.workflow_id?"green.8":"dark.3",onClick:()=>s(o!=null&&o.workflow_id?"updateWorkflow":"createWorkflow"),children:r.jsx(pr,{size:18})})}),r.jsx(Y,{label:"Share",position:"bottom",withArrow:!0,children:r.jsx(T,{variant:"transparent",size:"lg",color:o!=null&&o.is_shared?"green.8":"dark.3",onClick:()=>s("shareFolder"),children:r.jsx(fr,{size:18})})}),r.jsx(Y,{label:"Metadata",position:"bottom",withArrow:!0,children:r.jsx(T,{component:Re,size:"lg",href:route("folder.showRequiredMetadata",{id:o==null?void 0:o.item_id}),variant:"transparent",color:(i=o==null?void 0:o.required_metadata)!=null&&i.length?"green.8":"dark.3",children:r.jsx(sr,{size:18})})}),r.jsx(Y,{label:"Activity",position:"bottom",withArrow:!0,children:r.jsx(T,{component:Re,size:"lg",href:route("folder.activity-log",{id:o==null?void 0:o.item_id}),variant:"transparent",color:"dark.3",children:r.jsx(co,{size:18})})}),r.jsx(Y,{label:"Numbering",position:"bottom",withArrow:!0,children:r.jsx(T,{size:"lg",variant:"transparent",color:o!=null&&o.numbering_scheme_id?"green.8":"dark.3",onClick:()=>s(o!=null&&o.numbering_scheme_id?"updateNumberingScheme":"createNumberingScheme"),children:r.jsx(Tr,{size:18})})}),r.jsx(Y,{label:"Column",position:"bottom",withArrow:!0,children:r.jsx(T,{variant:"transparent",color:"dark.3",size:"lg",onClick:()=>s("selectMetadataColumns"),children:r.jsx(gr,{size:18})})}),r.jsx(Y,{label:"Report",position:"bottom",withArrow:!0,children:r.jsx(T,{variant:"transparent",color:"dark.3",size:"lg",onClick:()=>n((o==null?void 0:o.item_id)??""),children:r.jsx(Ur,{size:18})})})]}),t==="viewer"&&r.jsx(U,{gap:"xs",children:r.jsx(Y,{label:"Activity",position:"bottom",withArrow:!0,children:r.jsx(T,{component:Re,size:"lg",href:route("folder.activity-log",{id:o==null?void 0:o.item_id}),variant:"transparent",color:"dark.3",children:r.jsx(co,{size:18})})})}),r.jsxs(U,{gap:"xs",children:[r.jsx(Y,{label:"Sort",position:"bottom",withArrow:!0,children:r.jsxs(T,{variant:"transparent",color:"dark.3",size:"lg",children:[r.jsx(Nr,{size:18}),r.jsx(Ge,{size:12,style:{marginLeft:J(4)}})]})}),r.jsx(Y,{label:"View",position:"bottom",withArrow:!0,children:r.jsxs(T,{variant:"transparent",color:"dark.3",size:"lg",children:[r.jsx(nr,{size:18}),r.jsx(Ge,{size:12,style:{marginLeft:J(4)}})]})})]}),r.jsx(Nt,{itemParent:o}),r.jsx(Ut,{itemParent:o}),r.jsx(Bt,{itemParent:o}),r.jsx(Rt,{itemParent:o}),r.jsx(hr,{itemParent:o}),r.jsx(Kt,{folderId:(o==null?void 0:o.item_id)??""})]})};function Gt(e){return fetch(e,{headers:{"Content-Type":"application/json",Accept:"application/json"}}).then(o=>o.json())}function Vt(){return{downloadFiles:({all:o,ids:t,parentId:s})=>{if(!o&&(t==null?void 0:t.length)===0)return;const n=new URLSearchParams;s&&n.append("parent_id",String(s)),o?n.append("all",o?"1":"0"):t==null||t.forEach(a=>n.append("ids[]",a));const i=route("item.download");Gt(`${i}?${n.toString()}`).then(a=>{if(!a.url)return;const l=document.createElement("a");l.download=a.filename,l.href=a.url,l.click()})}}}function Jt({setSelectedRecord:e}){const{data:o,delete:t,processing:s}=G({ids:[]}),{closeModal:n}=L();return{handleDelete:a=>{o.ids=a,t(route("item.delete"),{onSuccess:()=>{n("deleteFiles"),setTimeout(()=>{e([])},100),M.show({message:"Files deleted",color:"green"})},onError:l=>{let c="Error during file deletion. Please try again later.";Object.keys(l).length>0&&(c=l[Object.keys(l)[0]]),M.show({message:c,color:"red"})}})},processing:s}}const Xt=({selectedIds:e,setSelectedRecord:o})=>{const{handleDelete:t,processing:s}=Jt({setSelectedRecord:o}),{modals:n,closeModal:i}=L();return r.jsx(Q,{opened:n.deleteFiles,onClose:()=>i("deleteFiles"),title:r.jsx(z,{fw:"bold",size:"lg",children:"Delete Files"}),size:550,children:r.jsxs("form",{onSubmit:a=>{a.preventDefault(),t(e)},children:[r.jsx(z,{c:"dimmed",children:"Delete selected files?"}),r.jsxs(X,{align:"center",justify:"end",mt:16,children:[r.jsx(S,{variant:"subtle",onClick:()=>i("deleteFiles"),color:"gray",children:"Cancel"}),r.jsx(S,{ml:12,type:"submit",loading:s,color:"red",children:"Delete"})]})]})})};function Zt({setSelectedRecord:e}){const{data:o,setData:t,put:s,processing:n,errors:i,reset:a,clearErrors:l}=G({ids:[],destination_folder_id:""});return{data:o,setData:t,moveDocuments:()=>{s(route("document.move"),{onSuccess:()=>{e([]),M.show({message:"Documents moved successfully",color:"green"}),a()},onError:p=>{M.show({message:"Failed to move documents",color:"red"})},onFinish:()=>{l()}})},processing:n,errors:i,reset:a}}const Qt=({selectedDocumentIds:e,setSelectedRecord:o})=>{const{modals:t,closeModal:s}=L(),n=t.moveModal,[i,a]=f.useState(null),{data:l,loading:c,error:p}=xr(i,n),{data:k,setData:b,moveDocuments:y,processing:w}=Zt({setSelectedRecord:o}),v=x=>{a(x)},d=()=>{l.itemParent&&l.itemParent.parent_id?a(l.itemParent.parent_id):a(null)},g=()=>{if(!i){M.show({message:"Please select a destination folder.",color:"red"});return}k.ids=e,k.destination_folder_id=i,y(),s("moveModal")};return r.jsx(Q,{opened:n,onClose:()=>s("moveModal"),title:"Move Documents",size:"lg",children:r.jsxs(Z,{gap:"md",children:[r.jsxs(U,{children:[i&&r.jsx(T,{onClick:d,children:r.jsx(yr,{size:16})}),r.jsx(z,{children:"Choose Destination Folder"})]}),c?r.jsx(z,{children:"Loading..."}):p?r.jsx(z,{c:"red",children:p}):r.jsx(Z,{gap:"sm",style:{maxHeight:400,overflowY:"auto"},children:l.itemContents.map(x=>r.jsxs(U,{gap:"sm",style:{cursor:"pointer"},onDoubleClick:()=>v(x.item_id),children:[r.jsx(wr,{}),r.jsx(z,{children:x.name})]},x.item_id))}),r.jsxs(U,{justify:"flex-end",mt:"md",children:[r.jsx(S,{variant:"outline",onClick:()=>s("moveModal"),children:"Cancel"}),r.jsx(S,{onClick:g,disabled:!i||w,loading:w,children:"Move Here"})]})]})})},es=({setSelectedRecord:e,selectedIds:o,parentId:t})=>{const{downloadFiles:s}=Vt(),{openModal:n}=L();return r.jsxs(U,{h:"50%",px:"md",align:"center",justify:"flex-start",children:[r.jsx(S,{onClick:()=>n("deleteFiles"),variant:"subtle",color:"dark.3",leftSection:r.jsx(de,{size:18}),children:"Delete"}),r.jsx(S,{onClick:()=>s({all:!1,ids:o,parentId:t}),variant:"subtle",color:"dark.3",leftSection:r.jsx(Dr,{size:18}),children:"Download"}),r.jsx(S,{onClick:()=>n("moveModal"),variant:"subtle",color:"dark.3",leftSection:r.jsx(Rr,{size:18}),children:"Move"}),r.jsx(Xt,{selectedIds:o,setSelectedRecord:e}),r.jsx(Qt,{selectedDocumentIds:o,setSelectedRecord:e})]})};function os(e){const{data:o,post:t,reset:s,clearErrors:n}=G({parent_id:"",files:[]});return{uploadFiles:a=>{o.parent_id=e.item_id,o.files=a.map(l=>({file:l})),t(route("document.store"),{onSuccess:()=>{M.show({message:"Document uploaded",color:"green"})},onError:l=>{let c="";Object.keys(l).length>0?c=l[Object.keys(l)[0]]:c="Error during file upload. Please try again later.",M.show({message:c,color:"red"})},onFinish:()=>{s(),n()}})}}}function rs(){const[e,o]=f.useState([]),s=(n=>n.map(i=>i.id))(e);return{selectedRecord:e,setSelectedRecord:o,ids:s}}function ts(){return{openFolder:(o,t)=>{o==="folder"&&er.visit(route("folder.show",{id:t}))}}}function ss({folderId:e,isOpen:o}){const[t,s]=f.useState([]),[n,i]=f.useState(!1),[a,l]=f.useState(null);return f.useEffect(()=>{e&&o&&(async()=>{i(!0);try{const p=await oo.get(`/folder/${e}/metadata_columns`);s(p.data.metadata_columns),l(null)}catch(p){l("Failed to fetch existing metadata columns."),console.error(p)}finally{i(!1)}})()},[e,o]),{existingMetadataColumns:t,loading:n,error:a}}const ns=({folderId:e})=>{const{modals:o,closeModal:t}=L(),s=o.selectMetadataColumns,{metadataList:n}=Cr(),{existingMetadataColumns:i,loading:a,error:l}=ss({folderId:e,isOpen:s}),{data:c,setData:p,post:k,processing:b,errors:y,reset:w}=G({metadata_columns:[{id:Date.now(),value:""}],metadata_ids:[]});f.useEffect(()=>{if(i.length>0){const h=i.map(m=>({id:m.metadata_id,value:m.metadata_id.toString()}));p("metadata_columns",h)}},[i]),f.useEffect(()=>{const h=c.metadata_columns.map(m=>parseInt(m.value)).filter(m=>!isNaN(m));p("metadata_ids",h)},[c.metadata_columns]);const v=()=>{p("metadata_columns",[...c.metadata_columns,{id:Date.now(),value:""}])},d=h=>{p("metadata_columns",c.metadata_columns.filter(m=>m.id!==h))},g=(h,m)=>{const F=c.metadata_columns.map(j=>j.id===h?{...j,value:m}:j);p("metadata_columns",F)},x=h=>{h.preventDefault(),c.metadata_columns.map(m=>parseInt(m.value)).filter(m=>!isNaN(m)),k(route("folder.selectMetadataColumn",e),{preserveScroll:!0,onSuccess:()=>{t("selectMetadataColumns"),M.show({title:"Success",message:"Metadata columns selected successfully",color:"green"}),w()},onError:()=>{M.show({title:"Error",message:"Failed to select metadata columns",color:"red"})}})};return r.jsx(Q,{opened:s,onClose:()=>{t("selectMetadataColumns"),w()},title:r.jsx(z,{fw:"bold",size:"lg",children:"Select Metadata Columns"}),size:550,children:a?r.jsx(X,{justify:"center",align:"center",h:"100%",children:r.jsx(wo,{})}):l?r.jsx(jr,{icon:r.jsx(br,{size:16}),title:"Error",color:"red",children:l}):r.jsxs("form",{onSubmit:x,children:[r.jsxs(Z,{gap:16,children:[r.jsx(z,{c:"dimmed",children:"Select the metadata columns you want to display"}),c.metadata_columns.map(h=>r.jsxs(U,{justify:"space-between",align:"flex-end",children:[r.jsx(ue,{placeholder:"Pick a metadata column",data:n.map(m=>({value:m.metadata_id.toString(),label:m.name})),value:h.value,onChange:m=>g(h.id,m||""),w:"90%",required:!0}),c.metadata_columns.length>1&&r.jsx(T,{color:"red",variant:"subtle",onClick:()=>d(h.id),children:r.jsx(de,{size:18})})]},h.id)),r.jsx(X,{justify:"flex-start",children:r.jsx(S,{variant:"subtle",color:"blue.5",leftSection:r.jsx(H,{size:18}),onClick:v,children:"Add New Column"})})]}),r.jsxs(X,{align:"center",justify:"end",mt:16,children:[r.jsx(S,{variant:"outline",onClick:()=>{t("selectMetadataColumns"),w()},children:"Cancel"}),r.jsx(S,{ml:12,type:"submit",loading:b,children:"Save"})]})]})})};function Os({itemParent:e,itemAncestors:o,itemContents:t,folderUserRole:s}){var w;const n=f.useRef(null),{uploadFiles:i}=os(e),{selectedRecord:a,setSelectedRecord:l,ids:c}=rs(),{openFolder:p}=ts(),{openDocument:k}=kr(),b=(w=e.metadata_columns)==null?void 0:w.map(v=>({accessor:`metadata_${v.metadata_id}`,title:v.name,render:d=>{var x;const g=(x=d.metadata)==null?void 0:x.find(h=>h.metadata_id===v.metadata_id);return g?g.value:null}})),y=[{accessor:"name",render:({mime:v,type:d,name:g,status:x,missing_required_metadata:h})=>r.jsxs(U,{align:"center",gap:12,children:[r.jsx(ar,{mime:v??"",isFolder:d==="folder",approvalStatus:x,missingRequiredMetadata:h}),r.jsx("span",{children:g})]})},{accessor:"updated_at",title:"Last Modified"},...b??[]];return r.jsxs(r.Fragment,{children:[r.jsx(or,{title:"My Files"}),r.jsx(lr,{toolbar:a.length>0?r.jsx(es,{setSelectedRecord:l,selectedIds:c,parentId:e.item_id}):r.jsx(Ht,{itemParent:{...e},folderUserRole:s,uploadFileRef:n}),children:r.jsx(Mt,{onDrop:i,openRef:n,children:r.jsxs(Z,{px:8,gap:24,py:8,style:{pointerEvents:"all"},children:[r.jsx(ir,{ancestors:o}),t.length?r.jsx(rr,{textSelectionDisabled:!0,columns:y,records:t,customRowAttributes:({type:v,id:d})=>({onDoubleClick:g=>{g.button===0&&(v==="folder"?p(v,d):v==="document"&&k(d))}}),highlightOnHover:!0,verticalSpacing:"lg",horizontalSpacing:"xl",selectedRecords:a,onSelectedRecordsChange:l}):r.jsx(z,{size:"lg",c:"gray.5",children:"This folder is empty"})]})})}),r.jsx(ns,{folderId:e.item_id})]})}export{Os as default};
