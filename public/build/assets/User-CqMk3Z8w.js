import{W as _,n as f,j as e,M as v,a as j,B as W,Y as B,r as C}from"./app-CGxvGAM1.js";import{a as N,A as Y,I as G,b as M}from"./Authenticated-BM-HvEcH.js";import{T as h,F as w}from"./OfficeLogo-Ei--AZU7.js";import{S as b}from"./Stack-ln4g7GYx.js";import{T as p}from"./TextInput-5pqGPHQ7.js";import{S as g}from"./Select-BjHhz6di.js";import{B as u}from"./Button-Bl7kfwvE.js";import{Y as V}from"./index-CbBGt6-f.js";import{G as H,A as U,u as x}from"./NotificationMenu-D5SqgbTn.js";import{I as L}from"./IconEdit-CrOlNA0d.js";import{u as q,a as J}from"./use-search-datatable-CkHI4L8G.js";import"./Popover-CLWfF2EQ.js";import"./use-uncontrolled-BIgloZcw.js";import"./IconUser-CqDa0PVn.js";import"./get-sorted-breakpoints-BejK4YDM.js";import"./InputBase-QTu-g5X8.js";import"./OptionsDropdown-C5Zz8uUU.js";import"./CheckIcon-DXgJ84kg.js";import"./Combobox-BABC9p8O.js";import"./Checkbox-BP2ZstwZ.js";function K(){const{data:o,setData:a,post:s,processing:r,errors:l,reset:i}=_({name:"",email:"",password:"",password_confirmation:"",workflow_role:"",office_position:"",system_role:""});return{data:o,setData:a,submit:c=>{c.preventDefault(),s(route("users.register"),{onSuccess:()=>{f.show({message:"New user added successfully",color:"green"}),i()},onError:()=>{f.show({message:"Failed to add user",color:"red"})}})},processing:r,errors:l}}const Q=({isOpened:o,close:a})=>{const{data:s,setData:r,submit:l,processing:i,errors:n}=K(),c=()=>{a()};return e.jsx(v,{opened:o,onClose:c,title:e.jsx(h,{size:"lg",children:"Add User"}),size:550,children:e.jsxs("form",{onSubmit:l,children:[e.jsxs(b,{gap:16,children:[e.jsx(p,{id:"name",type:"text",name:"name",value:s.name,label:"Name",onChange:t=>r("name",t.target.value),error:n.name}),e.jsx(p,{id:"email",type:"email",name:"email",value:s.email,label:"Email",onChange:t=>r("email",t.target.value),error:n.email}),e.jsx(p,{id:"password",type:"password",name:"password",value:s.password,label:"Password",onChange:t=>r("password",t.target.value),error:n.password}),e.jsx(p,{id:"password_confirmation",type:"password",name:"password_confirmation",value:s.password_confirmation,label:"Confirm Password",onChange:t=>r("password_confirmation",t.target.value),error:n.password_confirmation}),e.jsx(p,{id:"office_position",type:"text",name:"office_position",value:s.office_position,label:"Office Position",onChange:t=>r("office_position",t.target.value),error:n.office_position}),e.jsx(g,{id:"workflow_role",type:"text",name:"workflow_role",label:"Workflow Role",value:s.workflow_role,placeholder:"Pick value",data:["Reviewer","Approver"],onChange:(t,d)=>r("workflow_role",d.value)}),e.jsx(g,{id:"role",name:"role",label:"Role",placeholder:"Select role",data:[{value:"admin",label:"Admin"},{value:"viewer",label:"Viewer"}],value:s.system_role,onChange:t=>r("system_role",t||""),error:n.system_role})]}),e.jsxs(w,{align:"center",justify:"end",mt:16,children:[e.jsx(u,{variant:"outline",onClick:c,children:"Cancel"}),e.jsx(u,{ml:12,type:"submit",loading:i,children:"Save"})]})]})})};function X({user:o,close:a}){const{data:s,setData:r,put:l,processing:i,errors:n,reset:c}=_({office_position:"",workflow_role:"",system_role:""});return j.useEffect(()=>{o&&r({workflow_role:o.workflow_role,office_position:o.office_position,system_role:o.system_role})},[o]),{data:s,setData:r,submit:d=>{d.preventDefault(),o&&l(route("users.update",o.id),{onSuccess:()=>{f.show({message:"User updated successfully",color:"green"}),a(),c()},onError:y=>{f.show({message:"Failed to update user",color:"red"})}})},processing:i,errors:n}}const Z=({isOpened:o,close:a,user:s})=>{const{data:r,setData:l,submit:i,processing:n,errors:c}=X({user:s,close:a});return e.jsx(v,{opened:o,onClose:a,title:e.jsx(h,{size:"lg",children:"Edit User"}),size:550,children:e.jsxs("form",{onSubmit:i,children:[e.jsxs(b,{gap:16,children:[e.jsx(p,{id:"office_position",type:"text",name:"office_position",value:r.office_position,label:"Office Position",onChange:t=>l("office_position",t.target.value),error:c.office_position}),e.jsx(g,{id:"workflow_role",type:"text",name:"workflow_role",label:"Workflow Role",value:r.workflow_role,placeholder:"Pick value",data:["reviewer","approver"],onChange:(t,d)=>l("workflow_role",d.value)}),e.jsx(g,{id:"role",name:"role",label:"Role",placeholder:"Select role",data:[{value:"admin",label:"Admin"},{value:"viewer",label:"Viewer"}],value:r.system_role,onChange:(t,d)=>l("system_role",d.value),error:c.system_role})]}),e.jsxs(w,{align:"center",justify:"end",mt:16,children:[e.jsx(u,{variant:"outline",onClick:a,children:"Cancel"}),e.jsx(u,{ml:12,type:"submit",loading:n,children:"Save"})]})]})})};function $({user:o,close:a}){const{delete:s,processing:r,reset:l}=_();return{submit:n=>{n.preventDefault(),o&&s(route("users.delete",o==null?void 0:o.id),{onSuccess:()=>{f.show({message:"User deleted successfully",color:"red"}),a(),l()},onError:()=>{f.show({message:"Failed to delete user",color:"red"})}})},processing:r}}const ee=({isOpened:o,close:a,user:s})=>{const{submit:r,processing:l}=$({user:s,close:a});return e.jsx(v,{opened:o,onClose:a,title:e.jsx(h,{size:"lg",children:"Delete User"}),size:550,children:e.jsxs("form",{onSubmit:r,children:[e.jsxs(h,{c:"dimmed",mt:4,size:"sm",children:['Are you sure you want to delete the user "',s==null?void 0:s.name,'"? This action cannot be undone.']}),e.jsxs(w,{align:"center",justify:"end",mt:16,children:[e.jsx(u,{variant:"outline",onClick:a,children:"Cancel"}),e.jsx(u,{ml:12,type:"submit",loading:l,color:"red",children:"Confirm Delete"})]})]})})},oe=({users:o,total:a,perPage:s,page:r,onPageChange:l,onEdit:i,onDelete:n,selectedRecords:c,onSelectedRecordsChange:t})=>e.jsx(V,{pinLastColumn:!0,withTableBorder:!0,shadow:"xs",borderRadius:"sm",withRowBorders:!1,highlightOnHover:!0,verticalSpacing:"lg",totalRecords:a,recordsPerPage:s,page:r,onPageChange:l,columns:[{accessor:"name",noWrap:!0},{accessor:"email",noWrap:!0},{accessor:"office_position",noWrap:!0},{accessor:"workflow_role",title:"Workflow Role"},{accessor:"system_role",title:"System Role"},{accessor:"actions",title:e.jsx(W,{mr:6,children:"Actions"}),textAlign:"right",render:d=>e.jsxs(H,{gap:8,justify:"right",wrap:"nowrap",children:[e.jsx(U,{size:"sm",variant:"subtle",color:"gray",onClick:()=>i(d),children:e.jsx(L,{size:20})}),e.jsx(U,{size:"sm",variant:"subtle",color:"red",onClick:()=>n(d),children:e.jsx(N,{size:20})})]})}],records:o,selectedRecords:c,onSelectedRecordsChange:t});function be({users:o,filters:a}){const[s,r]=j.useState([]),[l,i]=j.useState(),{search:n,setSearch:c,handleSearch:t}=q(a.search||"","/users"),{page:d,setPage:y,handlePageChange:k}=J(o.current_page),[S,{open:D,close:A}]=x(!1),[P,{open:R,close:z}]=x(!1),[E,{open:T,close:O}]=x(!1),F=m=>{i(m),R()},I=m=>{i(m),T()};return e.jsxs(Y,{children:[e.jsx(B,{title:"User"}),e.jsxs(b,{px:8,gap:24,py:8,children:[e.jsx(h,{component:"h2",size:"xl",fw:600,c:"gray.8",children:"User"}),e.jsxs(w,{justify:"space-between",direction:{base:"column",md:"row"},gap:{base:12,md:0},children:[e.jsx(p,{w:{md:400},placeholder:"Search",leftSection:e.jsx(G,{style:{width:C(16),height:C(16)},stroke:1.5}),value:n,onChange:m=>{c(m.target.value),t(m.target.value)}}),e.jsx(u,{leftSection:e.jsx(M,{size:14}),onClick:D,children:"Add New User"})]}),e.jsx(oe,{users:o.data,total:o.total,perPage:o.per_page,page:d,onPageChange:m=>{y(m),k(m,o.links)},onEdit:F,onDelete:I,selectedRecords:s,onSelectedRecordsChange:r})]}),e.jsx(Q,{isOpened:S,close:A}),e.jsx(Z,{isOpened:P,close:z,user:l}),e.jsx(ee,{isOpened:E,close:O,user:l})]})}export{be as default};
