import{v as yo,f as Ve,u as Le,w as Ko,d as Je,j as t,T as Ho,B as Xe,L as xo,O as so,e as jo,l as Go,b as u,R as Yo,x as qo,z as Vo,h as Jo,g as Xo,A as Zo,r as B,W as Z,n as E,M as se,P as bo,c as Ze,a as Ke,y as Qo,Y as et}from"./app-B-uZTNgo.js";import{Y as ot}from"./index-DBIf5hI7.js";import{a as tt,I as rt}from"./ItemIcon-7CQ5bm1j.js";import{u as I,a as Qe,b as wo,T as J,A as st}from"./Authenticated-4qProzow.js";import{I as nt}from"./ItemBreadcrumbs-BxZx2X_q.js";import{u as at}from"./Popover-Dr_wvzW_.js";import{u as lt,G as T,a as Do,A as N,M as fe,I as it}from"./NotificationMenu-DDpxYau7.js";import{I as ct,u as ko,R as me,a as dt}from"./use-fetch-users-approval-role-CJUh5e7Q.js";import{T as k,F as X}from"./OfficeLogo-DGK0o9rf.js";import{S as q}from"./Stack-CDKCNJxt.js";import{T as Co}from"./Textarea-ByICqxHL.js";import{B as F}from"./Button-Biazr2Gq.js";import{U as ut}from"./UpdateNumberingSchemeForm-D3ECeIhx.js";import{T as Ge}from"./TextInput-BXGjYln6.js";import{u as pt}from"./use-generate-report-C5rFPf5O.js";import{c as $}from"./IconUser-h2aBZatH.js";import{I as ft}from"./IconFolder-Cm9WezcK.js";import{I as mt}from"./IconDownload-ICl4AD7p.js";import{u as ht}from"./use-document-properties-BGJilV6h.js";import{u as gt}from"./use-fetch-metadata-DU3sFcuB.js";import{A as vt,I as yt}from"./IconAlertCircle-qDMCqEjO.js";import{S as xt}from"./Select-DZAAjhNC.js";import"./Checkbox-D6BIu8Wh.js";import"./InputBase-DwBnt2sp.js";import"./use-uncontrolled-B89zD15M.js";import"./CheckIcon-BfGjhTws.js";import"./ScrollArea-vJ_aC1-I.js";import"./get-color-status-DWf4oBUm.js";import"./IconPhoto-BSEUCY4f.js";import"./get-sorted-breakpoints-VzKioMi7.js";import"./Anchor-BZeS7xua.js";import"./Combobox-BK4aA5FW.js";function no(e){return typeof e!="string"?"":e.charAt(0).toUpperCase()+e.slice(1)}var Fo={root:"m_6e45937b",loader:"m_e8eb006c",overlay:"m_df587f17"};const ao={transitionProps:{transition:"fade",duration:0},overlayProps:{backgroundOpacity:.75},zIndex:yo("overlay")},jt=jo((e,{zIndex:o})=>({root:{"--lo-z-index":o==null?void 0:o.toString()}})),eo=Ve((e,o)=>{const r=Le("LoadingOverlay",ao,e),{classNames:s,className:n,style:l,styles:a,unstyled:i,vars:d,transitionProps:p,loaderProps:f,overlayProps:g,visible:v,zIndex:h,...y}=r,C=Ko(),b=Je({name:"LoadingOverlay",classes:Fo,props:r,className:n,style:l,classNames:s,styles:a,unstyled:i,vars:d,varsResolver:jt}),D={...ao.overlayProps,...g};return t.jsx(Ho,{transition:"fade",...p,mounted:!!v,children:w=>t.jsxs(Xe,{...b("root",{style:w}),ref:o,...y,children:[t.jsx(xo,{...b("loader"),unstyled:i,...f}),t.jsx(so,{...D,...b("overlay"),darkHidden:!0,unstyled:i,color:(g==null?void 0:g.color)||C.white}),t.jsx(so,{...D,...b("overlay"),lightHidden:!0,unstyled:i,color:(g==null?void 0:g.color)||C.colors.dark[5]})]})})});eo.classes=Fo;eo.displayName="@mantine/core/LoadingOverlay";var _o={exports:{}},bt="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",wt=bt,Dt=wt;function Eo(){}function So(){}So.resetWarningCache=Eo;var kt=function(){function e(s,n,l,a,i,d){if(d!==Dt){var p=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw p.name="Invariant Violation",p}}e.isRequired=e;function o(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:o,element:e,elementType:e,instanceOf:o,node:e,objectOf:o,oneOf:o,oneOfType:o,shape:o,exact:o,checkPropTypes:So,resetWarningCache:Eo};return r.PropTypes=r,r};_o.exports=kt();var Ct=_o.exports;const j=Go(Ct);/**
 * @license @tabler/icons-react v3.11.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ft=$("outline","adjustments","IconAdjustments",[["path",{d:"M4 10a2 2 0 1 0 4 0a2 2 0 0 0 -4 0",key:"svg-0"}],["path",{d:"M6 4v4",key:"svg-1"}],["path",{d:"M6 12v8",key:"svg-2"}],["path",{d:"M10 16a2 2 0 1 0 4 0a2 2 0 0 0 -4 0",key:"svg-3"}],["path",{d:"M12 4v10",key:"svg-4"}],["path",{d:"M12 18v2",key:"svg-5"}],["path",{d:"M16 7a2 2 0 1 0 4 0a2 2 0 0 0 -4 0",key:"svg-6"}],["path",{d:"M18 4v1",key:"svg-7"}],["path",{d:"M18 9v11",key:"svg-8"}]]);/**
 * @license @tabler/icons-react v3.11.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var _t=$("outline","article","IconArticle",[["path",{d:"M3 4m0 2a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2z",key:"svg-0"}],["path",{d:"M7 8h10",key:"svg-1"}],["path",{d:"M7 12h10",key:"svg-2"}],["path",{d:"M7 16h10",key:"svg-3"}]]);/**
 * @license @tabler/icons-react v3.11.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var He=$("outline","chevron-down","IconChevronDown",[["path",{d:"M6 9l6 6l6 -6",key:"svg-0"}]]);/**
 * @license @tabler/icons-react v3.11.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Et=$("outline","chevron-left","IconChevronLeft",[["path",{d:"M15 6l-6 6l6 6",key:"svg-0"}]]);/**
 * @license @tabler/icons-react v3.11.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var St=$("outline","file-isr","IconFileIsr",[["path",{d:"M15 3v4a1 1 0 0 0 1 1h4",key:"svg-0"}],["path",{d:"M15 3v4a1 1 0 0 0 1 1h4",key:"svg-1"}],["path",{d:"M6 8v-3a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2v-7",key:"svg-2"}],["path",{d:"M3 15l3 -3l3 3",key:"svg-3"}]]);/**
 * @license @tabler/icons-react v3.11.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Mt=$("outline","file-report","IconFileReport",[["path",{d:"M17 17m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0",key:"svg-0"}],["path",{d:"M17 13v4h4",key:"svg-1"}],["path",{d:"M12 3v4a1 1 0 0 0 1 1h4",key:"svg-2"}],["path",{d:"M11.5 21h-6.5a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v2m0 3v4",key:"svg-3"}]]);/**
 * @license @tabler/icons-react v3.11.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var zt=$("outline","folder-plus","IconFolderPlus",[["path",{d:"M12 19h-7a2 2 0 0 1 -2 -2v-11a2 2 0 0 1 2 -2h4l3 3h7a2 2 0 0 1 2 2v3.5",key:"svg-0"}],["path",{d:"M16 19h6",key:"svg-1"}],["path",{d:"M19 16v6",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.11.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var At=$("outline","folder-symlink","IconFolderSymlink",[["path",{d:"M3 21v-4a3 3 0 0 1 3 -3h5",key:"svg-0"}],["path",{d:"M8 17l3 -3l-3 -3",key:"svg-1"}],["path",{d:"M3 11v-5a2 2 0 0 1 2 -2h4l3 3h7a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-8",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.11.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var It=$("outline","folder-up","IconFolderUp",[["path",{d:"M12 19h-7a2 2 0 0 1 -2 -2v-11a2 2 0 0 1 2 -2h4l3 3h7a2 2 0 0 1 2 2v3.5",key:"svg-0"}],["path",{d:"M19 22v-6",key:"svg-1"}],["path",{d:"M22 19l-3 -3l-3 3",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.11.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ot=$("outline","list-tree","IconListTree",[["path",{d:"M9 6h11",key:"svg-0"}],["path",{d:"M12 12h8",key:"svg-1"}],["path",{d:"M15 18h5",key:"svg-2"}],["path",{d:"M5 6v.01",key:"svg-3"}],["path",{d:"M8 12v.01",key:"svg-4"}],["path",{d:"M11 18v.01",key:"svg-5"}]]);/**
 * @license @tabler/icons-react v3.11.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Rt=$("outline","selector","IconSelector",[["path",{d:"M8 9l4 -4l4 4",key:"svg-0"}],["path",{d:"M16 15l-4 4l-4 -4",key:"svg-1"}]]);/**
 * @license @tabler/icons-react v3.11.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Tt=$("outline","table","IconTable",[["path",{d:"M3 5a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v14a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2v-14z",key:"svg-0"}],["path",{d:"M3 10h18",key:"svg-1"}],["path",{d:"M10 3v18",key:"svg-2"}]]);const Wt=new Map([["aac","audio/aac"],["abw","application/x-abiword"],["arc","application/x-freearc"],["avif","image/avif"],["avi","video/x-msvideo"],["azw","application/vnd.amazon.ebook"],["bin","application/octet-stream"],["bmp","image/bmp"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["cda","application/x-cdf"],["csh","application/x-csh"],["css","text/css"],["csv","text/csv"],["doc","application/msword"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["eot","application/vnd.ms-fontobject"],["epub","application/epub+zip"],["gz","application/gzip"],["gif","image/gif"],["heic","image/heic"],["heif","image/heif"],["htm","text/html"],["html","text/html"],["ico","image/vnd.microsoft.icon"],["ics","text/calendar"],["jar","application/java-archive"],["jpeg","image/jpeg"],["jpg","image/jpeg"],["js","text/javascript"],["json","application/json"],["jsonld","application/ld+json"],["mid","audio/midi"],["midi","audio/midi"],["mjs","text/javascript"],["mp3","audio/mpeg"],["mp4","video/mp4"],["mpeg","video/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["opus","audio/opus"],["otf","font/otf"],["png","image/png"],["pdf","application/pdf"],["php","application/x-httpd-php"],["ppt","application/vnd.ms-powerpoint"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["rar","application/vnd.rar"],["rtf","application/rtf"],["sh","application/x-sh"],["svg","image/svg+xml"],["swf","application/x-shockwave-flash"],["tar","application/x-tar"],["tif","image/tiff"],["tiff","image/tiff"],["ts","video/mp2t"],["ttf","font/ttf"],["txt","text/plain"],["vsd","application/vnd.visio"],["wav","audio/wav"],["weba","audio/webm"],["webm","video/webm"],["webp","image/webp"],["woff","font/woff"],["woff2","font/woff2"],["xhtml","application/xhtml+xml"],["xls","application/vnd.ms-excel"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xml","application/xml"],["xul","application/vnd.mozilla.xul+xml"],["zip","application/zip"],["7z","application/x-7z-compressed"],["mkv","video/x-matroska"],["mov","video/quicktime"],["msg","application/vnd.ms-outlook"]]);function ke(e,o){const r=Lt(e);if(typeof r.path!="string"){const{webkitRelativePath:s}=e;Object.defineProperty(r,"path",{value:typeof o=="string"?o:typeof s=="string"&&s.length>0?s:e.name,writable:!1,configurable:!1,enumerable:!0})}return r}function Lt(e){const{name:o}=e;if(o&&o.lastIndexOf(".")!==-1&&!e.type){const s=o.split(".").pop().toLowerCase(),n=Wt.get(s);n&&Object.defineProperty(e,"type",{value:n,writable:!1,configurable:!1,enumerable:!0})}return e}var he=(e,o,r)=>new Promise((s,n)=>{var l=d=>{try{i(r.next(d))}catch(p){n(p)}},a=d=>{try{i(r.throw(d))}catch(p){n(p)}},i=d=>d.done?s(d.value):Promise.resolve(d.value).then(l,a);i((r=r.apply(e,o)).next())});const Nt=[".DS_Store","Thumbs.db"];function $t(e){return he(this,null,function*(){return Oe(e)&&Pt(e.dataTransfer)?Ht(e.dataTransfer,e.type):Ut(e)?Bt(e):Array.isArray(e)&&e.every(o=>"getFile"in o&&typeof o.getFile=="function")?Kt(e):[]})}function Pt(e){return Oe(e)}function Ut(e){return Oe(e)&&Oe(e.target)}function Oe(e){return typeof e=="object"&&e!==null}function Bt(e){return Ye(e.target.files).map(o=>ke(o))}function Kt(e){return he(this,null,function*(){return(yield Promise.all(e.map(r=>r.getFile()))).map(r=>ke(r))})}function Ht(e,o){return he(this,null,function*(){if(e.items){const r=Ye(e.items).filter(n=>n.kind==="file");if(o!=="drop")return r;const s=yield Promise.all(r.map(Gt));return lo(Mo(s))}return lo(Ye(e.files).map(r=>ke(r)))})}function lo(e){return e.filter(o=>Nt.indexOf(o.name)===-1)}function Ye(e){if(e===null)return[];const o=[];for(let r=0;r<e.length;r++){const s=e[r];o.push(s)}return o}function Gt(e){if(typeof e.webkitGetAsEntry!="function")return io(e);const o=e.webkitGetAsEntry();return o&&o.isDirectory?zo(o):io(e)}function Mo(e){return e.reduce((o,r)=>[...o,...Array.isArray(r)?Mo(r):[r]],[])}function io(e){const o=e.getAsFile();if(!o)return Promise.reject(`${e} is not a File`);const r=ke(o);return Promise.resolve(r)}function Yt(e){return he(this,null,function*(){return e.isDirectory?zo(e):qt(e)})}function zo(e){const o=e.createReader();return new Promise((r,s)=>{const n=[];function l(){o.readEntries(a=>he(this,null,function*(){if(a.length){const i=Promise.all(a.map(Yt));n.push(i),l()}else try{const i=yield Promise.all(n);r(i)}catch(i){s(i)}}),a=>{s(a)})}l()})}function qt(e){return he(this,null,function*(){return new Promise((o,r)=>{e.file(s=>{const n=ke(s,e.fullPath);o(n)},s=>{r(s)})})})}function Vt(e,o){if(e&&o){const r=Array.isArray(o)?o:o.split(","),s=e.name||"",n=(e.type||"").toLowerCase(),l=n.replace(/\/.*$/,"");return r.some(a=>{const i=a.trim().toLowerCase();return i.charAt(0)==="."?s.toLowerCase().endsWith(i):i.endsWith("/*")?l===i.replace(/\/.*$/,""):n===i})}return!0}var Jt=Object.defineProperty,Xt=Object.defineProperties,Zt=Object.getOwnPropertyDescriptors,co=Object.getOwnPropertySymbols,Qt=Object.prototype.hasOwnProperty,er=Object.prototype.propertyIsEnumerable,uo=(e,o,r)=>o in e?Jt(e,o,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[o]=r,or=(e,o)=>{for(var r in o||(o={}))Qt.call(o,r)&&uo(e,r,o[r]);if(co)for(var r of co(o))er.call(o,r)&&uo(e,r,o[r]);return e},tr=(e,o)=>Xt(e,Zt(o));const rr="file-invalid-type",sr="file-too-large",nr="file-too-small",ar="too-many-files",lr=e=>{e=Array.isArray(e)&&e.length===1?e[0]:e;const o=Array.isArray(e)?`one of ${e.join(", ")}`:e;return{code:rr,message:`File type must be ${o}`}},po=e=>({code:sr,message:`File is larger than ${e} ${e===1?"byte":"bytes"}`}),fo=e=>({code:nr,message:`File is smaller than ${e} ${e===1?"byte":"bytes"}`}),ir={code:ar,message:"Too many files"};function Ao(e,o){const r=e.type==="application/x-moz-file"||Vt(e,o);return[r,r?null:lr(o)]}function Io(e,o,r){if(ie(e.size))if(ie(o)&&ie(r)){if(e.size>r)return[!1,po(r)];if(e.size<o)return[!1,fo(o)]}else{if(ie(o)&&e.size<o)return[!1,fo(o)];if(ie(r)&&e.size>r)return[!1,po(r)]}return[!0,null]}function ie(e){return e!=null}function cr({files:e,accept:o,minSize:r,maxSize:s,multiple:n,maxFiles:l,validator:a}){return!n&&e.length>1||n&&l>=1&&e.length>l?!1:e.every(i=>{const[d]=Ao(i,o),[p]=Io(i,r,s),f=a?a(i):null;return d&&p&&!f})}function Re(e){return typeof e.isPropagationStopped=="function"?e.isPropagationStopped():typeof e.cancelBubble<"u"?e.cancelBubble:!1}function Ie(e){return e.dataTransfer?Array.prototype.some.call(e.dataTransfer.types,o=>o==="Files"||o==="application/x-moz-file"):!!e.target&&!!e.target.files}function mo(e){e.preventDefault()}function dr(e){return e.indexOf("MSIE")!==-1||e.indexOf("Trident/")!==-1}function ur(e){return e.indexOf("Edge/")!==-1}function pr(e=window.navigator.userAgent){return dr(e)||ur(e)}function Y(...e){return(o,...r)=>e.some(s=>(!Re(o)&&s&&s(o,...r),Re(o)))}function fr(){return"showOpenFilePicker"in window}function mr(e){return ie(e)?[{description:"Files",accept:Object.entries(e).filter(([r,s])=>{let n=!0;return Oo(r)||(console.warn(`Skipped "${r}" because it is not a valid MIME type. Check https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types for a list of valid MIME types.`),n=!1),(!Array.isArray(s)||!s.every(Ro))&&(console.warn(`Skipped "${r}" because an invalid file extension was provided.`),n=!1),n}).reduce((r,[s,n])=>tr(or({},r),{[s]:n}),{})}]:e}function hr(e){if(ie(e))return Object.entries(e).reduce((o,[r,s])=>[...o,r,...s],[]).filter(o=>Oo(o)||Ro(o)).join(",")}function gr(e){return e instanceof DOMException&&(e.name==="AbortError"||e.code===e.ABORT_ERR)}function vr(e){return e instanceof DOMException&&(e.name==="SecurityError"||e.code===e.SECURITY_ERR)}function Oo(e){return e==="audio/*"||e==="video/*"||e==="image/*"||e==="text/*"||/\w+\/[-+.\w]+/g.test(e)}function Ro(e){return/^.*\.[\w]+$/.test(e)}var yr=Object.defineProperty,xr=Object.defineProperties,jr=Object.getOwnPropertyDescriptors,Te=Object.getOwnPropertySymbols,To=Object.prototype.hasOwnProperty,Wo=Object.prototype.propertyIsEnumerable,ho=(e,o,r)=>o in e?yr(e,o,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[o]=r,A=(e,o)=>{for(var r in o||(o={}))To.call(o,r)&&ho(e,r,o[r]);if(Te)for(var r of Te(o))Wo.call(o,r)&&ho(e,r,o[r]);return e},re=(e,o)=>xr(e,jr(o)),We=(e,o)=>{var r={};for(var s in e)To.call(e,s)&&o.indexOf(s)<0&&(r[s]=e[s]);if(e!=null&&Te)for(var s of Te(e))o.indexOf(s)<0&&Wo.call(e,s)&&(r[s]=e[s]);return r};const oo=u.forwardRef((e,o)=>{var r=e,{children:s}=r,n=We(r,["children"]);const l=No(n),{open:a}=l,i=We(l,["open"]);return u.useImperativeHandle(o,()=>({open:a}),[a]),Yo.createElement(u.Fragment,null,s(re(A({},i),{open:a})))});oo.displayName="Dropzone";const Lo={disabled:!1,getFilesFromEvent:$t,maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1,validator:null,useFsAccessApi:!0,autoFocus:!1};oo.defaultProps=Lo;oo.propTypes={children:j.func,accept:j.objectOf(j.arrayOf(j.string)),multiple:j.bool,preventDropOnDocument:j.bool,noClick:j.bool,noKeyboard:j.bool,noDrag:j.bool,noDragEventsBubbling:j.bool,minSize:j.number,maxSize:j.number,maxFiles:j.number,disabled:j.bool,getFilesFromEvent:j.func,onFileDialogCancel:j.func,onFileDialogOpen:j.func,useFsAccessApi:j.bool,autoFocus:j.bool,onDragEnter:j.func,onDragLeave:j.func,onDragOver:j.func,onDrop:j.func,onDropAccepted:j.func,onDropRejected:j.func,onError:j.func,validator:j.func};const qe={isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,acceptedFiles:[],fileRejections:[]};function No(e={}){const{accept:o,disabled:r,getFilesFromEvent:s,maxSize:n,minSize:l,multiple:a,maxFiles:i,onDragEnter:d,onDragLeave:p,onDragOver:f,onDrop:g,onDropAccepted:v,onDropRejected:h,onFileDialogCancel:y,onFileDialogOpen:C,useFsAccessApi:b,autoFocus:D,preventDropOnDocument:w,noClick:x,noKeyboard:W,noDrag:P,noDragEventsBubbling:U,onError:K,validator:H}=A(A({},Lo),e),G=u.useMemo(()=>hr(o),[o]),L=u.useMemo(()=>mr(o),[o]),Q=u.useMemo(()=>typeof C=="function"?C:go,[C]),ee=u.useMemo(()=>typeof y=="function"?y:go,[y]),S=u.useRef(null),O=u.useRef(null),[Ce,z]=u.useReducer(br,qe),{isFocused:Ne,isFileDialogActive:ge}=Ce,ce=u.useRef(typeof window<"u"&&window.isSecureContext&&b&&fr()),$e=()=>{!ce.current&&ge&&setTimeout(()=>{if(O.current){const{files:c}=O.current;c.length||(z({type:"closeDialog"}),ee())}},300)};u.useEffect(()=>(window.addEventListener("focus",$e,!1),()=>{window.removeEventListener("focus",$e,!1)}),[O,ge,ee,ce]);const ae=u.useRef([]),Fe=c=>{S.current&&S.current.contains(c.target)||(c.preventDefault(),ae.current=[])};u.useEffect(()=>(w&&(document.addEventListener("dragover",mo,!1),document.addEventListener("drop",Fe,!1)),()=>{w&&(document.removeEventListener("dragover",mo),document.removeEventListener("drop",Fe))}),[S,w]),u.useEffect(()=>(!r&&D&&S.current&&S.current.focus(),()=>{}),[S,D,r]);const V=u.useCallback(c=>{K?K(c):console.error(c)},[K]),_e=u.useCallback(c=>{c.preventDefault(),c.persist(),Ae(c),ae.current=[...ae.current,c.target],Ie(c)&&Promise.resolve(s(c)).then(m=>{if(Re(c)&&!U)return;const _=m.length,M=_>0&&cr({files:m,accept:G,minSize:l,maxSize:n,multiple:a,maxFiles:i,validator:H}),R=_>0&&!M;z({isDragAccept:M,isDragReject:R,isDragActive:!0,type:"setDraggedFiles"}),d&&d(c)}).catch(m=>V(m))},[s,d,V,U,G,l,n,a,i,H]),Ee=u.useCallback(c=>{c.preventDefault(),c.persist(),Ae(c);const m=Ie(c);if(m&&c.dataTransfer)try{c.dataTransfer.dropEffect="copy"}catch{}return m&&f&&f(c),!1},[f,U]),Se=u.useCallback(c=>{c.preventDefault(),c.persist(),Ae(c);const m=ae.current.filter(M=>S.current&&S.current.contains(M)),_=m.indexOf(c.target);_!==-1&&m.splice(_,1),ae.current=m,!(m.length>0)&&(z({type:"setDraggedFiles",isDragActive:!1,isDragAccept:!1,isDragReject:!1}),Ie(c)&&p&&p(c))},[S,p,U]),le=u.useCallback((c,m)=>{const _=[],M=[];c.forEach(R=>{const[xe,je]=Ao(R,G),[Pe,Ue]=Io(R,l,n),be=H?H(R):null;if(xe&&Pe&&!be)_.push(R);else{let we=[je,Ue];be&&(we=we.concat(be)),M.push({file:R,errors:we.filter(Be=>Be)})}}),(!a&&_.length>1||a&&i>=1&&_.length>i)&&(_.forEach(R=>{M.push({file:R,errors:[ir]})}),_.splice(0)),z({acceptedFiles:_,fileRejections:M,type:"setFiles"}),g&&g(_,M,m),M.length>0&&h&&h(M,m),_.length>0&&v&&v(_,m)},[z,a,G,l,n,i,g,v,h,H]),de=u.useCallback(c=>{c.preventDefault(),c.persist(),Ae(c),ae.current=[],Ie(c)&&Promise.resolve(s(c)).then(m=>{Re(c)&&!U||le(m,c)}).catch(m=>V(m)),z({type:"reset"})},[s,le,V,U]),oe=u.useCallback(()=>{if(ce.current){z({type:"openDialog"}),Q();const c={multiple:a,types:L};window.showOpenFilePicker(c).then(m=>s(m)).then(m=>{le(m,null),z({type:"closeDialog"})}).catch(m=>{gr(m)?(ee(m),z({type:"closeDialog"})):vr(m)?(ce.current=!1,O.current?(O.current.value=null,O.current.click()):V(new Error("Cannot open the file picker because the https://developer.mozilla.org/en-US/docs/Web/API/File_System_Access_API is not supported and no <input> was provided."))):V(m)});return}O.current&&(z({type:"openDialog"}),Q(),O.current.value=null,O.current.click())},[z,Q,ee,b,le,V,L,a]),ue=u.useCallback(c=>{!S.current||!S.current.isEqualNode(c.target)||(c.key===" "||c.key==="Enter"||c.keyCode===32||c.keyCode===13)&&(c.preventDefault(),oe())},[S,oe]),pe=u.useCallback(()=>{z({type:"focus"})},[]),Me=u.useCallback(()=>{z({type:"blur"})},[]),ve=u.useCallback(()=>{x||(pr()?setTimeout(oe,0):oe())},[x,oe]),te=c=>r?null:c,ye=c=>W?null:te(c),ze=c=>P?null:te(c),Ae=c=>{U&&c.stopPropagation()},$o=u.useMemo(()=>(c={})=>{var m=c,{refKey:_="ref",role:M,onKeyDown:R,onFocus:xe,onBlur:je,onClick:Pe,onDragEnter:Ue,onDragOver:be,onDragLeave:we,onDrop:Be}=m,Bo=We(m,["refKey","role","onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragOver","onDragLeave","onDrop"]);return A(A({onKeyDown:ye(Y(R,ue)),onFocus:ye(Y(xe,pe)),onBlur:ye(Y(je,Me)),onClick:te(Y(Pe,ve)),onDragEnter:ze(Y(Ue,_e)),onDragOver:ze(Y(be,Ee)),onDragLeave:ze(Y(we,Se)),onDrop:ze(Y(Be,de)),role:typeof M=="string"&&M!==""?M:"presentation",[_]:S},!r&&!W?{tabIndex:0}:{}),Bo)},[S,ue,pe,Me,ve,_e,Ee,Se,de,W,P,r]),Po=u.useCallback(c=>{c.stopPropagation()},[]),Uo=u.useMemo(()=>(c={})=>{var m=c,{refKey:_="ref",onChange:M,onClick:R}=m,xe=We(m,["refKey","onChange","onClick"]);const je={accept:G,multiple:a,type:"file",style:{display:"none"},onChange:te(Y(M,de)),onClick:te(Y(R,Po)),tabIndex:-1,[_]:O};return A(A({},je),xe)},[O,o,a,de,r]);return re(A({},Ce),{isFocused:Ne&&!r,getRootProps:$o,getInputProps:Uo,rootRef:S,inputRef:O,open:te(oe)})}function br(e,o){switch(o.type){case"focus":return re(A({},e),{isFocused:!0});case"blur":return re(A({},e),{isFocused:!1});case"openDialog":return re(A({},qe),{isFileDialogActive:!0});case"closeDialog":return re(A({},e),{isFileDialogActive:!1});case"setDraggedFiles":return re(A({},e),{isDragActive:o.isDragActive,isDragAccept:o.isDragAccept,isDragReject:o.isDragReject});case"setFiles":return re(A({},e),{acceptedFiles:o.acceptedFiles,fileRejections:o.fileRejections});case"reset":return A({},qe);default:return e}}function go(){}const[wr,Dr]=qo("Dropzone component was not found in tree");function to(e){const o=r=>{const{children:s,...n}=Le(`Dropzone${no(e)}`,{},r),l=Dr(),a=Vo(s)?s:t.jsx("span",{children:s});return l[e]?u.cloneElement(a,n):null};return o.displayName=`@mantine/dropzone/${no(e)}`,o}const kr=to("accept"),Cr=to("reject"),Fr=to("idle");var De={root:"m_d46a4834",inner:"m_b85f7144",fullScreen:"m_96f6e9ad",dropzone:"m_7946116d"};const _r={loading:!1,multiple:!0,maxSize:1/0,autoFocus:!1,activateOnClick:!0,activateOnDrag:!0,dragEventsBubbling:!0,activateOnKeyboard:!0,useFsAccessApi:!0,variant:"light",rejectColor:"red"},Er=jo((e,{radius:o,variant:r,acceptColor:s,rejectColor:n})=>{const l=e.variantColorResolver({color:s||e.primaryColor,theme:e,variant:r}),a=e.variantColorResolver({color:n||"red",theme:e,variant:r});return{root:{"--dropzone-radius":Xo(o),"--dropzone-accept-color":l.color,"--dropzone-accept-bg":l.background,"--dropzone-reject-color":a.color,"--dropzone-reject-bg":a.background}}}),ne=Ve((e,o)=>{const r=Le("Dropzone",_r,e),{classNames:s,className:n,style:l,styles:a,unstyled:i,vars:d,radius:p,disabled:f,loading:g,multiple:v,maxSize:h,accept:y,children:C,onDropAny:b,onDrop:D,onReject:w,openRef:x,name:W,maxFiles:P,autoFocus:U,activateOnClick:K,activateOnDrag:H,dragEventsBubbling:G,activateOnKeyboard:L,onDragEnter:Q,onDragLeave:ee,onDragOver:S,onFileDialogCancel:O,onFileDialogOpen:Ce,preventDropOnDocument:z,useFsAccessApi:Ne,getFilesFromEvent:ge,validator:ce,rejectColor:$e,acceptColor:ae,enablePointerEvents:Fe,loaderProps:V,inputProps:_e,mod:Ee,...Se}=r,le=Je({name:"Dropzone",classes:De,props:r,className:n,style:l,classNames:s,styles:a,unstyled:i,vars:d,varsResolver:Er}),{getRootProps:de,getInputProps:oe,isDragAccept:ue,isDragReject:pe,open:Me}=No({onDrop:b,onDropAccepted:D,onDropRejected:w,disabled:f||g,accept:Array.isArray(y)?y.reduce((te,ye)=>({...te,[ye]:[]}),{}):y,multiple:v,maxSize:h,maxFiles:P,autoFocus:U,noClick:!K,noDrag:!H,noDragEventsBubbling:!G,noKeyboard:!L,onDragEnter:Q,onDragLeave:ee,onDragOver:S,onFileDialogCancel:O,onFileDialogOpen:Ce,preventDropOnDocument:z,useFsAccessApi:Ne,validator:ce,...ge?{getFilesFromEvent:ge}:null});Jo(x,Me);const ve=!ue&&!pe;return t.jsx(wr,{value:{accept:ue,reject:pe,idle:ve},children:t.jsxs(Xe,{...de(),...le("root",{focusable:!0}),...Se,mod:[{accept:ue,reject:pe,idle:ve,disabled:f,loading:g,"activate-on-click":K},Ee],children:[t.jsx(eo,{visible:g,overlayProps:{radius:p},unstyled:i,loaderProps:V}),t.jsx("input",{...oe(_e),name:W}),t.jsx("div",{...le("inner"),ref:o,"data-enable-pointer-events":Fe||void 0,children:C})]})})});ne.classes=De;ne.displayName="@mantine/dropzone/Dropzone";ne.Accept=kr;ne.Idle=Fr;ne.Reject=Cr;const Sr={loading:!1,maxSize:1/0,activateOnClick:!1,activateOnDrag:!0,dragEventsBubbling:!0,activateOnKeyboard:!0,active:!0,zIndex:yo("max"),withinPortal:!0},ro=Ve((e,o)=>{const r=Le("DropzoneFullScreen",Sr,e),{classNames:s,className:n,style:l,styles:a,unstyled:i,vars:d,active:p,onDrop:f,onReject:g,zIndex:v,withinPortal:h,portalProps:y,...C}=r,b=Je({name:"DropzoneFullScreen",classes:De,props:r,className:n,style:l,classNames:s,styles:a,unstyled:i,rootSelector:"fullScreen"}),{resolvedClassNames:D,resolvedStyles:w}=at({classNames:s,styles:a,props:r}),[x,W]=u.useState(0),[P,{open:U,close:K}]=lt(!1),H=L=>{var Q;(Q=L.dataTransfer)!=null&&Q.types.includes("Files")&&(W(ee=>ee+1),U())},G=()=>{W(L=>L-1)};return u.useEffect(()=>{x===0&&K()},[x]),u.useEffect(()=>{if(p)return document.addEventListener("dragenter",H,!1),document.addEventListener("dragleave",G,!1),()=>{document.removeEventListener("dragenter",H,!1),document.removeEventListener("dragleave",G,!1)}},[p]),t.jsx(Zo,{...y,withinPortal:h,children:t.jsx(Xe,{...b("fullScreen",{style:{opacity:P?1:0,pointerEvents:P?"all":"none",zIndex:v}}),ref:o,children:t.jsx(ne,{...C,classNames:D,styles:w,unstyled:i,className:De.dropzone,onDrop:L=>{f==null||f(L),K(),W(0)},onReject:L=>{g==null||g(L),K(),W(0)}})})})});ro.classes=De;ro.displayName="@mantine/dropzone/DropzoneFullScreen";ne.FullScreen=ro;const vo=ne;function Mr({onDrop:e,openRef:o,children:r}){return t.jsxs(vo,{openRef:o,onDrop:e,activateOnClick:!1,acceptColor:"var(--mantine-color-white)",styles:{root:{border:"none",padding:0}},children:[t.jsx(vo.Accept,{children:t.jsx(ct,{style:{width:B(52),height:B(52),color:"var(--mantine-color-blue-6)",position:"absolute",bottom:B(16),left:"50%",transform:"translateX(-50%)",zIndex:9999},stroke:1.5})}),r]})}function zr({itemParentId:e}){const[o,r]=u.useState("reviewal"),{closeModal:s,modals:n}=I(),l=ko(o,n.createWorkflow),{data:a,setData:i,post:d,processing:p,errors:f,reset:g}=Z({folder_item_id:"",resolution:"",destination:"",type:"reviewal",users:[]});return{data:a,setData:i,createApprovalSubmit:h=>{h.preventDefault(),a.folder_item_id=e??"",a.users=l.map(y=>({user_id:y.id})),d(route("workflows.store"),{preserveScroll:!0,onSuccess:()=>{s("createWorkflow"),E.show({message:"Approval process created",color:"green"})},onError:()=>{E.show({message:"Something went wrong",color:"red"})},onFinish:()=>g()})},processing:p,errors:f,users:l,setWorkflowType:r}}const Ar=({itemParent:e})=>{const{data:o,setData:r,createApprovalSubmit:s,processing:n,errors:l,users:a,setWorkflowType:i}=zr({itemParentId:e==null?void 0:e.item_id}),{modals:d,closeModal:p}=I();return t.jsx(se,{opened:d.createWorkflow,onClose:()=>p("createWorkflow"),title:t.jsx(k,{fw:"bold",size:"lg",children:"Create Workflow Process"}),size:550,children:t.jsxs("form",{onSubmit:s,children:[t.jsxs(q,{gap:16,children:[t.jsx(k,{size:"sm",c:"dimmed",children:"Routinely directs any uploaded file in this folder through a predefined approval workflow"}),t.jsx(me.Group,{name:"status",value:o.type,onChange:f=>{r("type",f),i(f)},children:t.jsxs(T,{mt:"xs",children:[t.jsx(me,{value:"reviewal",label:"Review"}),t.jsx(me,{value:"approval",label:"Approval"})]})}),t.jsx(Co,{label:"Resolution",placeholder:"Your resolution for this approval",value:o.resolution??"",onChange:f=>r("resolution",f.target.value),error:l.resolution,autosize:!0,minRows:2,maxRows:4}),t.jsx(k,{size:"sm",fw:500,mb:-8,children:"User in this workflow"}),a.map(f=>t.jsx(bo,{withBorder:!0,radius:"md",py:16,px:10,children:t.jsxs(T,{children:[t.jsx(Do,{}),t.jsxs(q,{gap:8,children:[t.jsx(k,{size:"sm",children:f.name}),t.jsx(k,{size:"sm",children:f.email})]})]})},f.id))]}),t.jsxs(X,{align:"center",justify:"end",mt:16,children:[t.jsx(F,{variant:"light",onClick:()=>p("createWorkflow"),children:"Cancel"}),t.jsx(F,{ml:12,type:"submit",loading:n,children:"Create"})]})]})})};function Ir({itemParent:e}){const{data:o,setData:r,post:s,processing:n,errors:l,reset:a}=Z({folder_item_id:(e==null?void 0:e.item_id)??"",name:"",prefix:""}),{closeModal:i}=I();return{data:o,setData:r,handleSubmit:p=>{p.preventDefault(),o.folder_item_id=(e==null?void 0:e.item_id)??"",s(route("numbering-scheme.store"),{preserveScroll:!0,onSuccess:()=>{i("numberingScheme"),E.show({message:"Numbering scheme created",color:"green"})},onError:()=>{E.show({message:"Something went wrong",color:"red"})},onFinish:()=>a()})},processing:n,errors:l}}const Or=({itemParent:e})=>{const{data:o,setData:r,handleSubmit:s,processing:n,errors:l}=Ir({itemParent:e}),{modals:a,closeModal:i}=I();return t.jsx(se,{opened:a.createNumberingScheme,onClose:()=>i("createNumberingScheme"),title:t.jsx(k,{size:"lg",children:"Create Numbering Scheme"}),size:550,children:t.jsxs("form",{onSubmit:s,children:[t.jsxs(q,{gap:16,children:[t.jsx(Ge,{label:"Name",value:o.name,onChange:d=>r("name",d.target.value),error:l.name}),t.jsx(Ge,{label:"Prefix",value:o.prefix,onChange:d=>r("prefix",d.target.value),error:l.prefix})]}),t.jsxs(X,{align:"center",justify:"end",mt:16,children:[t.jsx(F,{variant:"light",onClick:()=>i("createNumberingScheme"),children:"Cancel"}),t.jsx(F,{ml:12,type:"submit",loading:n,children:"Create"})]})]})})};function Rr({itemParent:e,close:o}){const{data:r,setData:s,post:n,processing:l,errors:a,reset:i,clearErrors:d}=Z({parent_id:"",name:""}),{closeModal:p}=I();return{data:r,setData:s,submit:g=>{r.parent_id=(e==null?void 0:e.item_id)||"",g.preventDefault(),n(route("folder.create"),{preserveScroll:!0,onSuccess:()=>{E.show({message:"New folder created",color:"green"})},onError:v=>{let h="";Object.keys(v).length>0?h=v[Object.keys(v)[0]]:h="Error during file upload. Please try again later.",E.show({message:h,color:"red"})},onFinish:()=>{p("folder"),i(),d()}})},processing:l,errors:a}}const Tr=({itemParent:e})=>{const{data:o,setData:r,submit:s,processing:n,errors:l}=Rr({itemParent:e,close}),{modals:a,closeModal:i}=I();return t.jsx(se,{opened:a.folder,onClose:()=>i("folder"),title:t.jsx(k,{fw:"bold",size:"lg",children:"Create Folder"}),size:550,children:t.jsxs("form",{onSubmit:s,children:[t.jsx(q,{gap:16,children:t.jsx(Ge,{id:"name",type:"text",name:"name",value:o.name,placeholder:"Folder Name",onChange:d=>r("name",d.target.value),error:l.name})}),t.jsxs(X,{align:"center",justify:"end",mt:16,children:[t.jsx(F,{variant:"outline",onClick:()=>i("folder"),children:"Cancel"}),t.jsx(F,{ml:12,type:"submit",loading:n,children:"Create"})]})]})})};function Wr({workflowId:e,isOpen:o}){const[r,s]=u.useState(null);u.useEffect(()=>{e&&o&&n(e)},[e,o]);const n=async l=>{try{const a=await Ze.get(`/workflows/${l}`);s(a.data)}catch(a){console.error("Error fetching workflow",a)}};return r}function Lr({itemParent:e,isOpen:o}){const[r,s]=u.useState("reviewal"),n=Wr({workflowId:e==null?void 0:e.workflow_id,isOpen:o}),l=ko(r,o),{closeModal:a}=I(),{data:i,setData:d,put:p,processing:f,errors:g,reset:v,clearErrors:h}=Z({resolution:"",type:"",users:[]});u.useEffect(()=>{d({resolution:(n==null?void 0:n.resolution)||"",type:(n==null?void 0:n.type)||"",users:((n==null?void 0:n.users)||[]).map(b=>({user_id:b.id}))}),s((n==null?void 0:n.type)||"")},[n]);const y=()=>{a("updateWorkflow"),v(),h()};return{data:i,setData:d,handleUpdateWorkflow:b=>{b.preventDefault(),i.users=l.map(D=>({user_id:D.id})),p(route("workflows.update",e==null?void 0:e.workflow_id),{onSuccess:()=>{y(),E.show({message:"Workflow updated successfully",color:"green"})},onError:()=>{E.show({message:"Something went wrong",color:"red"})},onFinish:()=>v()})},processing:f,errors:g,handleClose:y,fetchedUsers:l,setWorkflowType:s,workflow:n}}function Nr({workflowId:e,onDeleteSuccess:o}){const{delete:r,processing:s}=Z();return{handleDeleteWorkflow:()=>{if(!e){E.show({message:"Workflow ID is missing.",color:"red"});return}r(route("workflows.destroy",e),{preserveScroll:!0,onSuccess:()=>{E.show({message:"Workflow deleted successfully.",color:"green"}),o()},onError:l=>{let a="Failed to delete workflow.";l&&Object.keys(l).length>0&&(a=l[Object.keys(l)[0]]),E.show({message:a,color:"red"})}})},processing:s}}const $r=({workflowId:e})=>{const{modals:o,closeModal:r,openModal:s}=I(),n=o.confirmDeleteWorkflow,{handleDeleteWorkflow:l,processing:a}=Nr({workflowId:e,onDeleteSuccess:()=>{r("confirmDeleteWorkflow"),r("updateWorkflow")}});return t.jsxs(se,{opened:n,onClose:()=>r("confirmDeleteWorkflow"),title:t.jsx(k,{fw:"bold",size:"lg",children:"Confirm Delete"}),size:"sm",centered:!0,children:[t.jsx(k,{c:"gray.8",children:"Are you sure you want to delete this workflow? This action cannot be undone."}),t.jsxs(X,{align:"center",justify:"flex-end",mt:16,children:[t.jsx(F,{variant:"light",onClick:()=>{r("confirmDeleteWorkflow"),s("updateWorkflow")},children:"Cancel"}),t.jsx(F,{color:"red",ml:12,onClick:l,loading:a,children:"Delete"})]})]})},Pr=({itemParent:e})=>{const{modals:o,closeModal:r,openModal:s}=I(),n=o.updateWorkflow,{data:l,setData:a,handleUpdateWorkflow:i,processing:d,fetchedUsers:p,setWorkflowType:f,errors:g}=Lr({itemParent:e,isOpen:n});return t.jsxs(t.Fragment,{children:[t.jsx(se,{opened:n,onClose:()=>r("updateWorkflow"),title:t.jsx(k,{fw:"bold",size:"lg",children:"Update Workflow Process"}),size:550,children:t.jsxs("form",{onSubmit:i,children:[t.jsxs(q,{gap:16,children:[t.jsx(k,{size:"sm",c:"dimmed",children:"Routinely directs any uploaded file in this folder through a predefined approval workflow"}),t.jsx(me.Group,{name:"status",value:l.type,onChange:v=>{a("type",v),f(v)},children:t.jsxs(T,{mt:"xs",children:[t.jsx(me,{value:"reviewal",label:"Review"}),t.jsx(me,{value:"approval",label:"Approval"})]})}),t.jsx(Co,{label:"Resolution",placeholder:"Your resolution for this approval",value:l.resolution??"",onChange:v=>a("resolution",v.target.value),error:g.resolution,autosize:!0,minRows:2,maxRows:4}),t.jsx(k,{size:"sm",fw:500,mb:-8,children:"Users in this workflow"}),p.map(v=>t.jsx(bo,{withBorder:!0,radius:"md",py:16,px:10,children:t.jsxs(T,{children:[t.jsx(Do,{}),t.jsxs(q,{gap:8,children:[t.jsx(k,{size:"sm",children:v.name}),t.jsx(k,{size:"sm",children:v.email})]})]})},v.id))]}),t.jsxs(X,{align:"center",justify:"end",mt:16,children:[t.jsx(F,{variant:"light",onClick:()=>r("updateWorkflow"),children:"Cancel"}),t.jsx(F,{ml:12,type:"submit",loading:d,children:"Update"}),t.jsx(N,{variant:"transparent",color:"red",onClick:()=>{s("confirmDeleteWorkflow"),r("updateWorkflow")},title:"Delete Workflow",ml:12,children:t.jsx(Qe,{size:18})})]})]})}),t.jsx($r,{workflowId:e==null?void 0:e.workflow_id})]})},Ur=({uploadFileRef:e,itemParent:o})=>{var n;const{openModal:r}=I(),{generateReport:s}=pt();return t.jsxs(T,{h:"50%",px:32,align:"center",justify:"space-between",children:[t.jsxs(T,{gap:"xs",children:[t.jsxs(fe,{shadow:"md",width:220,transitionProps:{transition:"pop-top-left"},position:"bottom-start",children:[t.jsx(fe.Target,{children:t.jsx(F,{variant:"subtle",color:"dark.3",leftSection:t.jsx(wo,{size:18}),rightSection:t.jsx(He,{size:12}),children:"New"})}),t.jsxs(fe.Dropdown,{children:[t.jsx(fe.Item,{leftSection:t.jsx(zt,{style:{width:B(14),height:B(14)}}),onClick:()=>r("folder"),children:"New Folder"}),t.jsx(fe.Item,{leftSection:t.jsx(St,{style:{width:B(14),height:B(14)}}),onClick:()=>{var l;return(l=e==null?void 0:e.current)==null?void 0:l.call(e)},children:"Upload Files"}),t.jsx(fe.Item,{leftSection:t.jsx(It,{style:{width:B(14),height:B(14)}}),children:"Upload Folder"})]})]}),t.jsx(J,{label:"Properties",position:"bottom",withArrow:!0,children:t.jsx(N,{component:Ke,size:"lg",href:route("folder.edit",{id:o==null?void 0:o.item_id}),variant:"transparent",color:"dark.3",children:t.jsx(Ft,{size:18})})}),t.jsx(J,{label:"Workflow",position:"bottom",withArrow:!0,children:t.jsx(N,{variant:"transparent",size:"lg",color:o!=null&&o.workflow_id?"green.8":"dark.3",onClick:()=>r(o!=null&&o.workflow_id?"updateWorkflow":"createWorkflow"),children:t.jsx(dt,{size:18})})}),t.jsx(J,{label:"Metadata",position:"bottom",withArrow:!0,children:t.jsx(N,{component:Ke,size:"lg",href:route("folder.showRequiredMetadata",{id:o==null?void 0:o.item_id}),variant:"transparent",color:(n=o==null?void 0:o.required_metadata)!=null&&n.length?"green.8":"dark.3",children:t.jsx(tt,{size:18})})}),t.jsx(J,{label:"Activity",position:"bottom",withArrow:!0,children:t.jsx(N,{component:Ke,size:"lg",href:route("folder.activity-log",{id:o==null?void 0:o.item_id}),variant:"transparent",color:"dark.3",children:t.jsx(_t,{size:18})})}),t.jsx(J,{label:"Numbering",position:"bottom",withArrow:!0,children:t.jsx(N,{size:"lg",variant:"transparent",color:o!=null&&o.numbering_scheme_id?"green.8":"dark.3",onClick:()=>r(o!=null&&o.numbering_scheme_id?"updateNumberingScheme":"createNumberingScheme"),children:t.jsx(Ot,{size:18})})}),t.jsx(J,{label:"Column",position:"bottom",withArrow:!0,children:t.jsx(N,{variant:"transparent",color:"dark.3",size:"lg",onClick:()=>r("selectMetadataColumns"),children:t.jsx(Tt,{size:18})})}),t.jsx(J,{label:"Report",position:"bottom",withArrow:!0,children:t.jsx(N,{variant:"transparent",color:"dark.3",size:"lg",onClick:()=>s((o==null?void 0:o.item_id)??""),children:t.jsx(Mt,{size:18})})})]}),t.jsxs(T,{gap:"xs",children:[t.jsx(J,{label:"Sort",position:"bottom",withArrow:!0,children:t.jsxs(N,{variant:"transparent",color:"dark.3",size:"lg",children:[t.jsx(Rt,{size:18}),t.jsx(He,{size:12,style:{marginLeft:B(4)}})]})}),t.jsx(J,{label:"View",position:"bottom",withArrow:!0,children:t.jsxs(N,{variant:"transparent",color:"dark.3",size:"lg",children:[t.jsx(it,{size:18}),t.jsx(He,{size:12,style:{marginLeft:B(4)}})]})})]}),t.jsx(Tr,{itemParent:o}),t.jsx(Ar,{itemParent:o}),t.jsx(Pr,{itemParent:o}),t.jsx(Or,{itemParent:o}),t.jsx(ut,{itemParent:o})]})};function Br(e){return fetch(e,{headers:{"Content-Type":"application/json",Accept:"application/json"}}).then(o=>o.json())}function Kr(){return{downloadFiles:({all:o,ids:r,parentId:s})=>{if(!o&&(r==null?void 0:r.length)===0)return;const n=new URLSearchParams;s&&n.append("parent_id",String(s)),o?n.append("all",o?"1":"0"):r==null||r.forEach(a=>n.append("ids[]",a));const l=route("item.download");Br(`${l}?${n.toString()}`).then(a=>{if(!a.url)return;const i=document.createElement("a");i.download=a.filename,i.href=a.url,i.click()})}}}function Hr({setSelectedRecord:e}){const{data:o,delete:r,processing:s}=Z({ids:[]}),{closeModal:n}=I();return{handleDelete:a=>{o.ids=a,r(route("item.delete"),{onSuccess:()=>{n("deleteFiles"),setTimeout(()=>{e([])},100),E.show({message:"Files deleted",color:"green"})},onError:i=>{let d="Error during file deletion. Please try again later.";Object.keys(i).length>0&&(d=i[Object.keys(i)[0]]),E.show({message:d,color:"red"})}})},processing:s}}const Gr=({selectedIds:e,setSelectedRecord:o})=>{const{handleDelete:r,processing:s}=Hr({setSelectedRecord:o}),{modals:n,closeModal:l}=I();return t.jsx(se,{opened:n.deleteFiles,onClose:()=>l("deleteFiles"),title:t.jsx(k,{fw:"bold",size:"lg",children:"Delete Files"}),size:550,children:t.jsxs("form",{onSubmit:a=>{a.preventDefault(),r(e)},children:[t.jsx(k,{c:"dimmed",children:"Delete selected files?"}),t.jsxs(X,{align:"center",justify:"end",mt:16,children:[t.jsx(F,{variant:"subtle",onClick:()=>l("deleteFiles"),color:"gray",children:"Cancel"}),t.jsx(F,{ml:12,type:"submit",loading:s,color:"red",children:"Delete"})]})]})})};function Yr(e,o){const[r,s]=u.useState({itemParent:null,itemAncestors:null,itemContents:[]}),[n,l]=u.useState(!1),[a,i]=u.useState(null);u.useEffect(()=>{o&&d(e)},[e,o]);const d=async p=>{l(!0),i(null);try{const f=await Ze.get(route("item.showItems",{item:p}));s(f.data)}catch(f){i("Failed to fetch items."),console.error(f)}finally{l(!1)}};return{data:r,loading:n,error:a}}function qr({setSelectedRecord:e}){const{data:o,setData:r,put:s,processing:n,errors:l,reset:a,clearErrors:i}=Z({ids:[],destination_folder_id:""});return{data:o,setData:r,moveDocuments:()=>{s(route("document.move"),{onSuccess:()=>{e([]),E.show({message:"Documents moved successfully",color:"green"}),a()},onError:p=>{E.show({message:"Failed to move documents",color:"red"})},onFinish:()=>{i()}})},processing:n,errors:l,reset:a}}const Vr=({selectedDocumentIds:e,setSelectedRecord:o})=>{const{modals:r,closeModal:s}=I(),n=r.moveModal,[l,a]=u.useState(null),{data:i,loading:d,error:p}=Yr(l,n),{data:f,setData:g,moveDocuments:v,processing:h}=qr({setSelectedRecord:o}),y=D=>{a(D)},C=()=>{i.itemParent&&i.itemParent.parent_id?a(i.itemParent.parent_id):a(null)},b=()=>{if(!l){E.show({message:"Please select a destination folder.",color:"red"});return}f.ids=e,f.destination_folder_id=l,v(),s("moveModal")};return t.jsx(se,{opened:n,onClose:()=>s("moveModal"),title:"Move Documents",size:"lg",children:t.jsxs(q,{gap:"md",children:[t.jsxs(T,{children:[l&&t.jsx(N,{onClick:C,children:t.jsx(Et,{size:16})}),t.jsx(k,{children:"Choose Destination Folder"})]}),d?t.jsx(k,{children:"Loading..."}):p?t.jsx(k,{c:"red",children:p}):t.jsx(q,{gap:"sm",style:{maxHeight:400,overflowY:"auto"},children:i.itemContents.map(D=>t.jsxs(T,{gap:"sm",style:{cursor:"pointer"},onDoubleClick:()=>y(D.item_id),children:[t.jsx(ft,{}),t.jsx(k,{children:D.name})]},D.item_id))}),t.jsxs(T,{justify:"flex-end",mt:"md",children:[t.jsx(F,{variant:"outline",onClick:()=>s("moveModal"),children:"Cancel"}),t.jsx(F,{onClick:b,disabled:!l||h,loading:h,children:"Move Here"})]})]})})},Jr=({setSelectedRecord:e,selectedIds:o,parentId:r})=>{const{downloadFiles:s}=Kr(),{openModal:n}=I();return t.jsxs(T,{h:"50%",px:"md",align:"center",justify:"flex-start",children:[t.jsx(F,{onClick:()=>n("deleteFiles"),variant:"subtle",color:"dark.3",leftSection:t.jsx(Qe,{size:18}),children:"Delete"}),t.jsx(F,{onClick:()=>s({all:!1,ids:o,parentId:r}),variant:"subtle",color:"dark.3",leftSection:t.jsx(mt,{size:18}),children:"Download"}),t.jsx(F,{onClick:()=>n("moveModal"),variant:"subtle",color:"dark.3",leftSection:t.jsx(At,{size:18}),children:"Move"}),t.jsx(Gr,{selectedIds:o,setSelectedRecord:e}),t.jsx(Vr,{selectedDocumentIds:o,setSelectedRecord:e})]})};function Xr(e){const{data:o,post:r,reset:s,clearErrors:n}=Z({parent_id:"",files:[]});return{uploadFiles:a=>{o.parent_id=e.item_id,o.files=a.map(i=>({file:i})),r(route("document.store"),{onSuccess:()=>{E.show({message:"Document uploaded",color:"green"})},onError:i=>{let d="";Object.keys(i).length>0?d=i[Object.keys(i)[0]]:d="Error during file upload. Please try again later.",E.show({message:d,color:"red"})},onFinish:()=>{s(),n()}})}}}function Zr(){const[e,o]=u.useState([]),s=(n=>n.map(l=>l.id))(e);return{selectedRecord:e,setSelectedRecord:o,ids:s}}function Qr(){return{openFolder:(o,r)=>{o==="folder"&&Qo.visit(route("folder.show",{id:r}))}}}function es({folderId:e,isOpen:o}){const[r,s]=u.useState([]),[n,l]=u.useState(!1),[a,i]=u.useState(null);return u.useEffect(()=>{e&&o&&(async()=>{l(!0);try{const p=await Ze.get(`/folder/${e}/metadata_columns`);s(p.data.metadata_columns),i(null)}catch(p){i("Failed to fetch existing metadata columns."),console.error(p)}finally{l(!1)}})()},[e,o]),{existingMetadataColumns:r,loading:n,error:a}}const os=({folderId:e})=>{const{modals:o,closeModal:r}=I(),s=o.selectMetadataColumns,{metadataList:n}=gt(),{existingMetadataColumns:l,loading:a,error:i}=es({folderId:e,isOpen:s}),{data:d,setData:p,post:f,processing:g,errors:v,reset:h}=Z({metadata_columns:[{id:Date.now(),value:""}],metadata_ids:[]});u.useEffect(()=>{if(l.length>0){const w=l.map(x=>({id:x.metadata_id,value:x.metadata_id.toString()}));p("metadata_columns",w)}},[l]),u.useEffect(()=>{const w=d.metadata_columns.map(x=>parseInt(x.value)).filter(x=>!isNaN(x));p("metadata_ids",w)},[d.metadata_columns]);const y=()=>{p("metadata_columns",[...d.metadata_columns,{id:Date.now(),value:""}])},C=w=>{p("metadata_columns",d.metadata_columns.filter(x=>x.id!==w))},b=(w,x)=>{const W=d.metadata_columns.map(P=>P.id===w?{...P,value:x}:P);p("metadata_columns",W)},D=w=>{w.preventDefault(),d.metadata_columns.map(x=>parseInt(x.value)).filter(x=>!isNaN(x)),f(route("folder.selectMetadataColumn",e),{preserveScroll:!0,onSuccess:()=>{r("selectMetadataColumns"),E.show({title:"Success",message:"Metadata columns selected successfully",color:"green"}),h()},onError:()=>{E.show({title:"Error",message:"Failed to select metadata columns",color:"red"})}})};return t.jsx(se,{opened:s,onClose:()=>{r("selectMetadataColumns"),h()},title:t.jsx(k,{fw:"bold",size:"lg",children:"Select Metadata Columns"}),size:550,children:a?t.jsx(X,{justify:"center",align:"center",h:"100%",children:t.jsx(xo,{})}):i?t.jsx(vt,{icon:t.jsx(yt,{size:16}),title:"Error",color:"red",children:i}):t.jsxs("form",{onSubmit:D,children:[t.jsxs(q,{gap:16,children:[t.jsx(k,{c:"dimmed",children:"Select the metadata columns you want to display"}),d.metadata_columns.map(w=>t.jsxs(T,{justify:"space-between",align:"flex-end",children:[t.jsx(xt,{placeholder:"Pick a metadata column",data:n.map(x=>({value:x.metadata_id.toString(),label:x.name})),value:w.value,onChange:x=>b(w.id,x||""),w:"90%",required:!0}),d.metadata_columns.length>1&&t.jsx(N,{color:"red",variant:"subtle",onClick:()=>C(w.id),children:t.jsx(Qe,{size:18})})]},w.id)),t.jsx(X,{justify:"flex-start",children:t.jsx(F,{variant:"subtle",color:"blue.5",leftSection:t.jsx(wo,{size:18}),onClick:y,children:"Add New Column"})})]}),t.jsxs(X,{align:"center",justify:"end",mt:16,children:[t.jsx(F,{variant:"outline",onClick:()=>{r("selectMetadataColumns"),h()},children:"Cancel"}),t.jsx(F,{ml:12,type:"submit",loading:g,children:"Save"})]})]})})};function Os({itemParent:e,itemAncestors:o,itemContents:r}){var v;const s=u.useRef(null),{uploadFiles:n}=Xr(e),{selectedRecord:l,setSelectedRecord:a,ids:i}=Zr(),{openFolder:d}=Qr(),{openDocument:p}=ht(),f=(v=e.metadata_columns)==null?void 0:v.map(h=>({accessor:`metadata_${h.metadata_id}`,title:h.name,render:y=>{var b;const C=(b=y.metadata)==null?void 0:b.find(D=>D.metadata_id===h.metadata_id);return C?C.value:null}})),g=[{accessor:"name",render:({mime:h,type:y,name:C,status:b,missing_required_metadata:D})=>t.jsxs(T,{align:"center",gap:12,children:[t.jsx(rt,{mime:h??"",isFolder:y==="folder",approvalStatus:b,missingRequiredMetadata:D}),t.jsx("span",{children:C})]})},{accessor:"updated_at",title:"Last Modified"},...f??[]];return t.jsxs(t.Fragment,{children:[t.jsx(et,{title:"My Files"}),t.jsx(st,{toolbar:l.length>0?t.jsx(Jr,{setSelectedRecord:a,selectedIds:i,parentId:e.item_id}):t.jsx(Ur,{itemParent:e,uploadFileRef:s}),children:t.jsx(Mr,{onDrop:n,openRef:s,children:t.jsxs(q,{px:8,gap:24,py:8,style:{pointerEvents:"all"},children:[t.jsx(nt,{ancestors:o}),r.length?t.jsx(ot,{textSelectionDisabled:!0,columns:g,records:r,customRowAttributes:({type:h,id:y})=>({onDoubleClick:C=>{C.button===0&&(h==="folder"?d(h,y):h==="document"&&p(y))}}),highlightOnHover:!0,verticalSpacing:"lg",horizontalSpacing:"xl",selectedRecords:l,onSelectedRecordsChange:a}):t.jsx(k,{size:"lg",c:"gray.5",children:"This folder is empty"})]})})}),t.jsx(os,{folderId:e.item_id})]})}export{Os as default};
