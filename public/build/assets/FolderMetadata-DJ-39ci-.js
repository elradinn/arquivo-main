import{b as j,j as e,M as S,W as y,n as x,Y as q}from"./app-DNXyikm8.js";import{Y as C}from"./index-D4aXydll.js";import{u as R,A as D,d as v,b,c as k}from"./Authenticated-n-UZ9Wg0.js";import{u as A}from"./use-fetch-metadata-fV119OFu.js";import{u as w,C as u}from"./Combobox-CeAKxMF7.js";import{S as M}from"./Stack-_ZpdIiGj.js";import{I}from"./InputBase-DdQXy5fn.js";import{G as g}from"./Avatar-BIPOllA1.js";import{B as p}from"./Button-8JzPEOnx.js";import{T as f}from"./Text-B_iPcdW5.js";import{c as _}from"./createReactComponent-DkXyC2OJ.js";import"./Checkbox-51tbpKaj.js";import"./IconUser-Bo1Uf62S.js";import"./use-uncontrolled-B5y4jCOb.js";import"./CheckIcon-DZcSLzru.js";import"./Popover-CLW93gnI.js";import"./ScrollArea-9rvj9n81.js";import"./Flex-BuuFm4Ek.js";import"./OfficeLogo-DI0023WY.js";import"./TextInput-CpkAnPyM.js";import"./get-sorted-breakpoints-DCnJzV-p.js";/**
 * @license @tabler/icons-react v3.11.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var T=_("outline","tags-off","IconTagsOff",[["path",{d:"M16.296 12.296l-5.71 -5.71",key:"svg-0"}],["path",{d:"M6 6h-1a2 2 0 0 0 -2 2v4.172a2 2 0 0 0 .586 1.414l5.71 5.71a2.41 2.41 0 0 0 3.408 0l3.278 -3.278",key:"svg-1"}],["path",{d:"M18 19l.496 -.496",key:"svg-2"}],["path",{d:"M20.384 16.367a4.822 4.822 0 0 0 -.792 -5.775l-4.592 -4.592",key:"svg-3"}],["path",{d:"M7 10h-.01",key:"svg-4"}],["path",{d:"M3 3l18 18",key:"svg-5"}]]);const O=({folderId:r,onAdd:a})=>{var c;const{modals:i,closeModal:s}=R(),[t,o]=j.useState(null),{metadataList:d}=A(),n=w({onDropdownClose:()=>n.resetSelectedOption()}),h=()=>{t&&(a(t),s("addRequiredMetadata"),o(null))},m=d.map(l=>e.jsx(u.Option,{value:l.metadata_id.toString(),children:l.name},l.metadata_id));return e.jsx(S,{opened:i.addRequiredMetadata,onClose:()=>s("addRequiredMetadata"),title:"Add Required Metadata",children:e.jsxs(M,{gap:16,children:[e.jsxs(u,{store:n,onOptionSubmit:l=>{o(parseInt(l)),n.closeDropdown()},children:[e.jsx(u.Target,{children:e.jsx(I,{component:"button",type:"button",pointer:!0,rightSection:e.jsx(u.Chevron,{}),rightSectionPointerEvents:"none",onClick:()=>n.toggleDropdown(),children:t?(c=d.find(l=>l.metadata_id===t))==null?void 0:c.name:"Select Metadata"})}),e.jsx(u.Dropdown,{children:e.jsx(u.Options,{children:m})})]}),e.jsxs(g,{justify:"flex-end",children:[e.jsx(p,{variant:"outline",onClick:()=>s("addRequiredMetadata"),children:"Cancel"}),e.jsx(p,{onClick:h,disabled:!t,children:"Add"})]})]})})};function z({folderId:r,close:a}){const{data:i,setData:s,post:t,processing:o,errors:d,reset:n}=y({metadata_id:0});return{handleAddMetadata:m=>{i.metadata_id=m,t(route("folder.updateRequiredMetadata",r),{onSuccess:()=>{a(),x.show({message:"Metadata added successfully",color:"green"})},onError:()=>{x.show({message:"Something went wrong",color:"red"})},onFinish:()=>n()})},processing:o,errors:d}}function E({folderId:r,metadataId:a,onDeleteSuccess:i}){const{delete:s,processing:t}=y();return{handleDelete:()=>{s(route("folder.deleteRequiredMetadata",{folder:r,metadata:a}),{onSuccess:()=>{x.show({message:"Required Metadata deleted successfully.",color:"green"}),i()},onError:()=>{x.show({message:"Failed to delete Required Metadata.",color:"red"})}})},processing:t}}function de({requiredMetadata:r,folder:a}){const{openModal:i,closeModal:s}=R(),{handleAddMetadata:t}=z({folderId:a.item_id,close:()=>s("addRequiredMetadata")}),[o,d]=j.useState(null),{handleDelete:n,processing:h}=E({folderId:a.item_id,metadataId:o||0,onDeleteSuccess:()=>{d(null)}}),m=c=>{d(c)};return console.log(o),e.jsxs(D,{children:[e.jsx(q,{title:"Required Metadata"}),e.jsxs(M,{gap:24,p:8,children:[e.jsxs(g,{justify:"space-between",children:[e.jsxs(f,{component:"h2",size:"xl",fw:600,c:"gray.8",children:["Required Metadata for ",a.name]}),e.jsx(p,{leftSection:e.jsx(v,{size:16}),onClick:()=>i("addRequiredMetadata"),children:"Add Required Metadata"})]}),r.length>0?e.jsx(C,{columns:[{accessor:"name",title:"Name"},{accessor:"description",title:"Description"},{accessor:"actions",title:"Actions",render:c=>e.jsx(g,{gap:"xs",children:e.jsx(b,{color:"red",onClick:()=>m(c.metadata_id),children:e.jsx(k,{size:16})})})}],textSelectionDisabled:!0,records:r,highlightOnHover:!0,verticalSpacing:"lg",horizontalSpacing:"xl"}):e.jsxs(M,{align:"center",justify:"center",h:"100%",children:[e.jsx(T,{size:128,color:"gray",stroke:1}),e.jsx(f,{size:"lg",c:"gray.6",mt:"md",children:"No required metadata available."})]}),e.jsx(O,{folderId:a.item_id,onAdd:t}),e.jsxs(S,{opened:o!==null,onClose:()=>d(null),title:"Confirm Deletion",children:[e.jsx(f,{children:"Are you sure you want to delete this required metadata?"}),e.jsxs(g,{justify:"right",mt:"md",children:[e.jsx(p,{variant:"outline",onClick:()=>d(null),children:"Cancel"}),e.jsx(p,{color:"red",onClick:n,loading:h,children:"Delete"})]})]})]})]})}export{de as default};
