import{W as P,n as w,b as g,j as e,M as I,Y as T,y as k}from"./app-DHbb7XZB.js";import{Y as A}from"./index-D_XodZT9.js";import{u as y,A as E}from"./Authenticated-DWZpg9um.js";import{u as F,a as O}from"./use-search-datatable-7C-ocSzd.js";import{I as G,u as z}from"./use-generate-report-BMJ0bl2t.js";import{S as v}from"./Stack-BnRli6BO.js";import{T as C,F as B}from"./OfficeLogo-C6ryGmry.js";import{C as Y}from"./Checkbox-DhvQdy4I.js";import{G as x}from"./NotificationMenu-DLxJWaSh.js";import{B as f}from"./Button-De38AkdO.js";import{I as q}from"./ItemIcon-4kkIs55P.js";import{S as H}from"./StateBadge-DHgAzsxj.js";import{S as L}from"./Select-De12jFwc.js";import{D as N}from"./DatePickerInput-CKZUkAqb.js";import{I as V}from"./IconDownload-CNXXB5sP.js";import"./Popover-DHSW6Xue.js";import"./use-uncontrolled-B1gi51Y9.js";import"./IconUser-CvGZT8Us.js";import"./ScrollArea-C3btK3uF.js";import"./TextInput-B2cdI1__.js";import"./InputBase-C-93sqIY.js";import"./get-sorted-breakpoints-BYD2hfL9.js";import"./CheckIcon-fVhk7RRX.js";import"./get-color-status-DWf4oBUm.js";import"./IconPhoto-B_eesrcM.js";import"./Badge-By5z6ASX.js";import"./Combobox-Dmw127jY.js";function W({folderId:n,closeModal:r}){const{data:l,setData:c,post:d,processing:o,errors:i,reset:a}=P({metadata_ids:[]});return{data:l,setData:c,handleSubmit:()=>{d(route("dashboard.selectMetadataColumn",n),{onSuccess:()=>{w.show({title:"Success",message:"Metadata columns updated successfully",color:"green"}),r(),a()},onError:()=>{w.show({title:"Error",message:"Failed to update metadata columns",color:"red"})}})},processing:o,errors:i}}const $=({folderId:n,availableMetadata:r,existingMetadataIds:l})=>{const{modals:c,closeModal:d}=y(),o=c.selectDashboardMetadataColumns,{data:i,setData:a,handleSubmit:m,processing:j,errors:S}=W({folderId:n,closeModal:()=>d("selectDashboardMetadataColumns")});g.useEffect(()=>{a("metadata_ids",l)},[l]);const D=s=>{const p=i.metadata_ids;p.includes(s)?a("metadata_ids",p.filter(b=>b!==s)):a("metadata_ids",[...p,s])};return e.jsx(I,{opened:o,onClose:()=>d("selectDashboardMetadataColumns"),title:"Select Metadata Columns",children:e.jsx("form",{onSubmit:s=>{s.preventDefault(),m()},children:e.jsxs(v,{children:[e.jsx(C,{children:"Select the metadata columns you want to display in the dashboard report:"}),r.map(s=>e.jsx(Y,{label:s.name,checked:i.metadata_ids.includes(s.id),onChange:()=>D(s.id)},s.id)),S.metadata_ids&&e.jsx(C,{c:"red",children:S.metadata_ids}),e.jsxs(x,{gap:"md",mt:"md",children:[e.jsx(f,{variant:"outline",onClick:()=>d("selectDashboardMetadataColumns"),children:"Cancel"}),e.jsx(f,{type:"submit",loading:j,children:"Save"})]})]})})})};function _e({documents:n,filters:r,selectedMetadata:l,availableMetadata:c,existingMetadataIds:d}){const[o,i]=g.useState(r.document_status),[a,m]=g.useState([r.start_date?new Date(r.start_date):null,r.end_date?new Date(r.end_date):null]);F("","/dashboard/reports");const{page:j,setPage:S,handlePageChange:D}=O(n.current_page),{generateDashboardReport:s}=z(),{openModal:p}=y(),b=()=>{const t={};o&&(t.document_status=o),a[0]&&a[1]&&(t.start_date=a[0].toISOString().split("T")[0],t.end_date=a[1].toISOString().split("T")[0]),k.get("/dashboard/reports",t,{replace:!0,preserveState:!0})};g.useEffect(()=>{b()},[o,a]);const R=()=>{const t={document_status:o,start_date:a[0]?a[0].toISOString().split("T")[0]:null,end_date:a[1]?a[1].toISOString().split("T")[0]:null,metadata_ids:d};s(t)};return e.jsxs(E,{children:[e.jsx(T,{title:"Dashboard Report"}),e.jsxs(v,{px:8,gap:24,py:8,children:[e.jsx(x,{children:e.jsx(C,{component:"h2",size:"xl",fw:600,c:"gray.8",children:"Dashboard Report"})}),e.jsxs(v,{children:[e.jsxs(x,{justify:"space-between",children:[e.jsxs(B,{gap:"md",justify:"flex-start",align:"flex-end",direction:"row",wrap:"wrap",children:[e.jsx(L,{placeholder:"Select document status",value:o,onChange:i,data:[{value:"reviewal_accepted",label:"Review Accepted"},{value:"reviewal_rejected",label:"Review Rejected"},{value:"reviewal_pending",label:"Review Pending"},{value:"approval_accepted",label:"Approval Accepted"},{value:"approval_rejected",label:"Approval Rejected"},{value:"approval_pending",label:"Approval Pending"}],style:{width:200}}),e.jsx(N,{type:"range",placeholder:"Select date range",value:a,onChange:m,style:{width:300}}),e.jsx(f,{onClick:()=>p("selectDashboardMetadataColumns"),leftSection:e.jsx(G,{size:16}),variant:"subtle",color:"gray",children:"Columns"})]}),e.jsx(f,{onClick:R,leftSection:e.jsx(V,{size:16}),color:"green",children:"Generate Report"})]}),e.jsx($,{folderId:"your-folder-item-id",availableMetadata:c,existingMetadataIds:d}),e.jsx(A,{columns:[{accessor:"name",render:({mime:t,type:_,name:u,missing_required_metadata:h})=>e.jsxs(x,{align:"center",gap:12,children:[e.jsx(q,{mime:t??"",isFolder:_==="folder",missingRequiredMetadata:h}),e.jsx("span",{children:u})]})},{accessor:"updated_at",title:"Last Modified"},{accessor:"status",render:({status:t})=>e.jsx(H,{state:t})},...l.map(t=>({accessor:`metadata_${t.metadata_id}`,title:t.name,render:_=>{var h;const u=(h=_.metadata)==null?void 0:h.find(M=>M.metadata_id===t.metadata_id);return u?u.value:"N/A"}}))],records:n.data,totalRecords:n.total,recordsPerPage:n.per_page,page:j,onPageChange:()=>{},highlightOnHover:!0,verticalSpacing:"lg",horizontalSpacing:"xl"})]})]})]})}export{_e as default};
