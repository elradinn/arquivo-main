import{W as f,n as h,j as e,M as w,B as O,b as U,Y as B,r as C}from"./app-BdnCQMoe.js";import{a as q,A as N,I as W,b as Y}from"./Authenticated-DH2cwoVh.js";import{T as g}from"./Text-B1KWDhCO.js";import{S as b}from"./Stack-DTzhMRPj.js";import{T as p}from"./TextInput-B5mc4Cd-.js";import{F as x}from"./OfficeLogo-C-QaVwdo.js";import{B as m}from"./Button-CqGaw41V.js";import{Y as G}from"./index-DtTnDeLb.js";import{G as M,A as v,u as j}from"./NotificationMenu-zO2EsVKT.js";import{I as H}from"./IconEdit-_5dxq8gH.js";import{u as L,a as J}from"./use-search-datatable-B30vNIXT.js";import"./IconUser-BZcs3Nkz.js";import"./Popover-N4Nux1XS.js";import"./use-uncontrolled-Dhv18aeG.js";import"./get-sorted-breakpoints-CxWlsomb.js";import"./InputBase-CSJvsNpD.js";import"./Checkbox-Ciq8ToDf.js";import"./CheckIcon-Dt_iJxQy.js";import"./ScrollArea-BOCx1bjH.js";function K(){const{data:s,setData:t,post:r,processing:o,errors:a,reset:l}=f({name:"",email:"",password:"",password_confirmation:""});return{data:s,setData:t,submit:c=>{c.preventDefault(),r(route("user.store"),{onSuccess:()=>{h.show({message:"New user added successfully",color:"green"}),l()},onError:()=>{h.show({message:"Failed to add user",color:"red"})}})},processing:o,errors:a}}const Q=({isOpened:s,close:t})=>{const{data:r,setData:o,submit:a,processing:l,errors:n}=K(),c=()=>{t()};return e.jsx(w,{opened:s,onClose:c,title:e.jsx(g,{size:"lg",children:"Add User"}),size:550,children:e.jsxs("form",{onSubmit:a,children:[e.jsxs(b,{gap:16,children:[e.jsx(p,{id:"name",type:"text",name:"name",value:r.name,label:"Name",onChange:i=>o("name",i.target.value),error:n.name,required:!0}),e.jsx(p,{id:"email",type:"email",name:"email",value:r.email,label:"Email",onChange:i=>o("email",i.target.value),error:n.email,required:!0}),e.jsx(p,{id:"password",type:"password",name:"password",value:r.password,label:"Password",onChange:i=>o("password",i.target.value),error:n.password,required:!0}),e.jsx(p,{id:"password_confirmation",type:"password",name:"password_confirmation",value:r.password_confirmation,label:"Confirm Password",onChange:i=>o("password_confirmation",i.target.value),error:n.password_confirmation,required:!0})]}),e.jsxs(x,{align:"center",justify:"end",mt:16,children:[e.jsx(m,{variant:"outline",onClick:c,children:"Cancel"}),e.jsx(m,{ml:12,type:"submit",loading:l,children:"Save"})]})]})})};function V({user:s,close:t}){const{data:r,setData:o,patch:a,processing:l,errors:n,reset:c}=f({name:(s==null?void 0:s.name)||""});return{data:r,setData:o,submit:u=>{u.preventDefault(),s&&a(route("user.update",s.id),{onSuccess:()=>{h.show({message:"User updated successfully",color:"green"}),t(),c()},onError:()=>{h.show({message:"Failed to update user",color:"red"})}})},processing:l,errors:n}}const X=({isOpened:s,close:t,user:r})=>{const{data:o,setData:a,submit:l,processing:n,errors:c}=V({user:r,close:t});return e.jsx(w,{opened:s,onClose:t,title:e.jsx(g,{size:"lg",children:"Edit User"}),size:550,children:e.jsxs("form",{onSubmit:l,children:[e.jsx(b,{gap:16,children:e.jsx(p,{id:"name",type:"text",name:"name",value:o.name,label:"Name",onChange:i=>a("name",i.target.value),error:c.name,required:!0})}),e.jsxs(x,{align:"center",justify:"end",mt:16,children:[e.jsx(m,{variant:"outline",onClick:t,children:"Cancel"}),e.jsx(m,{ml:12,type:"submit",loading:n,children:"Save"})]})]})})};function Z({user:s,close:t}){const{delete:r,processing:o,reset:a}=f();return{submit:n=>{n.preventDefault(),s&&r(route("user.destroy",s==null?void 0:s.id),{onSuccess:()=>{h.show({message:"User deleted successfully",color:"red"}),t(),a()},onError:()=>{h.show({message:"Failed to delete user",color:"red"})}})},processing:o}}const $=({isOpened:s,close:t,user:r})=>{const{submit:o,processing:a}=Z({user:r,close:t});return e.jsx(w,{opened:s,onClose:t,title:e.jsx(g,{size:"lg",children:"Delete User"}),size:550,children:e.jsxs("form",{onSubmit:o,children:[e.jsxs(g,{c:"dimmed",mt:4,size:"sm",children:['Are you sure you want to delete the user "',r==null?void 0:r.name,'"? This action cannot be undone.']}),e.jsxs(x,{align:"center",justify:"end",mt:16,children:[e.jsx(m,{variant:"outline",onClick:t,children:"Cancel"}),e.jsx(m,{ml:12,type:"submit",loading:a,color:"red",children:"Confirm Delete"})]})]})})},ee=({users:s,total:t,perPage:r,page:o,onPageChange:a,onEdit:l,onDelete:n,selectedRecords:c,onSelectedRecordsChange:i})=>e.jsx(G,{pinLastColumn:!0,withTableBorder:!0,shadow:"xs",borderRadius:"sm",withRowBorders:!1,highlightOnHover:!0,verticalSpacing:"lg",totalRecords:t,recordsPerPage:r,page:o,onPageChange:a,columns:[{accessor:"name",noWrap:!0},{accessor:"email",noWrap:!0},{accessor:"workflow_role",title:"Workflow Role"},{accessor:"actions",title:e.jsx(O,{mr:6,children:"Actions"}),textAlign:"right",render:u=>e.jsxs(M,{gap:8,justify:"right",wrap:"nowrap",children:[e.jsx(v,{size:"sm",variant:"subtle",color:"gray",onClick:()=>l(u),children:e.jsx(H,{size:20})}),e.jsx(v,{size:"sm",variant:"subtle",color:"red",onClick:()=>n(u),children:e.jsx(q,{size:20})})]})}],records:s,selectedRecords:c,onSelectedRecordsChange:i});function be({users:s,filters:t}){const[r,o]=U.useState([]),[a,l]=U.useState(),{search:n,setSearch:c,handleSearch:i}=L(t.search||"","/users"),{page:u,setPage:y,handlePageChange:S}=J(s.current_page),[D,{open:z,close:A}]=j(!1),[E,{open:k,close:P}]=j(!1),[T,{open:R,close:_}]=j(!1),F=d=>{l(d),k()},I=d=>{l(d),R()};return e.jsxs(N,{children:[e.jsx(B,{title:"User"}),e.jsxs(b,{px:8,gap:24,py:8,children:[e.jsx(g,{component:"h2",size:"xl",fw:600,c:"gray.8",children:"User"}),e.jsxs(x,{justify:"space-between",direction:{base:"column",md:"row"},gap:{base:12,md:0},children:[e.jsx(p,{w:{md:400},placeholder:"Search",leftSection:e.jsx(W,{style:{width:C(16),height:C(16)},stroke:1.5}),value:n,onChange:d=>{c(d.target.value),i(d.target.value)}}),e.jsx(m,{leftSection:e.jsx(Y,{size:14}),onClick:z,children:"Add New User"})]}),e.jsx(ee,{users:s.data,total:s.total,perPage:s.per_page,page:u,onPageChange:d=>{y(d),S(d,s.links)},onEdit:F,onDelete:I,selectedRecords:r,onSelectedRecordsChange:o})]}),e.jsx(Q,{isOpened:D,close:A}),e.jsx(X,{isOpened:E,close:P,user:a}),e.jsx($,{isOpened:T,close:_,user:a})]})}export{be as default};
