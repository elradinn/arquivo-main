import{w as yo,f as Je,u as Le,x as Bo,d as Xe,j as t,T as Ko,B as Ze,L as Ho,O as so,e as xo,i as Go,b as u,R as Yo,z as qo,A as Vo,s as Jo,g as Xo,D as Zo,r as N,W as V,n as C,M as oe,P as jo,c as Qe,a as Ke,y as Qo,Y as et}from"./app-B1t0nWF2.js";import{Y as ot}from"./index-Dt4V_hbn.js";import{a as tt,I as rt}from"./ItemIcon-DcCIk6h5.js";import{a as st,u as O,b as L,c as bo,M as pe,d as nt,T as q,e as at,A as lt}from"./Authenticated-Cn6MVLYw.js";import{I as it}from"./ItemBreadcrumbs-CjJsyex6.js";import{u as ct}from"./Popover-CNN9VJPa.js";import{I as dt,u as wo,a as ut}from"./use-fetch-users-approval-role-Dc96mWPm.js";import{T as w}from"./Text-CTq1jRaK.js";import{S as H}from"./Stack-DzZL_UtP.js";import{R as fe}from"./Radio-Ba0OcqTt.js";import{G as A,A as Do}from"./Avatar-DhTNpjzT.js";import{T as ko}from"./Textarea-Dd19YroK.js";import{F as me}from"./Flex-vxGNn1YY.js";import{B as F}from"./Button-HaXgOpsJ.js";import{U as pt}from"./UpdateNumberingSchemeForm-D1SxyrCp.js";import{T as Ye}from"./TextInput-C5DBO-eL.js";import{u as ft}from"./use-generate-report-B_JXk0vN.js";import{c as T}from"./createReactComponent-CvUE1uel.js";import{I as mt}from"./IconFolder-BBaouekg.js";import{I as ht}from"./IconDownload-Ctt3HoT8.js";import{u as gt}from"./use-document-properties-BJtjg2jU.js";import{u as vt}from"./use-fetch-metadata-ce2DZ9mk.js";import{C as He}from"./Checkbox-Bs46OKoO.js";import"./IconUser-DH80TIA7.js";import"./use-uncontrolled-DXGPZ-HS.js";import"./ScrollArea-BzIzn8kk.js";import"./get-color-status-CoUPVVuO.js";import"./IconPhoto-D8zULflZ.js";import"./OfficeLogo-CnZm09Bf.js";import"./get-sorted-breakpoints-QhZfIvBG.js";import"./Anchor-DmK4caIo.js";import"./InputBase-wHy3O5_x.js";import"./CheckIcon-CXwCS6ms.js";function no(e){return typeof e!="string"?"":e.charAt(0).toUpperCase()+e.slice(1)}var Co={root:"m_6e45937b",loader:"m_e8eb006c",overlay:"m_df587f17"};const ao={transitionProps:{transition:"fade",duration:0},overlayProps:{backgroundOpacity:.75},zIndex:yo("overlay")},yt=xo((e,{zIndex:o})=>({root:{"--lo-z-index":o==null?void 0:o.toString()}})),eo=Je((e,o)=>{const r=Le("LoadingOverlay",ao,e),{classNames:s,className:n,style:l,styles:a,unstyled:i,vars:d,transitionProps:p,loaderProps:f,overlayProps:v,visible:h,zIndex:y,...j}=r,g=Bo(),x=Xe({name:"LoadingOverlay",classes:Co,props:r,className:n,style:l,classNames:s,styles:a,unstyled:i,vars:d,varsResolver:yt}),D={...ao.overlayProps,...v};return t.jsx(Ko,{transition:"fade",...p,mounted:!!h,children:G=>t.jsxs(Ze,{...x("root",{style:G}),ref:o,...j,children:[t.jsx(Ho,{...x("loader"),unstyled:i,...f}),t.jsx(so,{...D,...x("overlay"),darkHidden:!0,unstyled:i,color:(v==null?void 0:v.color)||g.white}),t.jsx(so,{...D,...x("overlay"),lightHidden:!0,unstyled:i,color:(v==null?void 0:v.color)||g.colors.dark[5]})]})})});eo.classes=Co;eo.displayName="@mantine/core/LoadingOverlay";var Fo={exports:{}},xt="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",jt=xt,bt=jt;function _o(){}function Eo(){}Eo.resetWarningCache=_o;var wt=function(){function e(s,n,l,a,i,d){if(d!==bt){var p=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw p.name="Invariant Violation",p}}e.isRequired=e;function o(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:o,element:e,elementType:e,instanceOf:o,node:e,objectOf:o,oneOf:o,oneOfType:o,shape:o,exact:o,checkPropTypes:Eo,resetWarningCache:_o};return r.PropTypes=r,r};Fo.exports=wt();var Dt=Fo.exports;const b=Go(Dt);/**
 * @license @tabler/icons-react v3.11.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var kt=T("outline","adjustments","IconAdjustments",[["path",{d:"M4 10a2 2 0 1 0 4 0a2 2 0 0 0 -4 0",key:"svg-0"}],["path",{d:"M6 4v4",key:"svg-1"}],["path",{d:"M6 12v8",key:"svg-2"}],["path",{d:"M10 16a2 2 0 1 0 4 0a2 2 0 0 0 -4 0",key:"svg-3"}],["path",{d:"M12 4v10",key:"svg-4"}],["path",{d:"M12 18v2",key:"svg-5"}],["path",{d:"M16 7a2 2 0 1 0 4 0a2 2 0 0 0 -4 0",key:"svg-6"}],["path",{d:"M18 4v1",key:"svg-7"}],["path",{d:"M18 9v11",key:"svg-8"}]]);/**
 * @license @tabler/icons-react v3.11.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ct=T("outline","article","IconArticle",[["path",{d:"M3 4m0 2a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2z",key:"svg-0"}],["path",{d:"M7 8h10",key:"svg-1"}],["path",{d:"M7 12h10",key:"svg-2"}],["path",{d:"M7 16h10",key:"svg-3"}]]);/**
 * @license @tabler/icons-react v3.11.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ge=T("outline","chevron-down","IconChevronDown",[["path",{d:"M6 9l6 6l6 -6",key:"svg-0"}]]);/**
 * @license @tabler/icons-react v3.11.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ft=T("outline","chevron-left","IconChevronLeft",[["path",{d:"M15 6l-6 6l6 6",key:"svg-0"}]]);/**
 * @license @tabler/icons-react v3.11.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var _t=T("outline","file-isr","IconFileIsr",[["path",{d:"M15 3v4a1 1 0 0 0 1 1h4",key:"svg-0"}],["path",{d:"M15 3v4a1 1 0 0 0 1 1h4",key:"svg-1"}],["path",{d:"M6 8v-3a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2v-7",key:"svg-2"}],["path",{d:"M3 15l3 -3l3 3",key:"svg-3"}]]);/**
 * @license @tabler/icons-react v3.11.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Et=T("outline","file-report","IconFileReport",[["path",{d:"M17 17m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0",key:"svg-0"}],["path",{d:"M17 13v4h4",key:"svg-1"}],["path",{d:"M12 3v4a1 1 0 0 0 1 1h4",key:"svg-2"}],["path",{d:"M11.5 21h-6.5a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v2m0 3v4",key:"svg-3"}]]);/**
 * @license @tabler/icons-react v3.11.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var St=T("outline","folder-plus","IconFolderPlus",[["path",{d:"M12 19h-7a2 2 0 0 1 -2 -2v-11a2 2 0 0 1 2 -2h4l3 3h7a2 2 0 0 1 2 2v3.5",key:"svg-0"}],["path",{d:"M16 19h6",key:"svg-1"}],["path",{d:"M19 16v6",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.11.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Mt=T("outline","folder-symlink","IconFolderSymlink",[["path",{d:"M3 21v-4a3 3 0 0 1 3 -3h5",key:"svg-0"}],["path",{d:"M8 17l3 -3l-3 -3",key:"svg-1"}],["path",{d:"M3 11v-5a2 2 0 0 1 2 -2h4l3 3h7a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-8",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.11.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ot=T("outline","folder-up","IconFolderUp",[["path",{d:"M12 19h-7a2 2 0 0 1 -2 -2v-11a2 2 0 0 1 2 -2h4l3 3h7a2 2 0 0 1 2 2v3.5",key:"svg-0"}],["path",{d:"M19 22v-6",key:"svg-1"}],["path",{d:"M22 19l-3 -3l-3 3",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.11.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var zt=T("outline","list-tree","IconListTree",[["path",{d:"M9 6h11",key:"svg-0"}],["path",{d:"M12 12h8",key:"svg-1"}],["path",{d:"M15 18h5",key:"svg-2"}],["path",{d:"M5 6v.01",key:"svg-3"}],["path",{d:"M8 12v.01",key:"svg-4"}],["path",{d:"M11 18v.01",key:"svg-5"}]]);/**
 * @license @tabler/icons-react v3.11.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var At=T("outline","selector","IconSelector",[["path",{d:"M8 9l4 -4l4 4",key:"svg-0"}],["path",{d:"M16 15l-4 4l-4 -4",key:"svg-1"}]]);/**
 * @license @tabler/icons-react v3.11.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var It=T("outline","table","IconTable",[["path",{d:"M3 5a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v14a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2v-14z",key:"svg-0"}],["path",{d:"M3 10h18",key:"svg-1"}],["path",{d:"M10 3v18",key:"svg-2"}]]);const Rt=new Map([["aac","audio/aac"],["abw","application/x-abiword"],["arc","application/x-freearc"],["avif","image/avif"],["avi","video/x-msvideo"],["azw","application/vnd.amazon.ebook"],["bin","application/octet-stream"],["bmp","image/bmp"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["cda","application/x-cdf"],["csh","application/x-csh"],["css","text/css"],["csv","text/csv"],["doc","application/msword"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["eot","application/vnd.ms-fontobject"],["epub","application/epub+zip"],["gz","application/gzip"],["gif","image/gif"],["heic","image/heic"],["heif","image/heif"],["htm","text/html"],["html","text/html"],["ico","image/vnd.microsoft.icon"],["ics","text/calendar"],["jar","application/java-archive"],["jpeg","image/jpeg"],["jpg","image/jpeg"],["js","text/javascript"],["json","application/json"],["jsonld","application/ld+json"],["mid","audio/midi"],["midi","audio/midi"],["mjs","text/javascript"],["mp3","audio/mpeg"],["mp4","video/mp4"],["mpeg","video/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["opus","audio/opus"],["otf","font/otf"],["png","image/png"],["pdf","application/pdf"],["php","application/x-httpd-php"],["ppt","application/vnd.ms-powerpoint"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["rar","application/vnd.rar"],["rtf","application/rtf"],["sh","application/x-sh"],["svg","image/svg+xml"],["swf","application/x-shockwave-flash"],["tar","application/x-tar"],["tif","image/tiff"],["tiff","image/tiff"],["ts","video/mp2t"],["ttf","font/ttf"],["txt","text/plain"],["vsd","application/vnd.visio"],["wav","audio/wav"],["weba","audio/webm"],["webm","video/webm"],["webp","image/webp"],["woff","font/woff"],["woff2","font/woff2"],["xhtml","application/xhtml+xml"],["xls","application/vnd.ms-excel"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xml","application/xml"],["xul","application/vnd.mozilla.xul+xml"],["zip","application/zip"],["7z","application/x-7z-compressed"],["mkv","video/x-matroska"],["mov","video/quicktime"],["msg","application/vnd.ms-outlook"]]);function ke(e,o){const r=Tt(e);if(typeof r.path!="string"){const{webkitRelativePath:s}=e;Object.defineProperty(r,"path",{value:typeof o=="string"?o:typeof s=="string"&&s.length>0?s:e.name,writable:!1,configurable:!1,enumerable:!0})}return r}function Tt(e){const{name:o}=e;if(o&&o.lastIndexOf(".")!==-1&&!e.type){const s=o.split(".").pop().toLowerCase(),n=Rt.get(s);n&&Object.defineProperty(e,"type",{value:n,writable:!1,configurable:!1,enumerable:!0})}return e}var he=(e,o,r)=>new Promise((s,n)=>{var l=d=>{try{i(r.next(d))}catch(p){n(p)}},a=d=>{try{i(r.throw(d))}catch(p){n(p)}},i=d=>d.done?s(d.value):Promise.resolve(d.value).then(l,a);i((r=r.apply(e,o)).next())});const Wt=[".DS_Store","Thumbs.db"];function Lt(e){return he(this,null,function*(){return Ie(e)&&Nt(e.dataTransfer)?Bt(e.dataTransfer,e.type):$t(e)?Pt(e):Array.isArray(e)&&e.every(o=>"getFile"in o&&typeof o.getFile=="function")?Ut(e):[]})}function Nt(e){return Ie(e)}function $t(e){return Ie(e)&&Ie(e.target)}function Ie(e){return typeof e=="object"&&e!==null}function Pt(e){return qe(e.target.files).map(o=>ke(o))}function Ut(e){return he(this,null,function*(){return(yield Promise.all(e.map(r=>r.getFile()))).map(r=>ke(r))})}function Bt(e,o){return he(this,null,function*(){if(e.items){const r=qe(e.items).filter(n=>n.kind==="file");if(o!=="drop")return r;const s=yield Promise.all(r.map(Kt));return lo(So(s))}return lo(qe(e.files).map(r=>ke(r)))})}function lo(e){return e.filter(o=>Wt.indexOf(o.name)===-1)}function qe(e){if(e===null)return[];const o=[];for(let r=0;r<e.length;r++){const s=e[r];o.push(s)}return o}function Kt(e){if(typeof e.webkitGetAsEntry!="function")return io(e);const o=e.webkitGetAsEntry();return o&&o.isDirectory?Mo(o):io(e)}function So(e){return e.reduce((o,r)=>[...o,...Array.isArray(r)?So(r):[r]],[])}function io(e){const o=e.getAsFile();if(!o)return Promise.reject(`${e} is not a File`);const r=ke(o);return Promise.resolve(r)}function Ht(e){return he(this,null,function*(){return e.isDirectory?Mo(e):Gt(e)})}function Mo(e){const o=e.createReader();return new Promise((r,s)=>{const n=[];function l(){o.readEntries(a=>he(this,null,function*(){if(a.length){const i=Promise.all(a.map(Ht));n.push(i),l()}else try{const i=yield Promise.all(n);r(i)}catch(i){s(i)}}),a=>{s(a)})}l()})}function Gt(e){return he(this,null,function*(){return new Promise((o,r)=>{e.file(s=>{const n=ke(s,e.fullPath);o(n)},s=>{r(s)})})})}function Yt(e,o){if(e&&o){const r=Array.isArray(o)?o:o.split(","),s=e.name||"",n=(e.type||"").toLowerCase(),l=n.replace(/\/.*$/,"");return r.some(a=>{const i=a.trim().toLowerCase();return i.charAt(0)==="."?s.toLowerCase().endsWith(i):i.endsWith("/*")?l===i.replace(/\/.*$/,""):n===i})}return!0}var qt=Object.defineProperty,Vt=Object.defineProperties,Jt=Object.getOwnPropertyDescriptors,co=Object.getOwnPropertySymbols,Xt=Object.prototype.hasOwnProperty,Zt=Object.prototype.propertyIsEnumerable,uo=(e,o,r)=>o in e?qt(e,o,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[o]=r,Qt=(e,o)=>{for(var r in o||(o={}))Xt.call(o,r)&&uo(e,r,o[r]);if(co)for(var r of co(o))Zt.call(o,r)&&uo(e,r,o[r]);return e},er=(e,o)=>Vt(e,Jt(o));const or="file-invalid-type",tr="file-too-large",rr="file-too-small",sr="too-many-files",nr=e=>{e=Array.isArray(e)&&e.length===1?e[0]:e;const o=Array.isArray(e)?`one of ${e.join(", ")}`:e;return{code:or,message:`File type must be ${o}`}},po=e=>({code:tr,message:`File is larger than ${e} ${e===1?"byte":"bytes"}`}),fo=e=>({code:rr,message:`File is smaller than ${e} ${e===1?"byte":"bytes"}`}),ar={code:sr,message:"Too many files"};function Oo(e,o){const r=e.type==="application/x-moz-file"||Yt(e,o);return[r,r?null:nr(o)]}function zo(e,o,r){if(le(e.size))if(le(o)&&le(r)){if(e.size>r)return[!1,po(r)];if(e.size<o)return[!1,fo(o)]}else{if(le(o)&&e.size<o)return[!1,fo(o)];if(le(r)&&e.size>r)return[!1,po(r)]}return[!0,null]}function le(e){return e!=null}function lr({files:e,accept:o,minSize:r,maxSize:s,multiple:n,maxFiles:l,validator:a}){return!n&&e.length>1||n&&l>=1&&e.length>l?!1:e.every(i=>{const[d]=Oo(i,o),[p]=zo(i,r,s),f=a?a(i):null;return d&&p&&!f})}function Re(e){return typeof e.isPropagationStopped=="function"?e.isPropagationStopped():typeof e.cancelBubble<"u"?e.cancelBubble:!1}function Ae(e){return e.dataTransfer?Array.prototype.some.call(e.dataTransfer.types,o=>o==="Files"||o==="application/x-moz-file"):!!e.target&&!!e.target.files}function mo(e){e.preventDefault()}function ir(e){return e.indexOf("MSIE")!==-1||e.indexOf("Trident/")!==-1}function cr(e){return e.indexOf("Edge/")!==-1}function dr(e=window.navigator.userAgent){return ir(e)||cr(e)}function K(...e){return(o,...r)=>e.some(s=>(!Re(o)&&s&&s(o,...r),Re(o)))}function ur(){return"showOpenFilePicker"in window}function pr(e){return le(e)?[{description:"Files",accept:Object.entries(e).filter(([r,s])=>{let n=!0;return Ao(r)||(console.warn(`Skipped "${r}" because it is not a valid MIME type. Check https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types for a list of valid MIME types.`),n=!1),(!Array.isArray(s)||!s.every(Io))&&(console.warn(`Skipped "${r}" because an invalid file extension was provided.`),n=!1),n}).reduce((r,[s,n])=>er(Qt({},r),{[s]:n}),{})}]:e}function fr(e){if(le(e))return Object.entries(e).reduce((o,[r,s])=>[...o,r,...s],[]).filter(o=>Ao(o)||Io(o)).join(",")}function mr(e){return e instanceof DOMException&&(e.name==="AbortError"||e.code===e.ABORT_ERR)}function hr(e){return e instanceof DOMException&&(e.name==="SecurityError"||e.code===e.SECURITY_ERR)}function Ao(e){return e==="audio/*"||e==="video/*"||e==="image/*"||e==="text/*"||/\w+\/[-+.\w]+/g.test(e)}function Io(e){return/^.*\.[\w]+$/.test(e)}var gr=Object.defineProperty,vr=Object.defineProperties,yr=Object.getOwnPropertyDescriptors,Te=Object.getOwnPropertySymbols,Ro=Object.prototype.hasOwnProperty,To=Object.prototype.propertyIsEnumerable,ho=(e,o,r)=>o in e?gr(e,o,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[o]=r,M=(e,o)=>{for(var r in o||(o={}))Ro.call(o,r)&&ho(e,r,o[r]);if(Te)for(var r of Te(o))To.call(o,r)&&ho(e,r,o[r]);return e},ee=(e,o)=>vr(e,yr(o)),We=(e,o)=>{var r={};for(var s in e)Ro.call(e,s)&&o.indexOf(s)<0&&(r[s]=e[s]);if(e!=null&&Te)for(var s of Te(e))o.indexOf(s)<0&&To.call(e,s)&&(r[s]=e[s]);return r};const oo=u.forwardRef((e,o)=>{var r=e,{children:s}=r,n=We(r,["children"]);const l=Lo(n),{open:a}=l,i=We(l,["open"]);return u.useImperativeHandle(o,()=>({open:a}),[a]),Yo.createElement(u.Fragment,null,s(ee(M({},i),{open:a})))});oo.displayName="Dropzone";const Wo={disabled:!1,getFilesFromEvent:Lt,maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1,validator:null,useFsAccessApi:!0,autoFocus:!1};oo.defaultProps=Wo;oo.propTypes={children:b.func,accept:b.objectOf(b.arrayOf(b.string)),multiple:b.bool,preventDropOnDocument:b.bool,noClick:b.bool,noKeyboard:b.bool,noDrag:b.bool,noDragEventsBubbling:b.bool,minSize:b.number,maxSize:b.number,maxFiles:b.number,disabled:b.bool,getFilesFromEvent:b.func,onFileDialogCancel:b.func,onFileDialogOpen:b.func,useFsAccessApi:b.bool,autoFocus:b.bool,onDragEnter:b.func,onDragLeave:b.func,onDragOver:b.func,onDrop:b.func,onDropAccepted:b.func,onDropRejected:b.func,onError:b.func,validator:b.func};const Ve={isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,acceptedFiles:[],fileRejections:[]};function Lo(e={}){const{accept:o,disabled:r,getFilesFromEvent:s,maxSize:n,minSize:l,multiple:a,maxFiles:i,onDragEnter:d,onDragLeave:p,onDragOver:f,onDrop:v,onDropAccepted:h,onDropRejected:y,onFileDialogCancel:j,onFileDialogOpen:g,useFsAccessApi:x,autoFocus:D,preventDropOnDocument:G,noClick:re,noKeyboard:$,noDrag:se,noDragEventsBubbling:W,onError:P,validator:U}=M(M({},Wo),e),B=u.useMemo(()=>fr(o),[o]),R=u.useMemo(()=>pr(o),[o]),J=u.useMemo(()=>typeof g=="function"?g:go,[g]),X=u.useMemo(()=>typeof j=="function"?j:go,[j]),_=u.useRef(null),z=u.useRef(null),[Ce,S]=u.useReducer(xr,Ve),{isFocused:Ne,isFileDialogActive:ge}=Ce,ie=u.useRef(typeof window<"u"&&window.isSecureContext&&x&&ur()),$e=()=>{!ie.current&&ge&&setTimeout(()=>{if(z.current){const{files:c}=z.current;c.length||(S({type:"closeDialog"}),X())}},300)};u.useEffect(()=>(window.addEventListener("focus",$e,!1),()=>{window.removeEventListener("focus",$e,!1)}),[z,ge,X,ie]);const ne=u.useRef([]),Fe=c=>{_.current&&_.current.contains(c.target)||(c.preventDefault(),ne.current=[])};u.useEffect(()=>(G&&(document.addEventListener("dragover",mo,!1),document.addEventListener("drop",Fe,!1)),()=>{G&&(document.removeEventListener("dragover",mo),document.removeEventListener("drop",Fe))}),[_,G]),u.useEffect(()=>(!r&&D&&_.current&&_.current.focus(),()=>{}),[_,D,r]);const Y=u.useCallback(c=>{P?P(c):console.error(c)},[P]),_e=u.useCallback(c=>{c.preventDefault(),c.persist(),ze(c),ne.current=[...ne.current,c.target],Ae(c)&&Promise.resolve(s(c)).then(m=>{if(Re(c)&&!W)return;const k=m.length,E=k>0&&lr({files:m,accept:B,minSize:l,maxSize:n,multiple:a,maxFiles:i,validator:U}),I=k>0&&!E;S({isDragAccept:E,isDragReject:I,isDragActive:!0,type:"setDraggedFiles"}),d&&d(c)}).catch(m=>Y(m))},[s,d,Y,W,B,l,n,a,i,U]),Ee=u.useCallback(c=>{c.preventDefault(),c.persist(),ze(c);const m=Ae(c);if(m&&c.dataTransfer)try{c.dataTransfer.dropEffect="copy"}catch{}return m&&f&&f(c),!1},[f,W]),Se=u.useCallback(c=>{c.preventDefault(),c.persist(),ze(c);const m=ne.current.filter(E=>_.current&&_.current.contains(E)),k=m.indexOf(c.target);k!==-1&&m.splice(k,1),ne.current=m,!(m.length>0)&&(S({type:"setDraggedFiles",isDragActive:!1,isDragAccept:!1,isDragReject:!1}),Ae(c)&&p&&p(c))},[_,p,W]),ae=u.useCallback((c,m)=>{const k=[],E=[];c.forEach(I=>{const[xe,je]=Oo(I,B),[Pe,Ue]=zo(I,l,n),be=U?U(I):null;if(xe&&Pe&&!be)k.push(I);else{let we=[je,Ue];be&&(we=we.concat(be)),E.push({file:I,errors:we.filter(Be=>Be)})}}),(!a&&k.length>1||a&&i>=1&&k.length>i)&&(k.forEach(I=>{E.push({file:I,errors:[ar]})}),k.splice(0)),S({acceptedFiles:k,fileRejections:E,type:"setFiles"}),v&&v(k,E,m),E.length>0&&y&&y(E,m),k.length>0&&h&&h(k,m)},[S,a,B,l,n,i,v,h,y,U]),ce=u.useCallback(c=>{c.preventDefault(),c.persist(),ze(c),ne.current=[],Ae(c)&&Promise.resolve(s(c)).then(m=>{Re(c)&&!W||ae(m,c)}).catch(m=>Y(m)),S({type:"reset"})},[s,ae,Y,W]),Z=u.useCallback(()=>{if(ie.current){S({type:"openDialog"}),J();const c={multiple:a,types:R};window.showOpenFilePicker(c).then(m=>s(m)).then(m=>{ae(m,null),S({type:"closeDialog"})}).catch(m=>{mr(m)?(X(m),S({type:"closeDialog"})):hr(m)?(ie.current=!1,z.current?(z.current.value=null,z.current.click()):Y(new Error("Cannot open the file picker because the https://developer.mozilla.org/en-US/docs/Web/API/File_System_Access_API is not supported and no <input> was provided."))):Y(m)});return}z.current&&(S({type:"openDialog"}),J(),z.current.value=null,z.current.click())},[S,J,X,x,ae,Y,R,a]),de=u.useCallback(c=>{!_.current||!_.current.isEqualNode(c.target)||(c.key===" "||c.key==="Enter"||c.keyCode===32||c.keyCode===13)&&(c.preventDefault(),Z())},[_,Z]),ue=u.useCallback(()=>{S({type:"focus"})},[]),Me=u.useCallback(()=>{S({type:"blur"})},[]),ve=u.useCallback(()=>{re||(dr()?setTimeout(Z,0):Z())},[re,Z]),Q=c=>r?null:c,ye=c=>$?null:Q(c),Oe=c=>se?null:Q(c),ze=c=>{W&&c.stopPropagation()},No=u.useMemo(()=>(c={})=>{var m=c,{refKey:k="ref",role:E,onKeyDown:I,onFocus:xe,onBlur:je,onClick:Pe,onDragEnter:Ue,onDragOver:be,onDragLeave:we,onDrop:Be}=m,Uo=We(m,["refKey","role","onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragOver","onDragLeave","onDrop"]);return M(M({onKeyDown:ye(K(I,de)),onFocus:ye(K(xe,ue)),onBlur:ye(K(je,Me)),onClick:Q(K(Pe,ve)),onDragEnter:Oe(K(Ue,_e)),onDragOver:Oe(K(be,Ee)),onDragLeave:Oe(K(we,Se)),onDrop:Oe(K(Be,ce)),role:typeof E=="string"&&E!==""?E:"presentation",[k]:_},!r&&!$?{tabIndex:0}:{}),Uo)},[_,de,ue,Me,ve,_e,Ee,Se,ce,$,se,r]),$o=u.useCallback(c=>{c.stopPropagation()},[]),Po=u.useMemo(()=>(c={})=>{var m=c,{refKey:k="ref",onChange:E,onClick:I}=m,xe=We(m,["refKey","onChange","onClick"]);const je={accept:B,multiple:a,type:"file",style:{display:"none"},onChange:Q(K(E,ce)),onClick:Q(K(I,$o)),tabIndex:-1,[k]:z};return M(M({},je),xe)},[z,o,a,ce,r]);return ee(M({},Ce),{isFocused:Ne&&!r,getRootProps:No,getInputProps:Po,rootRef:_,inputRef:z,open:Q(Z)})}function xr(e,o){switch(o.type){case"focus":return ee(M({},e),{isFocused:!0});case"blur":return ee(M({},e),{isFocused:!1});case"openDialog":return ee(M({},Ve),{isFileDialogActive:!0});case"closeDialog":return ee(M({},e),{isFileDialogActive:!1});case"setDraggedFiles":return ee(M({},e),{isDragActive:o.isDragActive,isDragAccept:o.isDragAccept,isDragReject:o.isDragReject});case"setFiles":return ee(M({},e),{acceptedFiles:o.acceptedFiles,fileRejections:o.fileRejections});case"reset":return M({},Ve);default:return e}}function go(){}const[jr,br]=qo("Dropzone component was not found in tree");function to(e){const o=r=>{const{children:s,...n}=Le(`Dropzone${no(e)}`,{},r),l=br(),a=Vo(s)?s:t.jsx("span",{children:s});return l[e]?u.cloneElement(a,n):null};return o.displayName=`@mantine/dropzone/${no(e)}`,o}const wr=to("accept"),Dr=to("reject"),kr=to("idle");var De={root:"m_d46a4834",inner:"m_b85f7144",fullScreen:"m_96f6e9ad",dropzone:"m_7946116d"};const Cr={loading:!1,multiple:!0,maxSize:1/0,autoFocus:!1,activateOnClick:!0,activateOnDrag:!0,dragEventsBubbling:!0,activateOnKeyboard:!0,useFsAccessApi:!0,variant:"light",rejectColor:"red"},Fr=xo((e,{radius:o,variant:r,acceptColor:s,rejectColor:n})=>{const l=e.variantColorResolver({color:s||e.primaryColor,theme:e,variant:r}),a=e.variantColorResolver({color:n||"red",theme:e,variant:r});return{root:{"--dropzone-radius":Xo(o),"--dropzone-accept-color":l.color,"--dropzone-accept-bg":l.background,"--dropzone-reject-color":a.color,"--dropzone-reject-bg":a.background}}}),te=Je((e,o)=>{const r=Le("Dropzone",Cr,e),{classNames:s,className:n,style:l,styles:a,unstyled:i,vars:d,radius:p,disabled:f,loading:v,multiple:h,maxSize:y,accept:j,children:g,onDropAny:x,onDrop:D,onReject:G,openRef:re,name:$,maxFiles:se,autoFocus:W,activateOnClick:P,activateOnDrag:U,dragEventsBubbling:B,activateOnKeyboard:R,onDragEnter:J,onDragLeave:X,onDragOver:_,onFileDialogCancel:z,onFileDialogOpen:Ce,preventDropOnDocument:S,useFsAccessApi:Ne,getFilesFromEvent:ge,validator:ie,rejectColor:$e,acceptColor:ne,enablePointerEvents:Fe,loaderProps:Y,inputProps:_e,mod:Ee,...Se}=r,ae=Xe({name:"Dropzone",classes:De,props:r,className:n,style:l,classNames:s,styles:a,unstyled:i,vars:d,varsResolver:Fr}),{getRootProps:ce,getInputProps:Z,isDragAccept:de,isDragReject:ue,open:Me}=Lo({onDrop:x,onDropAccepted:D,onDropRejected:G,disabled:f||v,accept:Array.isArray(j)?j.reduce((Q,ye)=>({...Q,[ye]:[]}),{}):j,multiple:h,maxSize:y,maxFiles:se,autoFocus:W,noClick:!P,noDrag:!U,noDragEventsBubbling:!B,noKeyboard:!R,onDragEnter:J,onDragLeave:X,onDragOver:_,onFileDialogCancel:z,onFileDialogOpen:Ce,preventDropOnDocument:S,useFsAccessApi:Ne,validator:ie,...ge?{getFilesFromEvent:ge}:null});Jo(re,Me);const ve=!de&&!ue;return t.jsx(jr,{value:{accept:de,reject:ue,idle:ve},children:t.jsxs(Ze,{...ce(),...ae("root",{focusable:!0}),...Se,mod:[{accept:de,reject:ue,idle:ve,disabled:f,loading:v,"activate-on-click":P},Ee],children:[t.jsx(eo,{visible:v,overlayProps:{radius:p},unstyled:i,loaderProps:Y}),t.jsx("input",{...Z(_e),name:$}),t.jsx("div",{...ae("inner"),ref:o,"data-enable-pointer-events":Fe||void 0,children:g})]})})});te.classes=De;te.displayName="@mantine/dropzone/Dropzone";te.Accept=wr;te.Idle=kr;te.Reject=Dr;const _r={loading:!1,maxSize:1/0,activateOnClick:!1,activateOnDrag:!0,dragEventsBubbling:!0,activateOnKeyboard:!0,active:!0,zIndex:yo("max"),withinPortal:!0},ro=Je((e,o)=>{const r=Le("DropzoneFullScreen",_r,e),{classNames:s,className:n,style:l,styles:a,unstyled:i,vars:d,active:p,onDrop:f,onReject:v,zIndex:h,withinPortal:y,portalProps:j,...g}=r,x=Xe({name:"DropzoneFullScreen",classes:De,props:r,className:n,style:l,classNames:s,styles:a,unstyled:i,rootSelector:"fullScreen"}),{resolvedClassNames:D,resolvedStyles:G}=ct({classNames:s,styles:a,props:r}),[re,$]=u.useState(0),[se,{open:W,close:P}]=st(!1),U=R=>{var J;(J=R.dataTransfer)!=null&&J.types.includes("Files")&&($(X=>X+1),W())},B=()=>{$(R=>R-1)};return u.useEffect(()=>{re===0&&P()},[re]),u.useEffect(()=>{if(p)return document.addEventListener("dragenter",U,!1),document.addEventListener("dragleave",B,!1),()=>{document.removeEventListener("dragenter",U,!1),document.removeEventListener("dragleave",B,!1)}},[p]),t.jsx(Zo,{...j,withinPortal:y,children:t.jsx(Ze,{...x("fullScreen",{style:{opacity:se?1:0,pointerEvents:se?"all":"none",zIndex:h}}),ref:o,children:t.jsx(te,{...g,classNames:D,styles:G,unstyled:i,className:De.dropzone,onDrop:R=>{f==null||f(R),P(),$(0)},onReject:R=>{v==null||v(R),P(),$(0)}})})})});ro.classes=De;ro.displayName="@mantine/dropzone/DropzoneFullScreen";te.FullScreen=ro;const vo=te;function Er({onDrop:e,openRef:o,children:r}){return t.jsxs(vo,{openRef:o,onDrop:e,activateOnClick:!1,acceptColor:"var(--mantine-color-white)",styles:{root:{border:"none",padding:0}},children:[t.jsx(vo.Accept,{children:t.jsx(dt,{style:{width:N(52),height:N(52),color:"var(--mantine-color-blue-6)",position:"absolute",bottom:N(16),left:"50%",transform:"translateX(-50%)",zIndex:9999},stroke:1.5})}),r]})}function Sr({itemParentId:e}){const[o,r]=u.useState("reviewal"),{closeModal:s,modals:n}=O(),l=wo(o,n.createWorkflow),{data:a,setData:i,post:d,processing:p,errors:f,reset:v}=V({folder_item_id:"",resolution:"",destination:"",type:"reviewal",users:[]});return{data:a,setData:i,createApprovalSubmit:y=>{y.preventDefault(),a.folder_item_id=e??"",a.users=l.map(j=>({user_id:j.id})),d(route("workflows.store"),{preserveScroll:!0,onSuccess:()=>{s("createWorkflow"),C.show({message:"Approval process created",color:"green"})},onError:()=>{C.show({message:"Something went wrong",color:"red"})},onFinish:()=>v()})},processing:p,errors:f,users:l,setWorkflowType:r}}const Mr=({itemParent:e})=>{const{data:o,setData:r,createApprovalSubmit:s,processing:n,errors:l,users:a,setWorkflowType:i}=Sr({itemParentId:e==null?void 0:e.item_id}),{modals:d,closeModal:p}=O();return t.jsx(oe,{opened:d.createWorkflow,onClose:()=>p("createWorkflow"),title:t.jsx(w,{fw:"bold",size:"lg",children:"Create Workflow Process"}),size:550,children:t.jsxs("form",{onSubmit:s,children:[t.jsxs(H,{gap:16,children:[t.jsx(w,{size:"sm",c:"dimmed",children:"Routinely directs any uploaded file in this folder through a predefined approval workflow"}),t.jsx(fe.Group,{name:"status",value:o.type,onChange:f=>{r("type",f),i(f)},children:t.jsxs(A,{mt:"xs",children:[t.jsx(fe,{value:"reviewal",label:"Review"}),t.jsx(fe,{value:"approval",label:"Approval"})]})}),t.jsx(ko,{label:"Resolution",placeholder:"Your resolution for this approval",value:o.resolution??"",onChange:f=>r("resolution",f.target.value),error:l.resolution,autosize:!0,minRows:2,maxRows:4}),t.jsx(w,{size:"sm",fw:500,mb:-8,children:"User in this workflow"}),a.map(f=>t.jsx(jo,{withBorder:!0,radius:"md",py:16,px:10,children:t.jsxs(A,{children:[t.jsx(Do,{}),t.jsxs(H,{gap:8,children:[t.jsx(w,{size:"sm",children:f.name}),t.jsx(w,{size:"sm",children:f.email})]})]})},f.id))]}),t.jsxs(me,{align:"center",justify:"end",mt:16,children:[t.jsx(F,{variant:"light",onClick:()=>p("createWorkflow"),children:"Cancel"}),t.jsx(F,{ml:12,type:"submit",loading:n,children:"Create"})]})]})})};function Or({itemParent:e}){const{data:o,setData:r,post:s,processing:n,errors:l,reset:a}=V({folder_item_id:(e==null?void 0:e.item_id)??"",name:"",prefix:""}),{closeModal:i}=O();return{data:o,setData:r,handleSubmit:p=>{p.preventDefault(),o.folder_item_id=(e==null?void 0:e.item_id)??"",s(route("numbering-scheme.store"),{preserveScroll:!0,onSuccess:()=>{i("numberingScheme"),C.show({message:"Numbering scheme created",color:"green"})},onError:()=>{C.show({message:"Something went wrong",color:"red"})},onFinish:()=>a()})},processing:n,errors:l}}const zr=({itemParent:e})=>{const{data:o,setData:r,handleSubmit:s,processing:n,errors:l}=Or({itemParent:e}),{modals:a,closeModal:i}=O();return t.jsx(oe,{opened:a.createNumberingScheme,onClose:()=>i("createNumberingScheme"),title:t.jsx(w,{size:"lg",children:"Create Numbering Scheme"}),size:550,children:t.jsxs("form",{onSubmit:s,children:[t.jsxs(H,{gap:16,children:[t.jsx(Ye,{label:"Name",value:o.name,onChange:d=>r("name",d.target.value),error:l.name}),t.jsx(Ye,{label:"Prefix",value:o.prefix,onChange:d=>r("prefix",d.target.value),error:l.prefix})]}),t.jsxs(me,{align:"center",justify:"end",mt:16,children:[t.jsx(F,{variant:"light",onClick:()=>i("createNumberingScheme"),children:"Cancel"}),t.jsx(F,{ml:12,type:"submit",loading:n,children:"Create"})]})]})})};function Ar({itemParent:e,close:o}){const{data:r,setData:s,post:n,processing:l,errors:a,reset:i,clearErrors:d}=V({parent_id:"",name:""}),{closeModal:p}=O();return{data:r,setData:s,submit:v=>{r.parent_id=(e==null?void 0:e.item_id)||"",v.preventDefault(),n(route("folder.create"),{preserveScroll:!0,onSuccess:()=>{C.show({message:"New folder created",color:"green"})},onError:h=>{let y="";Object.keys(h).length>0?y=h[Object.keys(h)[0]]:y="Error during file upload. Please try again later.",C.show({message:y,color:"red"})},onFinish:()=>{p("folder"),i(),d()}})},processing:l,errors:a}}const Ir=({itemParent:e})=>{const{data:o,setData:r,submit:s,processing:n,errors:l}=Ar({itemParent:e,close}),{modals:a,closeModal:i}=O();return t.jsx(oe,{opened:a.folder,onClose:()=>i("folder"),title:t.jsx(w,{fw:"bold",size:"lg",children:"Create Folder"}),size:550,children:t.jsxs("form",{onSubmit:s,children:[t.jsx(H,{gap:16,children:t.jsx(Ye,{id:"name",type:"text",name:"name",value:o.name,placeholder:"Folder Name",onChange:d=>r("name",d.target.value),error:l.name})}),t.jsxs(me,{align:"center",justify:"end",mt:16,children:[t.jsx(F,{variant:"outline",onClick:()=>i("folder"),children:"Cancel"}),t.jsx(F,{ml:12,type:"submit",loading:n,children:"Create"})]})]})})};function Rr({workflowId:e,isOpen:o}){const[r,s]=u.useState(null);u.useEffect(()=>{e&&o&&n(e)},[e,o]);const n=async l=>{try{const a=await Qe.get(`/workflows/${l}`);s(a.data)}catch(a){console.error("Error fetching workflow",a)}};return r}function Tr({itemParent:e,isOpen:o}){const[r,s]=u.useState("reviewal"),n=Rr({workflowId:e==null?void 0:e.workflow_id,isOpen:o}),l=wo(r,o),{closeModal:a}=O(),{data:i,setData:d,put:p,processing:f,errors:v,reset:h,clearErrors:y}=V({resolution:"",type:"",users:[]});u.useEffect(()=>{d({resolution:(n==null?void 0:n.resolution)||"",type:(n==null?void 0:n.type)||"",users:((n==null?void 0:n.users)||[]).map(x=>({user_id:x.id}))}),s((n==null?void 0:n.type)||"")},[n]);const j=()=>{a("updateWorkflow"),h(),y()};return{data:i,setData:d,handleUpdateWorkflow:x=>{x.preventDefault(),i.users=l.map(D=>({user_id:D.id})),p(route("workflows.update",e==null?void 0:e.workflow_id),{onSuccess:()=>{j(),C.show({message:"Workflow updated successfully",color:"green"})},onError:()=>{C.show({message:"Something went wrong",color:"red"})},onFinish:()=>h()})},processing:f,errors:v,handleClose:j,fetchedUsers:l,setWorkflowType:s,workflow:n}}function Wr({workflowId:e,onDeleteSuccess:o}){const{delete:r,processing:s}=V();return{handleDeleteWorkflow:()=>{if(!e){C.show({message:"Workflow ID is missing.",color:"red"});return}r(route("workflows.destroy",e),{preserveScroll:!0,onSuccess:()=>{C.show({message:"Workflow deleted successfully.",color:"green"}),o()},onError:l=>{let a="Failed to delete workflow.";l&&Object.keys(l).length>0&&(a=l[Object.keys(l)[0]]),C.show({message:a,color:"red"})}})},processing:s}}const Lr=({workflowId:e})=>{const{modals:o,closeModal:r,openModal:s}=O(),n=o.confirmDeleteWorkflow,{handleDeleteWorkflow:l,processing:a}=Wr({workflowId:e,onDeleteSuccess:()=>{r("confirmDeleteWorkflow"),r("updateWorkflow")}});return t.jsxs(oe,{opened:n,onClose:()=>r("confirmDeleteWorkflow"),title:t.jsx(w,{fw:"bold",size:"lg",children:"Confirm Delete"}),size:"sm",centered:!0,children:[t.jsx(w,{c:"gray.8",children:"Are you sure you want to delete this workflow? This action cannot be undone."}),t.jsxs(me,{align:"center",justify:"flex-end",mt:16,children:[t.jsx(F,{variant:"light",onClick:()=>{r("confirmDeleteWorkflow"),s("updateWorkflow")},children:"Cancel"}),t.jsx(F,{color:"red",ml:12,onClick:l,loading:a,children:"Delete"})]})]})},Nr=({itemParent:e})=>{const{modals:o,closeModal:r,openModal:s}=O(),n=o.updateWorkflow,{data:l,setData:a,handleUpdateWorkflow:i,processing:d,fetchedUsers:p,setWorkflowType:f,errors:v}=Tr({itemParent:e,isOpen:n});return t.jsxs(t.Fragment,{children:[t.jsx(oe,{opened:n,onClose:()=>r("updateWorkflow"),title:t.jsx(w,{fw:"bold",size:"lg",children:"Update Workflow Process"}),size:550,children:t.jsxs("form",{onSubmit:i,children:[t.jsxs(H,{gap:16,children:[t.jsx(w,{size:"sm",c:"dimmed",children:"Routinely directs any uploaded file in this folder through a predefined approval workflow"}),t.jsx(fe.Group,{name:"status",value:l.type,onChange:h=>{a("type",h),f(h)},children:t.jsxs(A,{mt:"xs",children:[t.jsx(fe,{value:"reviewal",label:"Review"}),t.jsx(fe,{value:"approval",label:"Approval"})]})}),t.jsx(ko,{label:"Resolution",placeholder:"Your resolution for this approval",value:l.resolution??"",onChange:h=>a("resolution",h.target.value),error:v.resolution,autosize:!0,minRows:2,maxRows:4}),t.jsx(w,{size:"sm",fw:500,mb:-8,children:"Users in this workflow"}),p.map(h=>t.jsx(jo,{withBorder:!0,radius:"md",py:16,px:10,children:t.jsxs(A,{children:[t.jsx(Do,{}),t.jsxs(H,{gap:8,children:[t.jsx(w,{size:"sm",children:h.name}),t.jsx(w,{size:"sm",children:h.email})]})]})},h.id))]}),t.jsxs(me,{align:"center",justify:"end",mt:16,children:[t.jsx(F,{variant:"light",onClick:()=>r("updateWorkflow"),children:"Cancel"}),t.jsx(F,{ml:12,type:"submit",loading:d,children:"Update"}),t.jsx(L,{variant:"transparent",color:"red",onClick:()=>{s("confirmDeleteWorkflow"),r("updateWorkflow")},title:"Delete Workflow",ml:12,children:t.jsx(bo,{size:18})})]})]})}),t.jsx(Lr,{workflowId:e==null?void 0:e.workflow_id})]})},$r=({uploadFileRef:e,itemParent:o})=>{var n;const{openModal:r}=O(),{generateReport:s}=ft();return t.jsxs(A,{h:"50%",px:"md",align:"center",justify:"space-between",children:[t.jsxs(A,{gap:"xs",children:[t.jsxs(pe,{shadow:"md",width:220,transitionProps:{transition:"pop-top-left"},position:"bottom-start",children:[t.jsx(pe.Target,{children:t.jsx(F,{variant:"subtle",color:"dark.3",leftSection:t.jsx(nt,{size:18}),rightSection:t.jsx(Ge,{size:12}),children:"New"})}),t.jsxs(pe.Dropdown,{children:[t.jsx(pe.Item,{leftSection:t.jsx(St,{style:{width:N(14),height:N(14)}}),onClick:()=>r("folder"),children:"New Folder"}),t.jsx(pe.Item,{leftSection:t.jsx(_t,{style:{width:N(14),height:N(14)}}),onClick:()=>{var l;return(l=e==null?void 0:e.current)==null?void 0:l.call(e)},children:"Upload Files"}),t.jsx(pe.Item,{leftSection:t.jsx(Ot,{style:{width:N(14),height:N(14)}}),children:"Upload Folder"})]})]}),t.jsx(q,{label:"Properties",position:"bottom",withArrow:!0,children:t.jsx(L,{component:Ke,size:"lg",href:route("folder.edit",{id:o==null?void 0:o.item_id}),variant:"transparent",color:"dark.3",children:t.jsx(kt,{size:18})})}),t.jsx(q,{label:"Workflow",position:"bottom",withArrow:!0,children:t.jsx(L,{variant:"transparent",size:"lg",color:o!=null&&o.workflow_id?"green.8":"dark.3",onClick:()=>r(o!=null&&o.workflow_id?"updateWorkflow":"createWorkflow"),children:t.jsx(ut,{size:18})})}),t.jsx(q,{label:"Metadata",position:"bottom",withArrow:!0,children:t.jsx(L,{component:Ke,size:"lg",href:route("folder.showRequiredMetadata",{id:o==null?void 0:o.item_id}),variant:"transparent",color:(n=o==null?void 0:o.required_metadata)!=null&&n.length?"green.8":"dark.3",children:t.jsx(tt,{size:18})})}),t.jsx(q,{label:"Activity",position:"bottom",withArrow:!0,children:t.jsx(L,{component:Ke,size:"lg",href:route("folder.activity-log",{id:o==null?void 0:o.item_id}),variant:"transparent",color:"dark.3",children:t.jsx(Ct,{size:18})})}),t.jsx(q,{label:"Numbering",position:"bottom",withArrow:!0,children:t.jsx(L,{size:"lg",variant:"transparent",color:o!=null&&o.numbering_scheme_id?"green.8":"dark.3",onClick:()=>r(o!=null&&o.numbering_scheme_id?"updateNumberingScheme":"createNumberingScheme"),children:t.jsx(zt,{size:18})})}),t.jsx(q,{label:"Column",position:"bottom",withArrow:!0,children:t.jsx(L,{variant:"transparent",color:"dark.3",size:"lg",onClick:()=>r("selectMetadataColumns"),children:t.jsx(It,{size:18})})}),t.jsx(q,{label:"Report",position:"bottom",withArrow:!0,children:t.jsx(L,{variant:"transparent",color:"dark.3",size:"lg",onClick:()=>s((o==null?void 0:o.item_id)??""),children:t.jsx(Et,{size:18})})})]}),t.jsxs(A,{gap:"xs",children:[t.jsx(q,{label:"Sort",position:"bottom",withArrow:!0,children:t.jsxs(L,{variant:"transparent",color:"dark.3",size:"lg",children:[t.jsx(At,{size:18}),t.jsx(Ge,{size:12,style:{marginLeft:N(4)}})]})}),t.jsx(q,{label:"View",position:"bottom",withArrow:!0,children:t.jsxs(L,{variant:"transparent",color:"dark.3",size:"lg",children:[t.jsx(at,{size:18}),t.jsx(Ge,{size:12,style:{marginLeft:N(4)}})]})})]}),t.jsx(Ir,{itemParent:o}),t.jsx(Mr,{itemParent:o}),t.jsx(Nr,{itemParent:o}),t.jsx(zr,{itemParent:o}),t.jsx(pt,{itemParent:o})]})};function Pr(e){return fetch(e,{headers:{"Content-Type":"application/json",Accept:"application/json"}}).then(o=>o.json())}function Ur(){return{downloadFiles:({all:o,ids:r,parentId:s})=>{if(!o&&(r==null?void 0:r.length)===0)return;const n=new URLSearchParams;s&&n.append("parent_id",String(s)),o?n.append("all",o?"1":"0"):r==null||r.forEach(a=>n.append("ids[]",a));const l=route("item.download");Pr(`${l}?${n.toString()}`).then(a=>{if(!a.url)return;const i=document.createElement("a");i.download=a.filename,i.href=a.url,i.click()})}}}function Br({setSelectedRecord:e}){const{data:o,delete:r,processing:s}=V({ids:[]}),{closeModal:n}=O();return{handleDelete:a=>{o.ids=a,r(route("item.delete"),{onSuccess:()=>{n("deleteFiles"),setTimeout(()=>{e([])},100),C.show({message:"Files deleted",color:"green"})},onError:i=>{let d="Error during file deletion. Please try again later.";Object.keys(i).length>0&&(d=i[Object.keys(i)[0]]),C.show({message:d,color:"red"})}})},processing:s}}const Kr=({selectedIds:e,setSelectedRecord:o})=>{const{handleDelete:r,processing:s}=Br({setSelectedRecord:o}),{modals:n,closeModal:l}=O();return t.jsx(oe,{opened:n.deleteFiles,onClose:()=>l("deleteFiles"),title:t.jsx(w,{fw:"bold",size:"lg",children:"Delete Files"}),size:550,children:t.jsxs("form",{onSubmit:a=>{a.preventDefault(),r(e)},children:[t.jsx(w,{c:"dimmed",children:"Delete selected files?"}),t.jsxs(me,{align:"center",justify:"end",mt:16,children:[t.jsx(F,{variant:"subtle",onClick:()=>l("deleteFiles"),color:"gray",children:"Cancel"}),t.jsx(F,{ml:12,type:"submit",loading:s,color:"red",children:"Delete"})]})]})})};function Hr(e,o){const[r,s]=u.useState({itemParent:null,itemAncestors:null,itemContents:[]}),[n,l]=u.useState(!1),[a,i]=u.useState(null);u.useEffect(()=>{o&&d(e)},[e,o]);const d=async p=>{l(!0),i(null);try{const f=await Qe.get(route("item.showItems",{item:p}));s(f.data)}catch(f){i("Failed to fetch items."),console.error(f)}finally{l(!1)}};return{data:r,loading:n,error:a}}function Gr({setSelectedRecord:e}){const{data:o,setData:r,put:s,processing:n,errors:l,reset:a,clearErrors:i}=V({ids:[],destination_folder_id:""});return{data:o,setData:r,moveDocuments:()=>{s(route("document.move"),{onSuccess:()=>{e([]),C.show({message:"Documents moved successfully",color:"green"}),a()},onError:p=>{C.show({message:"Failed to move documents",color:"red"})},onFinish:()=>{i()}})},processing:n,errors:l,reset:a}}const Yr=({selectedDocumentIds:e,setSelectedRecord:o})=>{const{modals:r,closeModal:s}=O(),n=r.moveModal,[l,a]=u.useState(null),{data:i,loading:d,error:p}=Hr(l,n),{data:f,setData:v,moveDocuments:h,processing:y}=Gr({setSelectedRecord:o}),j=D=>{a(D)},g=()=>{i.itemParent&&i.itemParent.parent_id?a(i.itemParent.parent_id):a(null)},x=()=>{if(!l){C.show({message:"Please select a destination folder.",color:"red"});return}f.ids=e,f.destination_folder_id=l,h(),s("moveModal")};return t.jsx(oe,{opened:n,onClose:()=>s("moveModal"),title:"Move Documents",size:"lg",children:t.jsxs(H,{gap:"md",children:[t.jsxs(A,{children:[l&&t.jsx(L,{onClick:g,children:t.jsx(Ft,{size:16})}),t.jsx(w,{children:"Choose Destination Folder"})]}),d?t.jsx(w,{children:"Loading..."}):p?t.jsx(w,{c:"red",children:p}):t.jsx(H,{gap:"sm",style:{maxHeight:400,overflowY:"auto"},children:i.itemContents.map(D=>t.jsxs(A,{gap:"sm",style:{cursor:"pointer"},onDoubleClick:()=>j(D.item_id),children:[t.jsx(mt,{}),t.jsx(w,{children:D.name})]},D.item_id))}),t.jsxs(A,{justify:"flex-end",mt:"md",children:[t.jsx(F,{variant:"outline",onClick:()=>s("moveModal"),children:"Cancel"}),t.jsx(F,{onClick:x,disabled:!l||y,loading:y,children:"Move Here"})]})]})})},qr=({setSelectedRecord:e,selectedIds:o,parentId:r})=>{const{downloadFiles:s}=Ur(),{openModal:n}=O();return t.jsxs(A,{h:"50%",px:"md",align:"center",justify:"flex-start",children:[t.jsx(F,{onClick:()=>n("deleteFiles"),variant:"subtle",color:"dark.3",leftSection:t.jsx(bo,{size:18}),children:"Delete"}),t.jsx(F,{onClick:()=>s({all:!1,ids:o,parentId:r}),variant:"subtle",color:"dark.3",leftSection:t.jsx(ht,{size:18}),children:"Download"}),t.jsx(F,{onClick:()=>n("moveModal"),variant:"subtle",color:"dark.3",leftSection:t.jsx(Mt,{size:18}),children:"Move"}),t.jsx(Kr,{selectedIds:o,setSelectedRecord:e}),t.jsx(Yr,{selectedDocumentIds:o,setSelectedRecord:e})]})};function Vr(e){const{data:o,post:r,reset:s,clearErrors:n}=V({parent_id:"",files:[]});return{uploadFiles:a=>{o.parent_id=e.item_id,o.files=a.map(i=>({file:i})),r(route("document.store"),{onSuccess:()=>{C.show({message:"Document uploaded",color:"green"})},onError:i=>{let d="";Object.keys(i).length>0?d=i[Object.keys(i)[0]]:d="Error during file upload. Please try again later.",C.show({message:d,color:"red"})},onFinish:()=>{s(),n()}})}}}function Jr(){const[e,o]=u.useState([]),s=(n=>n.map(l=>l.id))(e);return{selectedRecord:e,setSelectedRecord:o,ids:s}}function Xr(){return{openFolder:(o,r)=>{o==="folder"&&Qo.visit(route("folder.show",{id:r}))}}}function Zr({folderId:e,isOpen:o}){const[r,s]=u.useState([]),[n,l]=u.useState(!1),[a,i]=u.useState(null);return u.useEffect(()=>{e&&o&&(async()=>{l(!0);try{const p=await Qe.get(`/folder/${e}/metadata_columns`);s(p.data.metadata_columns),i(null)}catch(p){i("Failed to fetch existing metadata columns."),console.error(p)}finally{l(!1)}})()},[e,o]),{existingMetadataColumns:r,loading:n,error:a}}const Qr=({folderId:e})=>{const{modals:o,closeModal:r}=O(),s=o.selectMetadataColumns,{metadataList:n}=vt(),{existingMetadataColumns:l,loading:a,error:i}=Zr({folderId:e,isOpen:s}),{data:d,setData:p,post:f,processing:v,errors:h}=V({metadata_ids:[]});u.useEffect(()=>{const g=l.map(x=>x.id);p("metadata_ids",g)},[s,l]);const y=g=>{const x=d.metadata_ids;x.includes(g)?p("metadata_ids",x.filter(D=>D!==g)):p("metadata_ids",[...x,g])},j=()=>{f(route("folder.selectMetadataColumn",e),{onSuccess:()=>{r("selectMetadataColumns"),C.show({title:"Success",message:"Metadata columns selected successfully"})},onError:g=>{console.error(g),C.show({title:"Error",message:"Failed to select metadata columns"})}})};return t.jsx(oe,{opened:s,onClose:()=>r("selectMetadataColumns"),title:"Select Columns",children:t.jsxs(H,{children:[t.jsx(w,{children:"Select the metadata columns you want to display:"}),a?t.jsx(w,{children:"Loading..."}):i?t.jsx(w,{c:"red",children:i}):t.jsxs(A,{dir:"column",children:[t.jsx(He,{label:"Name",checked:!0,disabled:!0}),t.jsx(He,{label:"Date",checked:!0,disabled:!0}),n.map(g=>t.jsx(He,{label:g.name,checked:d.metadata_ids.includes(g.metadata_id),onChange:()=>y(g.metadata_id)},g.metadata_id))]}),h.metadata_ids&&t.jsx(w,{c:"red",children:h.metadata_ids}),t.jsxs(A,{justify:"flex-end",mt:"md",children:[t.jsx(F,{variant:"outline",onClick:()=>r("selectMetadataColumns"),children:"Cancel"}),t.jsx(F,{onClick:j,loading:v,children:"Save"})]})]})})};function As({itemParent:e,itemAncestors:o,itemContents:r}){var h;const s=u.useRef(null),{uploadFiles:n}=Vr(e),{selectedRecord:l,setSelectedRecord:a,ids:i}=Jr(),{openFolder:d}=Xr(),{openDocument:p}=gt(),f=(h=e.metadata_columns)==null?void 0:h.map(y=>({accessor:`metadata_${y.id}`,title:y.name,render:j=>{var x;const g=(x=j.metadata)==null?void 0:x.find(D=>D.id===y.id);return g?g.value:null}})),v=[{accessor:"name",render:({mime:y,type:j,name:g,status:x,missing_required_metadata:D})=>t.jsxs(A,{align:"center",gap:12,children:[t.jsx(rt,{mime:y??"",isFolder:j==="folder",approvalStatus:x,missingRequiredMetadata:D}),t.jsx("span",{children:g})]})},{accessor:"updated_at",title:"Last Modified"},...f??[]];return t.jsxs(t.Fragment,{children:[t.jsx(et,{title:"My Files"}),t.jsx(lt,{toolbar:l.length>0?t.jsx(qr,{setSelectedRecord:a,selectedIds:i,parentId:e.item_id}):t.jsx($r,{itemParent:e,uploadFileRef:s}),children:t.jsx(Er,{onDrop:n,openRef:s,children:t.jsxs(H,{px:8,gap:24,py:8,style:{pointerEvents:"all"},children:[t.jsx(it,{ancestors:o}),r.length?t.jsx(ot,{textSelectionDisabled:!0,columns:v,records:r,customRowAttributes:({type:y,id:j})=>({onDoubleClick:g=>{g.button===0&&(y==="folder"?d(y,j):y==="document"&&p(j))}}),highlightOnHover:!0,verticalSpacing:"lg",horizontalSpacing:"xl",selectedRecords:l,onSelectedRecordsChange:a}):t.jsx(w,{size:"lg",c:"gray.5",children:"This folder is empty"})]})})}),t.jsx(Qr,{folderId:e.item_id})]})}export{As as default};
